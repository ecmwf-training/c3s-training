
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Convert effective LAI to LAI &#8212; Copernicus Climate Change Service (C3S) Training Book</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=87e54e7c" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=3ee479438cf8b5e0d341" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=3ee479438cf8b5e0d341" />
  <script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=3ee479438cf8b5e0d341"></script>

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'submodules/c3s-training-submodule-sat-obs-land/convert-effective-lai-to-lai';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>
<aside class="bd-header-announcement" aria-label="Announcement">
  <div class="bd-header-announcement__content">⚠️This is a TEST Version, this is not an official website⚠️</div>
</aside>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../../intro.html">
  
  
  
  
  
  
    <p class="title logo__title">Copernicus Climate Change Service (C3S) Training Book</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    Copernicus Climate Change Service (C3S) Data Tutorials
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Introduction</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../how-to-run-these-tutorials.html">How to run these tutorials</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../c3s-training-submodule-reanalysis/intro.html">Reanalysis</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../c3s-training-submodule-reanalysis/reanalysis-climatology.html">Climatology</a></li>
<li class="toctree-l2"><a class="reference internal" href="../c3s-training-submodule-reanalysis/reanalysis-heatwave.html">Heatwave Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../c3s-training-submodule-reanalysis/reanalysis-temp-record.html">Temperature Record</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../c3s-training-submodule-projections/intro.html">Climate Projections</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../c3s-training-submodule-projections/projections-cmip6.html">Global Climate Projections (CMIP6)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../c3s-training-submodule-projections/projections-cordex.html">Regional Climate Projections (CORDEX)</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../c3s-training-submodule-seasonal-forecast/intro.html">Seasonal Forecasts</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../c3s-training-submodule-seasonal-forecast/sf-anomalies.html">Seasonal Forecast Anomalies</a></li>
<li class="toctree-l2"><a class="reference internal" href="../c3s-training-submodule-seasonal-forecast/sf-verification.html">Seasonal Forecast Verification</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../c3s-training-submodule-climate-indices/intro.html">Climate Indices</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../c3s-training-submodule-climate-indices/ci-windchill.html">Windchill</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../c3s-training-submodule-sat-obs-atmos-physics/intro.html">Satellite Observations - Atmospheric Physic</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../c3s-training-submodule-sat-obs-atmos-physics/erb-outgoing-longwave-radiation.html">Outgoing Longwave Radiation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../c3s-training-submodule-sat-obs-atmos-physics/erb-clara-climatology.html">Analysis of the CLARA Earth radiation budget product</a></li>
<li class="toctree-l2"><a class="reference internal" href="../c3s-training-submodule-sat-obs-atmos-physics/erb-ceres-climatology.html">Analysis of the CERES Earth radiation budget product</a></li>
<li class="toctree-l2"><a class="reference internal" href="../c3s-training-submodule-sat-obs-atmos-physics/total-solar-irradiance.html">Total Solar Irradiance</a></li>
<li class="toctree-l2"><a class="reference internal" href="../c3s-training-submodule-sat-obs-atmos-physics/srb-climatology-and-anomaly.html">Surface radiation budget climatologies and anomalies</a></li>
<li class="toctree-l2"><a class="reference internal" href="../c3s-training-submodule-sat-obs-atmos-physics/total-column-water-vapour-combi.html">Total column water vapour</a></li>
<li class="toctree-l2"><a class="reference internal" href="../c3s-training-submodule-sat-obs-atmos-physics/tropospheric-humidity-from-radio-occultation.html">Tropospheric humidity estimates from satellite-based radio occultation measurements</a></li>
<li class="toctree-l2"><a class="reference internal" href="../c3s-training-submodule-sat-obs-atmos-physics/cloud-cover-climatology.html">Cloud fractional cover climatology</a></li>
<li class="toctree-l2"><a class="reference internal" href="../c3s-training-submodule-sat-obs-atmos-physics/precipitation-giraffe.html">Exploring Precipitation information in the GIRAFFE dataset</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../c3s-training-submodule-sat-obs-atmos-comp/intro.html">Satellite Observations - Atmospheric Composition</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../c3s-training-submodule-sat-obs-atmos-comp/greenhouse-gases-level2-products.html">How to access and use a satellite-derived GHG Level 2 data product using XCO2_EMMA as an example?</a></li>


<li class="toctree-l2"><a class="reference internal" href="../c3s-training-submodule-sat-obs-atmos-comp/greenhouse-gases-level3-products.html">How to access, read and use satellite XCO2 and XCH4 Level 3 data products</a></li>


<li class="toctree-l2"><a class="reference internal" href="../c3s-training-submodule-sat-obs-atmos-comp/aerosol-single-sensor-demonstrator.html">Exploring gridded data on Aerosol properties available on C3S</a></li>








<li class="toctree-l2"><a class="reference internal" href="../c3s-training-submodule-sat-obs-atmos-comp/aerosol-multi-sensor-record.html">Visualising a full Climate Data Record of multi-sensor Aerosol data</a></li>









<li class="toctree-l2"><a class="reference internal" href="../c3s-training-submodule-sat-obs-atmos-comp/total-ozone-columns.html">Total Ozone Columns</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../c3s-training-submodule-sat-obs-hydro-cryo/intro.html">Satellite Observations - Hydrology and Cryosphere</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../c3s-training-submodule-sat-obs-hydro-cryo/soil-moisture-anomalies.html">Soil Moisture Anomaly Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../c3s-training-submodule-sat-obs-hydro-cryo/lake-surface-water-temperature.html">Lake Surface Water Temperature Analysis</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="intro.html">Satellite Observations - Land</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Explore other books📚</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference external" href="https://Randbee.github.io/CAMSBook">Copernicus Atmosphere Monitoring Service (CAMS) Data Tutorials</a></li>
<li class="toctree-l1"><a class="reference external" href="https://ecmwfcode4earth.github.io/sketchbook-earth">Sketchbook Earth - A collection of Jupyter notebooks for Earth Sciences</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">ECMWF</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../support.html">Help&amp;Support</a></li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference external" href="https://climate.copernicus.eu/">Copernicus Climate Change Service (C3S)</a></li>
<li class="toctree-l1"><a class="reference external" href="https://cds.climate.copernicus.eu/">Copernicus Climate Data Store (CDS)</a></li>
<li class="toctree-l1"><a class="reference external" href="https://climate.copernicus.eu/user-learning-services/">C3S Training Services</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/Randbee/C3SBook/review?urlpath=tree/submodules/c3s-training-submodule-sat-obs-land/convert-effective-lai-to-lai.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Binder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Binder logo" src="../../_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/Randbee/C3SBook" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/Randbee/C3SBook/issues/new?title=Issue%20on%20page%20%2Fsubmodules/c3s-training-submodule-sat-obs-land/convert-effective-lai-to-lai.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/submodules/c3s-training-submodule-sat-obs-land/convert-effective-lai-to-lai.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Convert effective LAI to LAI</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#overview">Overview</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#required-packages">Required packages</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data">Data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#methodology">Methodology<a id="Methodology"></a></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mapping-between-land-cover-classes">Mapping between land cover classes</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#setting-things-up">Setting things up</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#something-to-play-around-with">Something to play around with</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#geting-the-data-the-climate-data-store-cds">Geting the Data: The Climate Data Store (CDS)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#unpacking">Unpacking</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reading-the-data">Reading the data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#applying-quality-flags">Applying quality flags</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#run-the-conversion">Run the conversion</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#cleaning-up">Cleaning up</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="convert-effective-lai-to-lai">
<h1>Convert effective LAI to LAI<a class="headerlink" href="#convert-effective-lai-to-lai" title="Link to this heading">#</a></h1>
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Link to this heading">#</a></h2>
<p>This notebook demonstrates the conversion from effective to true leaf area index (LAI) using a clumping factor. It includes the propagation of the uncertainty to the true LAI, including many but not all additional sources of uncertainty.</p>
</section>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Link to this heading">#</a></h2>
<p>The retrieval of LAI from optical sensors has to make assumptions about the canopy structure, which modifies the signal retrieved by the satellite. Different distributions (clumping) of the same amount of one-sided leaf area per unit ground (the definition of LAI) leads to different optical signals. Some products use a-priori information about the biome type, others, like TIP (used for C3S LAI v2 – v4 or higher), assume a turbid medium. This is called an effective LAI. Arguably, depending on the degree of realism of the modelled canopy structure, there are differing degrees of effectiveness. The clumping parameter <span class="math notranslate nohighlight">\(\Omega\)</span> (sometimes <span class="math notranslate nohighlight">\(\zeta\)</span>) relates true LAI to effective LAI as (cf. <a class="reference external" href="https://agupubs.onlinelibrary.wiley.com/doi/full/10.1029/2005JD005952">Pinty et al. 2006</a> or <a class="reference external" href="https://doi.org/10.1029/2018RG000608">Fang et al. 2019</a>):
\begin{equation}
\textit{LAI}_\textit{eff}(\theta)=\Omega(\theta) \times \textit{LAI}.
\end{equation}
The dependence on the solar zenith angle <span class="math notranslate nohighlight">\(\theta\)</span> is included here only for completeness. C3S-TIP LAI is computed for diffuse isotropic illumination.</p>
<p>Depending on the application, it may or may not be meaningful to convert effective LAI to true LAI. Here, we use the Land Cover Class (LCC) - specific clumping indices found by <a class="reference external" href="https://doi.org/10.1016/j.rse.2005.05.003">Chen et al. (2005)</a> (also available <a class="reference external" href="http://faculty.geog.utoronto.ca/Chen/Chen's%20homepage/PDFfiles2/RSE-Chen2005.pdf">here</a>) over a period of 8 months (Nov. 1996 – June 1997) together with the C3S LCC product.</p>
</section>
<section id="required-packages">
<h2>Required packages<a class="headerlink" href="#required-packages" title="Link to this heading">#</a></h2>
<p>We use <code class="docutils literal notranslate"><span class="pre">xarray</span></code> for handling netCDF data sets and <code class="docutils literal notranslate"><span class="pre">numpy</span></code> for the computations. <code class="docutils literal notranslate"><span class="pre">OrderedDict</span></code> is required to acces dictionaries by index, and <code class="docutils literal notranslate"><span class="pre">datetime</span></code> for monitoring the performance of the individual cells. Enabling <code class="docutils literal notranslate"><span class="pre">dask</span></code> would be required for larger datasets, but it proved problematic to use a function of a dask array as index for the pre-computed factors in function <code class="docutils literal notranslate"><span class="pre">convert_LAI</span></code>. This may however be solvable.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#import dask # to be done</span>
<span class="kn">import</span> <span class="nn">xarray</span> <span class="k">as</span> <span class="nn">xr</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">OrderedDict</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="data">
<h2>Data<a class="headerlink" href="#data" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>effective LAI, flags, and uncertainty from the CDS (Copernicus Data Store)</p></li>
<li><p>C3S LCC from the CDS</p></li>
<li><p>LCC-specific clumping factors from Table 3 of <a class="reference external" href="https://doi.org/10.1016/j.rse.2005.05.003">Chen et al. (2005)</a></p></li>
</ul>
</section>
<section id="methodology">
<h2>Methodology<a id='Methodology'></a><a class="headerlink" href="#methodology" title="Link to this heading">#</a></h2>
<p>The computation of the true LAI from effective LAI by dividing it with the clumping index may seem trivial, but knowing the correct clumping index is not easy. It actually introduces a number of uncertainties, as there are:</p>
<ol class="arabic simple">
<li><p>uncertainty of the land cover classification</p></li>
<li><p>clumping variation within same land cover class (different plant functional types, growth states &amp;c.)</p></li>
<li><p>seasonal variation of clumping</p></li>
<li><p>mapping uncertainty between land cover classes</p></li>
</ol>
<p>(1) is addressed by using the confusion matrix of the C3S LCC product (<a class="reference external" href="https://datastore.copernicus-climate.eu/documents/satellite-land-cover/WP2-FDDP-LC-2021-2022-SENTINEL3-300m-v2.1.1_PQAR_v1.2_final.pdf">C3S LCC PQAR</a>), also averaging (with probability weights) over the classes. This does, however, not account for temporal LCC changes which have not yet found their way into the LCC product.</p>
<p>(2) is partly addressed by converting the range of Chen et al.’s clumping indices into an uncertainty by assuming that they define the 97.7%-quantiles, corresponding to 2 sigma of a Gaussian.</p>
<p>(3) is neglected here, as well as the reported tendencies. Also note, that the clumping parameters of <a class="reference external" href="https://doi.org/10.1016/j.rse.2005.05.003">Chen et al. (2005)</a> were not computed over a full year.</p>
<p>(4) is caused by the somewhat differing classification schemes used by <a class="reference external" href="https://doi.org/10.1016/j.rse.2005.05.003">Chen et al. (2005)</a> and C3S LCC. It is partly accounted for by averaging over the corresponding clumping indices where multiple ‘Chen’-classes are assigned to one C3S LCC.</p>
<p>Therefore, the presented methodology and its results should be interpreted with caution, as it merely demonstrates an approach to investigate the magnitude of the difference and the effects of the sources of uncertainty. A clumping index derived on the basis of plant functional types, including a phenological cycle is expected to give superior results.</p>
<section id="mapping-between-land-cover-classes">
<h3>Mapping between land cover classes<a class="headerlink" href="#mapping-between-land-cover-classes" title="Link to this heading">#</a></h3>
<p>We have implemented the land cover classes system (LCCS, cf. Appendix A of <a class="reference external" href="https://datastore.copernicus-climate.eu/documents/satellite-land-cover/WP2-FDDP-LC-2021-2022-SENTINEL3-300m-v2.1.1_PUGS_v1.1_final.pdf">C3S LCC PUG</a>) and its mapping to the class numbers used in Table 3 of <a class="reference external" href="https://doi.org/10.1016/j.rse.2005.05.003">Chen et al. (2005)</a> as ordered dictionaries. This mapping is not authoritative and open to revision by the informed reader. We put all the Chen classes and related variables into a python class named <code class="docutils literal notranslate"><span class="pre">Clumping</span></code> to achieve a name space separation. This class also contains an uncertainty estimate of the Clumping index, derived from the range given in Chen et al.’s table in the way explained in the <a class="reference internal" href="#Methodology"><span class="xref myst">Methodology section</span></a> above.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">LCCS_codes</span> <span class="o">=</span> <span class="p">[</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">110</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">130</span><span class="p">,</span> <span class="mi">140</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">160</span><span class="p">,</span> <span class="mi">170</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">190</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">210</span><span class="p">,</span> <span class="mi">220</span> <span class="p">]</span>

<span class="n">LCCS_legend</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">(</span>
    <span class="p">{</span>
        <span class="mi">0</span>   <span class="p">:</span> <span class="s2">&quot;No Data&quot;</span><span class="p">,</span>
        <span class="mi">10</span>  <span class="p">:</span> <span class="s2">&quot;Cropland, rainfed&quot;</span><span class="p">,</span>
        <span class="mi">20</span>  <span class="p">:</span> <span class="s2">&quot;Cropland, irrigated or post-flooding&quot;</span><span class="p">,</span>
        <span class="mi">30</span>  <span class="p">:</span> <span class="s2">&quot;Mosaic cropland (&gt;50%) / natural vegetation (tree, shrub, herbaceous cover) (&lt;50%)&quot;</span><span class="p">,</span>
        <span class="mi">40</span>  <span class="p">:</span> <span class="s2">&quot;Mosaic natural vegetation (tree, shrub, herbaceous cover) (&gt;50%) / cropland (&lt;50%)&quot;</span><span class="p">,</span>
        <span class="mi">50</span>  <span class="p">:</span> <span class="s2">&quot;Tree cover, broadleaved, evergreen, closed to open (&gt;15%)&quot;</span><span class="p">,</span>
        <span class="mi">60</span>  <span class="p">:</span> <span class="s2">&quot;Tree cover, broadleaved, deciduous, closed to open (&gt;15%)&quot;</span><span class="p">,</span>
        <span class="mi">70</span>  <span class="p">:</span> <span class="s2">&quot;Tree cover, needleleaved, evergreen, closed to open (&gt;15%)&quot;</span><span class="p">,</span>
        <span class="mi">80</span>  <span class="p">:</span> <span class="s2">&quot;Tree cover, needleleaved, deciduous, closed to open (&gt;15%)&quot;</span><span class="p">,</span>
        <span class="mi">90</span>  <span class="p">:</span> <span class="s2">&quot;Tree cover, mixed leaf type (broadleaved and needleleaved)&quot;</span><span class="p">,</span>
        <span class="mi">100</span> <span class="p">:</span> <span class="s2">&quot;Mosaic tree and shrub (&gt;50%) / herbaceous cover (&lt;50%)&quot;</span><span class="p">,</span>
        <span class="mi">110</span> <span class="p">:</span> <span class="s2">&quot;Mosaic herbaceous cover (&gt;50%) / tree and shrub (&lt;50%)&quot;</span><span class="p">,</span>
        <span class="mi">120</span> <span class="p">:</span> <span class="s2">&quot;Shrubland&quot;</span><span class="p">,</span>
        <span class="mi">130</span> <span class="p">:</span> <span class="s2">&quot;Grassland&quot;</span><span class="p">,</span>
        <span class="mi">140</span> <span class="p">:</span> <span class="s2">&quot;Lichens and mosses&quot;</span><span class="p">,</span>
        <span class="mi">150</span> <span class="p">:</span> <span class="s2">&quot;Sparse vegetation (tree, shrub, herbaceous cover) (&lt;15%)&quot;</span><span class="p">,</span>
        <span class="mi">160</span> <span class="p">:</span> <span class="s2">&quot;Tree cover, flooded, fresh or brackish water&quot;</span><span class="p">,</span>
        <span class="mi">170</span> <span class="p">:</span> <span class="s2">&quot;Tree cover, flooded, saline water&quot;</span><span class="p">,</span>
        <span class="mi">180</span> <span class="p">:</span> <span class="s2">&quot;Shrub or herbaceous cover, flooded, fresh/saline/brackish water&quot;</span><span class="p">,</span>
        <span class="mi">190</span> <span class="p">:</span> <span class="s2">&quot;Urban areas&quot;</span><span class="p">,</span>
        <span class="mi">200</span> <span class="p">:</span> <span class="s2">&quot;Bare areas&quot;</span><span class="p">,</span>
        <span class="mi">210</span> <span class="p">:</span> <span class="s2">&quot;Water bodies&quot;</span><span class="p">,</span>
        <span class="mi">220</span> <span class="p">:</span> <span class="s2">&quot;Permanent snow and ice&quot;</span>
    <span class="p">}</span>
<span class="p">)</span>

<span class="k">class</span> <span class="nc">Clumping</span><span class="p">:</span>
<span class="c1">#&gt; Table 3 of Chen et al. (2005); https://doi.org/10.1016/j.rse.2005.05.003</span>
<span class="c1">#&gt; The land cover classification does not fully match the FAO Land Cover</span>
<span class="c1">#&gt; Classification System (LCCS).</span>
    
    <span class="n">class_codes</span> <span class="o">=</span> <span class="p">[</span> <span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">13</span><span class="p">,</span><span class="mi">14</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">16</span><span class="p">,</span><span class="mi">17</span><span class="p">,</span><span class="mi">18</span><span class="p">,</span><span class="mi">19</span><span class="p">]</span>
    <span class="n">legend</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">(</span>
        <span class="p">{</span>
            <span class="s2">&quot;1&quot;</span>  <span class="p">:</span> <span class="s2">&quot;Tree Cover, broadleaf, evergreen&quot;</span><span class="p">,</span>
            <span class="s2">&quot;2&quot;</span>  <span class="p">:</span> <span class="s2">&quot;Tree Cover, broadleaf, deciduous, closed&quot;</span><span class="p">,</span>
            <span class="s2">&quot;3&quot;</span>  <span class="p">:</span> <span class="s2">&quot;Tree Cover, broadleaf, deciduous, open&quot;</span><span class="p">,</span>
            <span class="s2">&quot;4&quot;</span>  <span class="p">:</span> <span class="s2">&quot;Tree Cover, needleleaf, evergreen&quot;</span><span class="p">,</span>
            <span class="s2">&quot;5&quot;</span>  <span class="p">:</span> <span class="s2">&quot;Tree Cover, needleleaf, deciduous&quot;</span><span class="p">,</span>
            <span class="s2">&quot;6&quot;</span>  <span class="p">:</span> <span class="s2">&quot;Tree Cover, mixed leaf type&quot;</span><span class="p">,</span>
            <span class="s2">&quot;7&quot;</span>  <span class="p">:</span> <span class="s2">&quot;Tree Cover, regularly flooded, fresh water&quot;</span><span class="p">,</span>
            <span class="s2">&quot;8&quot;</span>  <span class="p">:</span> <span class="s2">&quot;Tree Cover, regularly flooded, saline water&quot;</span><span class="p">,</span>
            <span class="s2">&quot;9&quot;</span>  <span class="p">:</span> <span class="s2">&quot;Mosaic: Tree Cover / Other natural vegetation&quot;</span><span class="p">,</span>
            <span class="s2">&quot;10&quot;</span> <span class="p">:</span> <span class="s2">&quot;Tree Cover, burnt&quot;</span><span class="p">,</span>
            <span class="s2">&quot;11&quot;</span> <span class="p">:</span> <span class="s2">&quot;Shrub Cover, closed-open, evergreen&quot;</span><span class="p">,</span>
            <span class="s2">&quot;12&quot;</span> <span class="p">:</span> <span class="s2">&quot;Shrub Cover, closed-open, deciduous&quot;</span><span class="p">,</span>
            <span class="s2">&quot;13&quot;</span> <span class="p">:</span> <span class="s2">&quot;Herbaceous Cover, closed-open&quot;</span><span class="p">,</span>
            <span class="s2">&quot;14&quot;</span> <span class="p">:</span> <span class="s2">&quot;Sparse herbaceous or sparse shrub cover&quot;</span><span class="p">,</span>
            <span class="s2">&quot;15&quot;</span> <span class="p">:</span> <span class="s2">&quot;Reg. flooded shrub and/or herbaceous cover&quot;</span><span class="p">,</span>
            <span class="s2">&quot;16&quot;</span> <span class="p">:</span> <span class="s2">&quot;Cultivated and managed areas&quot;</span><span class="p">,</span>
            <span class="s2">&quot;17&quot;</span> <span class="p">:</span> <span class="s2">&quot;Mosaic: Cropland / Tree Cover / Natural veg&quot;</span><span class="p">,</span>
            <span class="s2">&quot;18&quot;</span> <span class="p">:</span> <span class="s2">&quot;Mosaic: Cropland / Shrub and/or grass cover&quot;</span><span class="p">,</span>
            <span class="s2">&quot;19&quot;</span> <span class="p">:</span> <span class="s2">&quot;Bare Areas&quot;</span> <span class="p">}</span>
    <span class="p">)</span>

<span class="c1">#&gt; This is the mapping from the LCCS to the classes used in Chen et al.; this</span>
<span class="c1">#&gt; may require adjustment! E.g. a grassland class seems to be missing.</span>
    <span class="n">class_of_LCCS</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">(</span> <span class="c1"># not mapped to: 10; unsure: 18, 19</span>
        <span class="p">{</span>
            <span class="mi">10</span> <span class="p">:</span> <span class="p">[</span><span class="mi">16</span><span class="p">],</span>
            <span class="mi">20</span> <span class="p">:</span> <span class="p">[</span><span class="mi">15</span><span class="p">,</span><span class="mi">16</span><span class="p">],</span>
            <span class="mi">30</span> <span class="p">:</span> <span class="p">[</span><span class="mi">17</span><span class="p">,</span><span class="mi">18</span><span class="p">],</span>
            <span class="mi">40</span> <span class="p">:</span> <span class="p">[</span><span class="mi">9</span><span class="p">],</span>
            <span class="mi">50</span> <span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">],</span>
            <span class="mi">60</span> <span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span>
            <span class="mi">70</span> <span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">],</span>
            <span class="mi">80</span> <span class="p">:</span> <span class="p">[</span><span class="mi">5</span><span class="p">],</span>
            <span class="mi">90</span> <span class="p">:</span> <span class="p">[</span><span class="mi">6</span><span class="p">],</span>
            <span class="mi">100</span> <span class="p">:</span> <span class="p">[</span><span class="mi">9</span><span class="p">],</span>
            <span class="mi">110</span> <span class="p">:</span> <span class="p">[</span><span class="mi">9</span><span class="p">,</span><span class="mi">13</span><span class="p">],</span>
<span class="c1"># Chen et al.: &quot;The &#39;Shrub&#39; and &#39;Grassland&#39; classes were retained, as the modeling results for </span>
<span class="c1">#               broadleaf trees can be extended to these classes [...]&quot;</span>
            <span class="mi">120</span> <span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">12</span><span class="p">],</span>
            <span class="mi">130</span> <span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">],</span> 
            <span class="mi">140</span> <span class="p">:</span> <span class="p">[</span><span class="mi">19</span><span class="p">],</span>
            <span class="mi">150</span> <span class="p">:</span> <span class="p">[</span><span class="mi">14</span><span class="p">],</span>
            <span class="mi">160</span> <span class="p">:</span> <span class="p">[</span><span class="mi">7</span><span class="p">],</span>
            <span class="mi">170</span> <span class="p">:</span> <span class="p">[</span><span class="mi">8</span><span class="p">],</span>
            <span class="mi">180</span> <span class="p">:</span> <span class="p">[</span><span class="mi">15</span><span class="p">],</span>
            <span class="mi">190</span> <span class="p">:</span> <span class="p">[</span><span class="mi">19</span><span class="p">],</span>
            <span class="mi">200</span> <span class="p">:</span> <span class="p">[</span><span class="mi">19</span><span class="p">],</span>
            <span class="mi">210</span> <span class="p">:</span> <span class="p">[</span><span class="mi">19</span><span class="p">],</span>
            <span class="mi">220</span> <span class="p">:</span> <span class="p">[</span><span class="mi">19</span><span class="p">]</span>
        <span class="p">}</span>
    <span class="p">)</span>
<span class="c1"># clumping index min, max, and mean from Chen et al.&#39;s table:</span>
    <span class="n">ci_min</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.59</span><span class="p">,</span>	<span class="mf">0.59</span><span class="p">,</span>	<span class="mf">0.62</span><span class="p">,</span>	<span class="mf">0.55</span><span class="p">,</span>	<span class="mf">0.60</span><span class="p">,</span>	<span class="mf">0.58</span><span class="p">,</span>	<span class="mf">0.61</span><span class="p">,</span>
                       <span class="mf">0.65</span><span class="p">,</span>	<span class="mf">0.64</span><span class="p">,</span>	<span class="mf">0.65</span><span class="p">,</span>	<span class="mf">0.62</span><span class="p">,</span>	<span class="mf">0.62</span><span class="p">,</span>	<span class="mf">0.64</span><span class="p">,</span>	<span class="mf">0.67</span><span class="p">,</span>
                       <span class="mf">0.68</span><span class="p">,</span>	<span class="mf">0.63</span><span class="p">,</span>	<span class="mf">0.64</span><span class="p">,</span>	<span class="mf">0.65</span><span class="p">,</span>	<span class="mf">0.75</span><span class="p">])</span>
    
    <span class="n">ci_max</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.68</span><span class="p">,</span>	<span class="mf">0.79</span><span class="p">,</span>	<span class="mf">0.78</span><span class="p">,</span>	<span class="mf">0.68</span><span class="p">,</span>	<span class="mf">0.77</span><span class="p">,</span>	<span class="mf">0.79</span><span class="p">,</span>	<span class="mf">0.69</span><span class="p">,</span>
                       <span class="mf">0.79</span><span class="p">,</span>	<span class="mf">0.82</span><span class="p">,</span>	<span class="mf">0.86</span><span class="p">,</span>	<span class="mf">0.80</span><span class="p">,</span>	<span class="mf">0.80</span><span class="p">,</span>	<span class="mf">0.83</span><span class="p">,</span>	<span class="mf">0.84</span><span class="p">,</span>
                       <span class="mf">0.85</span><span class="p">,</span>	<span class="mf">0.83</span><span class="p">,</span>	<span class="mf">0.76</span><span class="p">,</span>	<span class="mf">0.81</span><span class="p">,</span>	<span class="mf">0.99</span><span class="p">])</span>

    <span class="n">ci_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.63</span><span class="p">,</span>	<span class="mf">0.69</span><span class="p">,</span>	<span class="mf">0.70</span><span class="p">,</span>	<span class="mf">0.62</span><span class="p">,</span>	<span class="mf">0.68</span><span class="p">,</span>	<span class="mf">0.69</span><span class="p">,</span>	<span class="mf">0.65</span><span class="p">,</span>
                        <span class="mf">0.72</span><span class="p">,</span>	<span class="mf">0.72</span><span class="p">,</span>	<span class="mf">0.75</span><span class="p">,</span>	<span class="mf">0.71</span><span class="p">,</span>	<span class="mf">0.71</span><span class="p">,</span>	<span class="mf">0.74</span><span class="p">,</span>	<span class="mf">0.75</span><span class="p">,</span>
                        <span class="mf">0.77</span><span class="p">,</span>	<span class="mf">0.73</span><span class="p">,</span>	<span class="mf">0.70</span><span class="p">,</span>	<span class="mf">0.73</span><span class="p">,</span>	<span class="mf">0.87</span><span class="p">])</span>

<span class="c1"># For the uncertainty, we assume that the distribution is uniform above</span>
<span class="c1"># and below the mean, respectively, thus making the mean also the</span>
<span class="c1"># median. We then assume that the reported max and min values are the 97.7%-quantiles </span>
<span class="c1"># which correspond to 2 sigma of a Gaussian distribution. The average over both sided is taken, to</span>
<span class="c1"># account for cases where the values are not symmetric. Since no information</span>
<span class="c1"># about the distribution is available in Chen et al. (2005), the clumping</span>
<span class="c1"># index uncertainty is modelled as a Gaussian here. </span>
    <span class="n">ci_uncertainty</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">ci_max</span> <span class="o">-</span> <span class="n">ci_min</span><span class="p">)</span> <span class="c1"># 1-sigma; ((max-mean)+(mean-min)=(max-min)</span>
<span class="c1"># tendencies from Table 3, not used:</span>
    <span class="n">ci_d_NL</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="o">-</span><span class="mf">0.006</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.019</span><span class="p">,</span>  <span class="o">-</span><span class="mf">0.005</span><span class="p">,</span>  <span class="o">-</span><span class="mf">0.012</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.033</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.024</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>   <span class="p">,</span>  <span class="n">np</span><span class="o">.</span><span class="n">nan</span>   <span class="p">,</span>  <span class="o">-</span><span class="mf">0.013</span><span class="p">,</span>  <span class="o">-</span><span class="mf">0.036</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.020</span><span class="p">,</span>  <span class="o">-</span><span class="mf">0.016</span><span class="p">,</span>  <span class="o">-</span><span class="mf">0.016</span><span class="p">,</span>  <span class="o">-</span><span class="mf">0.019</span><span class="p">,</span>  <span class="o">-</span><span class="mf">0.026</span><span class="p">,</span>  <span class="o">-</span><span class="mf">0.018</span><span class="p">,</span>  <span class="o">-</span><span class="mf">0.011</span><span class="p">,</span>  <span class="o">-</span><span class="mf">0.018</span><span class="p">,</span>  <span class="o">-</span><span class="mf">0.032</span> <span class="p">])</span>
    <span class="n">ci_d_EQ</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="o">-</span><span class="mf">0.004</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.001</span><span class="p">,</span>  <span class="mf">0.007</span> <span class="p">,</span>  <span class="o">-</span><span class="mf">0.017</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>    <span class="p">,</span> <span class="o">-</span><span class="mf">0.018</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.002</span><span class="p">,</span>  <span class="o">-</span><span class="mf">0.006</span><span class="p">,</span>  <span class="mf">0.008</span> <span class="p">,</span>  <span class="n">np</span><span class="o">.</span><span class="n">nan</span>   <span class="p">,</span> <span class="o">-</span><span class="mf">0.010</span><span class="p">,</span>  <span class="mf">0.009</span> <span class="p">,</span>  <span class="mf">0.003</span> <span class="p">,</span>  <span class="mf">0.008</span> <span class="p">,</span>  <span class="mf">0.004</span> <span class="p">,</span>  <span class="o">-</span><span class="mf">0.006</span><span class="p">,</span>  <span class="o">-</span><span class="mf">0.004</span><span class="p">,</span>  <span class="mf">0.001</span> <span class="p">,</span>  <span class="o">-</span><span class="mf">0.03</span>  <span class="p">])</span>
    <span class="n">ci_d_SL</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="mf">0.024</span>  <span class="p">,</span> <span class="mf">0.021</span> <span class="p">,</span>  <span class="mf">0.025</span> <span class="p">,</span>  <span class="mf">0.009</span> <span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>    <span class="p">,</span> <span class="mf">0.011</span> <span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>   <span class="p">,</span>  <span class="n">np</span><span class="o">.</span><span class="n">nan</span>   <span class="p">,</span>  <span class="n">np</span><span class="o">.</span><span class="n">nan</span>   <span class="p">,</span>  <span class="n">np</span><span class="o">.</span><span class="n">nan</span>   <span class="p">,</span> <span class="mf">0.024</span> <span class="p">,</span>  <span class="mf">0.022</span> <span class="p">,</span>  <span class="mf">0.026</span> <span class="p">,</span>  <span class="mf">0.024</span> <span class="p">,</span>  <span class="mf">0.024</span> <span class="p">,</span>  <span class="mf">0.026</span> <span class="p">,</span>  <span class="mf">0.024</span> <span class="p">,</span>  <span class="mf">0.026</span> <span class="p">,</span>  <span class="mf">0.027</span>  <span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>Here, we provide the confusion matrix, copied from the <a class="reference external" href="https://datastore.copernicus-climate.eu/documents/satellite-land-cover/WP2-FDDP-LC-2021-2022-SENTINEL3-300m-v2.1.1_PQAR_v1.2_final.pdf">C3S LCC PQAR</a>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># confusinon matrices of LCC, from C3S ICDR Land Cover Product Quality</span>
<span class="c1"># Assessment Report (D5.2.2_PQAR_ICDR_LC_v2.1.x_PRODUCTS_v1.0)</span>
<span class="n">cm_2016</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
    <span class="p">[</span> <span class="mi">121</span><span class="p">,</span>	<span class="mi">30</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">2</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">5</span><span class="p">,</span>	<span class="mi">14</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">2</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span>  <span class="p">],</span>
    <span class="p">[</span> <span class="mi">9</span><span class="p">,</span>	<span class="mi">24</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">2</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span>  <span class="p">],</span>
    <span class="p">[</span> <span class="mi">9</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">4</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">2</span><span class="p">,</span>	<span class="mi">3</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span>  <span class="p">],</span>
    <span class="p">[</span> <span class="mi">8</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">7</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">3</span><span class="p">,</span>	<span class="mi">7</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span>  <span class="p">],</span>
    <span class="p">[</span> <span class="mi">3</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">199</span><span class="p">,</span>	<span class="mi">15</span><span class="p">,</span>	<span class="mi">3</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">3</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">2</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span>  <span class="p">],</span>
    <span class="p">[</span> <span class="mi">1</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">6</span><span class="p">,</span>	<span class="mi">72</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">8</span><span class="p">,</span>	<span class="mi">16</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">13</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span>  <span class="p">],</span>
    <span class="p">[</span> <span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">10</span><span class="p">,</span>	<span class="mi">3</span><span class="p">,</span>	<span class="mi">53</span><span class="p">,</span>	<span class="mi">2</span><span class="p">,</span>	<span class="mi">16</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">2</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">4</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span>  <span class="p">],</span>
    <span class="p">[</span> <span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">3</span><span class="p">,</span>	<span class="mi">23</span><span class="p">,</span>	<span class="mi">3</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">3</span><span class="p">,</span>	<span class="mi">3</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">4</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span>  <span class="p">],</span>
    <span class="p">[</span> <span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">2</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">14</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span>  <span class="p">],</span>
    <span class="p">[</span> <span class="mi">2</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">8</span><span class="p">,</span>	<span class="mi">10</span><span class="p">,</span>	<span class="mi">3</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">6</span><span class="p">,</span>	<span class="mi">5</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">2</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span>  <span class="p">],</span>
    <span class="p">[</span> <span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">3</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span>  <span class="p">],</span>
    <span class="p">[</span> <span class="mi">8</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">7</span><span class="p">,</span>	<span class="mi">19</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">105</span><span class="p">,</span>	<span class="mi">21</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">8</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span>  <span class="p">],</span>
    <span class="p">[</span> <span class="mi">8</span><span class="p">,</span>	<span class="mi">3</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">19</span><span class="p">,</span>	<span class="mi">64</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">12</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">25</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">1</span>  <span class="p">],</span>
    <span class="p">[</span> <span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">2</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span>  <span class="p">],</span>
    <span class="p">[</span> <span class="mi">5</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">23</span><span class="p">,</span>	<span class="mi">22</span><span class="p">,</span>	<span class="mi">3</span><span class="p">,</span>	<span class="mi">25</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">11</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span>  <span class="p">],</span>
    <span class="p">[</span> <span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">6</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span>  <span class="p">],</span>
    <span class="p">[</span> <span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span>  <span class="p">],</span>
    <span class="p">[</span> <span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">6</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">4</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span>  <span class="p">],</span>
    <span class="p">[</span> <span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">3</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span>  <span class="p">],</span>
    <span class="p">[</span> <span class="mi">2</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">3</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">13</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">61</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span>  <span class="p">],</span>
    <span class="p">[</span> <span class="mi">0</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">57</span><span class="p">,</span>	<span class="mi">0</span>  <span class="p">],</span>
    <span class="p">[</span> <span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span>  <span class="p">]</span>
<span class="p">])</span>

<span class="n">cm_2017</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
    <span class="p">[</span> <span class="mi">121</span><span class="p">,</span>	<span class="mi">30</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">2</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">5</span><span class="p">,</span>	<span class="mi">14</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">2</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span> <span class="p">],</span>
    <span class="p">[</span> <span class="mi">9</span><span class="p">,</span>	<span class="mi">24</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">2</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span> <span class="p">],</span>
    <span class="p">[</span> <span class="mi">9</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">4</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">2</span><span class="p">,</span>	<span class="mi">3</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span> <span class="p">],</span>
    <span class="p">[</span> <span class="mi">8</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">7</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">3</span><span class="p">,</span>	<span class="mi">7</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span> <span class="p">],</span>
    <span class="p">[</span> <span class="mi">3</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">199</span><span class="p">,</span>	<span class="mi">15</span><span class="p">,</span>	<span class="mi">3</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">3</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">2</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span> <span class="p">],</span>
    <span class="p">[</span> <span class="mi">1</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">6</span><span class="p">,</span>	<span class="mi">72</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">8</span><span class="p">,</span>	<span class="mi">16</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">13</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span> <span class="p">],</span>
    <span class="p">[</span> <span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">10</span><span class="p">,</span>	<span class="mi">3</span><span class="p">,</span>	<span class="mi">54</span><span class="p">,</span>	<span class="mi">2</span><span class="p">,</span>	<span class="mi">16</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">2</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">4</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span> <span class="p">],</span>
    <span class="p">[</span> <span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">3</span><span class="p">,</span>	<span class="mi">23</span><span class="p">,</span>	<span class="mi">3</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">3</span><span class="p">,</span>	<span class="mi">3</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">4</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span> <span class="p">],</span>
    <span class="p">[</span> <span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">2</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">14</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span> <span class="p">],</span>
    <span class="p">[</span> <span class="mi">2</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">8</span><span class="p">,</span>	<span class="mi">10</span><span class="p">,</span>	<span class="mi">3</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">6</span><span class="p">,</span>	<span class="mi">5</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">2</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span> <span class="p">],</span>
    <span class="p">[</span> <span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">3</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span> <span class="p">],</span>
    <span class="p">[</span> <span class="mi">8</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">7</span><span class="p">,</span>	<span class="mi">19</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">105</span><span class="p">,</span>	<span class="mi">21</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">8</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span> <span class="p">],</span>
    <span class="p">[</span> <span class="mi">8</span><span class="p">,</span>	<span class="mi">3</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">19</span><span class="p">,</span>	<span class="mi">64</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">12</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">25</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">1</span> <span class="p">],</span>
    <span class="p">[</span> <span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">2</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span> <span class="p">],</span>
    <span class="p">[</span> <span class="mi">5</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">23</span><span class="p">,</span>	<span class="mi">22</span><span class="p">,</span>	<span class="mi">3</span><span class="p">,</span>	<span class="mi">25</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">11</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span> <span class="p">],</span>
    <span class="p">[</span> <span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">6</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span> <span class="p">],</span>
    <span class="p">[</span> <span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span> <span class="p">],</span>
    <span class="p">[</span> <span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">6</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">4</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span> <span class="p">],</span>
    <span class="p">[</span> <span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">3</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span> <span class="p">],</span>
    <span class="p">[</span> <span class="mi">2</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">3</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">13</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">61</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span> <span class="p">],</span>
    <span class="p">[</span> <span class="mi">0</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">57</span><span class="p">,</span>	<span class="mi">0</span> <span class="p">],</span>
    <span class="p">[</span> <span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span> <span class="p">]</span>
<span class="p">])</span>

<span class="n">cm_2018</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
    <span class="p">[</span> <span class="mi">119</span><span class="p">,</span>	<span class="mi">30</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">2</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">5</span><span class="p">,</span>	<span class="mi">14</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">2</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span> <span class="p">],</span>
    <span class="p">[</span> <span class="mi">9</span><span class="p">,</span>	<span class="mi">24</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">2</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span> <span class="p">],</span>
    <span class="p">[</span> <span class="mi">9</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">4</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">2</span><span class="p">,</span>	<span class="mi">3</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span> <span class="p">],</span>
    <span class="p">[</span> <span class="mi">8</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">7</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">3</span><span class="p">,</span>	<span class="mi">7</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span> <span class="p">],</span>
    <span class="p">[</span> <span class="mi">3</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">197</span><span class="p">,</span>	<span class="mi">14</span><span class="p">,</span>	<span class="mi">3</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">3</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">2</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span> <span class="p">],</span>
    <span class="p">[</span> <span class="mi">1</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">6</span><span class="p">,</span>	<span class="mi">71</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">8</span><span class="p">,</span>	<span class="mi">16</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">13</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span> <span class="p">],</span>
    <span class="p">[</span> <span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">10</span><span class="p">,</span>	<span class="mi">3</span><span class="p">,</span>	<span class="mi">53</span><span class="p">,</span>	<span class="mi">2</span><span class="p">,</span>	<span class="mi">16</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">2</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">4</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span> <span class="p">],</span>
    <span class="p">[</span> <span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">3</span><span class="p">,</span>	<span class="mi">23</span><span class="p">,</span>	<span class="mi">3</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">2</span><span class="p">,</span>	<span class="mi">3</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">4</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span> <span class="p">],</span>
    <span class="p">[</span> <span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">2</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">14</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span> <span class="p">],</span>
    <span class="p">[</span> <span class="mi">2</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">8</span><span class="p">,</span>	<span class="mi">10</span><span class="p">,</span>	<span class="mi">3</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">6</span><span class="p">,</span>	<span class="mi">5</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">2</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span> <span class="p">],</span>
    <span class="p">[</span> <span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">2</span><span class="p">,</span>	<span class="mi">3</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span> <span class="p">],</span>
    <span class="p">[</span> <span class="mi">8</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">7</span><span class="p">,</span>	<span class="mi">19</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">105</span><span class="p">,</span>	<span class="mi">21</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">8</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span> <span class="p">],</span>
    <span class="p">[</span> <span class="mi">8</span><span class="p">,</span>	<span class="mi">3</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">19</span><span class="p">,</span>	<span class="mi">64</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">14</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">25</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">1</span> <span class="p">],</span>
    <span class="p">[</span> <span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">2</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span> <span class="p">],</span>
    <span class="p">[</span> <span class="mi">5</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">23</span><span class="p">,</span>	<span class="mi">22</span><span class="p">,</span>	<span class="mi">3</span><span class="p">,</span>	<span class="mi">24</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">12</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span> <span class="p">],</span>
    <span class="p">[</span> <span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">6</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span> <span class="p">],</span>
    <span class="p">[</span> <span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span> <span class="p">],</span>
    <span class="p">[</span> <span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">6</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">4</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span> <span class="p">],</span>
    <span class="p">[</span> <span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">3</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span> <span class="p">],</span>
    <span class="p">[</span> <span class="mi">2</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">3</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">12</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">60</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span> <span class="p">],</span>
    <span class="p">[</span> <span class="mi">0</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">57</span><span class="p">,</span>	<span class="mi">0</span> <span class="p">],</span>
    <span class="p">[</span> <span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span> <span class="p">]</span>
<span class="p">])</span>

<span class="n">cm_2019</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
    <span class="p">[</span> <span class="mi">119</span><span class="p">,</span>	<span class="mi">30</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">2</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">5</span><span class="p">,</span>	<span class="mi">14</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">2</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span> <span class="p">],</span>
    <span class="p">[</span> <span class="mi">9</span><span class="p">,</span>	<span class="mi">24</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">2</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span> <span class="p">],</span>
    <span class="p">[</span> <span class="mi">8</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">4</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">2</span><span class="p">,</span>	<span class="mi">3</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span> <span class="p">],</span>
    <span class="p">[</span> <span class="mi">8</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">7</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">2</span><span class="p">,</span>	<span class="mi">7</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span> <span class="p">],</span>
    <span class="p">[</span> <span class="mi">3</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">198</span><span class="p">,</span>	<span class="mi">14</span><span class="p">,</span>	<span class="mi">3</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">2</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">3</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span> <span class="p">],</span>
    <span class="p">[</span> <span class="mi">1</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">6</span><span class="p">,</span>	<span class="mi">71</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">8</span><span class="p">,</span>	<span class="mi">16</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">12</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span> <span class="p">],</span>
    <span class="p">[</span> <span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">10</span><span class="p">,</span>	<span class="mi">3</span><span class="p">,</span>	<span class="mi">53</span><span class="p">,</span>	<span class="mi">2</span><span class="p">,</span>	<span class="mi">16</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">2</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">4</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span> <span class="p">],</span>
    <span class="p">[</span> <span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">2</span><span class="p">,</span>	<span class="mi">23</span><span class="p">,</span>	<span class="mi">3</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">2</span><span class="p">,</span>	<span class="mi">3</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">4</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span> <span class="p">],</span>
    <span class="p">[</span> <span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">2</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">14</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span> <span class="p">],</span>
    <span class="p">[</span> <span class="mi">3</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">8</span><span class="p">,</span>	<span class="mi">10</span><span class="p">,</span>	<span class="mi">2</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">5</span><span class="p">,</span>	<span class="mi">5</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">2</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span> <span class="p">],</span>
    <span class="p">[</span> <span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">2</span><span class="p">,</span>	<span class="mi">3</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span> <span class="p">],</span>
    <span class="p">[</span> <span class="mi">7</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">7</span><span class="p">,</span>	<span class="mi">19</span><span class="p">,</span>	<span class="mi">2</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">105</span><span class="p">,</span>	<span class="mi">21</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">8</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span> <span class="p">],</span>
    <span class="p">[</span> <span class="mi">9</span><span class="p">,</span>	<span class="mi">3</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">19</span><span class="p">,</span>	<span class="mi">64</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">14</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">25</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">1</span> <span class="p">],</span>
    <span class="p">[</span> <span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">2</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span> <span class="p">],</span>
    <span class="p">[</span> <span class="mi">5</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">23</span><span class="p">,</span>	<span class="mi">22</span><span class="p">,</span>	<span class="mi">3</span><span class="p">,</span>	<span class="mi">23</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">12</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span> <span class="p">],</span>
    <span class="p">[</span> <span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">6</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span> <span class="p">],</span>
    <span class="p">[</span> <span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span> <span class="p">],</span>
    <span class="p">[</span> <span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">6</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">4</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span> <span class="p">],</span>
    <span class="p">[</span> <span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">3</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span> <span class="p">],</span>
    <span class="p">[</span> <span class="mi">2</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">3</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">12</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">60</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span> <span class="p">],</span>
    <span class="p">[</span> <span class="mi">0</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">57</span><span class="p">,</span>	<span class="mi">0</span> <span class="p">],</span>
    <span class="p">[</span> <span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span> <span class="p">]</span>
<span class="p">])</span>

<span class="n">cm_2020</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
    <span class="p">[</span> <span class="mi">119</span><span class="p">,</span>	<span class="mi">30</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">2</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">5</span><span class="p">,</span>	<span class="mi">14</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">2</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span> <span class="p">],</span>
    <span class="p">[</span> <span class="mi">9</span><span class="p">,</span>	<span class="mi">24</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">2</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span> <span class="p">],</span>
    <span class="p">[</span> <span class="mi">8</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">4</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">2</span><span class="p">,</span>	<span class="mi">3</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span> <span class="p">],</span>
    <span class="p">[</span> <span class="mi">8</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">7</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">2</span><span class="p">,</span>	<span class="mi">7</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span> <span class="p">],</span>
    <span class="p">[</span> <span class="mi">3</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">197</span><span class="p">,</span>	<span class="mi">14</span><span class="p">,</span>	<span class="mi">3</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">2</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">3</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span> <span class="p">],</span>
    <span class="p">[</span> <span class="mi">1</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">6</span><span class="p">,</span>	<span class="mi">71</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">8</span><span class="p">,</span>	<span class="mi">16</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">12</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span> <span class="p">],</span>
    <span class="p">[</span> <span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">10</span><span class="p">,</span>	<span class="mi">3</span><span class="p">,</span>	<span class="mi">53</span><span class="p">,</span>	<span class="mi">2</span><span class="p">,</span>	<span class="mi">16</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">2</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">4</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span> <span class="p">],</span>
    <span class="p">[</span> <span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">2</span><span class="p">,</span>	<span class="mi">23</span><span class="p">,</span>	<span class="mi">3</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">2</span><span class="p">,</span>	<span class="mi">2</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">4</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span> <span class="p">],</span>
    <span class="p">[</span> <span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">2</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">14</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span> <span class="p">],</span>
    <span class="p">[</span> <span class="mi">3</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">8</span><span class="p">,</span>	<span class="mi">10</span><span class="p">,</span>	<span class="mi">2</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">5</span><span class="p">,</span>	<span class="mi">5</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">2</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span> <span class="p">],</span>
    <span class="p">[</span> <span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">2</span><span class="p">,</span>	<span class="mi">3</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span> <span class="p">],</span>
    <span class="p">[</span> <span class="mi">7</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">7</span><span class="p">,</span>	<span class="mi">19</span><span class="p">,</span>	<span class="mi">2</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">105</span><span class="p">,</span>	<span class="mi">22</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">8</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span> <span class="p">],</span>
    <span class="p">[</span> <span class="mi">9</span><span class="p">,</span>	<span class="mi">3</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">19</span><span class="p">,</span>	<span class="mi">64</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">14</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">26</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">1</span> <span class="p">],</span>
    <span class="p">[</span> <span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">2</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span> <span class="p">],</span>
    <span class="p">[</span> <span class="mi">5</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">23</span><span class="p">,</span>	<span class="mi">22</span><span class="p">,</span>	<span class="mi">3</span><span class="p">,</span>	<span class="mi">23</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">12</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span> <span class="p">],</span>
    <span class="p">[</span> <span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">6</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span> <span class="p">],</span>
    <span class="p">[</span> <span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span> <span class="p">],</span>
    <span class="p">[</span> <span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">6</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">4</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span> <span class="p">],</span>
    <span class="p">[</span> <span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">3</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span> <span class="p">],</span>
    <span class="p">[</span> <span class="mi">2</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">3</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">12</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">59</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span> <span class="p">],</span>
    <span class="p">[</span> <span class="mi">0</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">1</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">57</span><span class="p">,</span>	<span class="mi">0</span> <span class="p">],</span>
    <span class="p">[</span> <span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span> <span class="p">]</span>
<span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>In order to convert the entries of the confusion matrices from absolute values into probabilities, we define the following routine:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">abs_to_prob</span><span class="p">(</span><span class="n">confusion_matrix_LCC</span><span class="p">):</span>
    <span class="c1">#&gt; convert absolute numbers into probabilities:</span>
    <span class="n">confusion_matrix_prob_LCC</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">confusion_matrix_LCC</span><span class="p">),</span><span class="nb">len</span><span class="p">(</span><span class="n">confusion_matrix_LCC</span><span class="p">)])</span>
    <span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">confusion_matrix_LCC</span><span class="p">)):</span>
        <span class="n">rowsum</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span> <span class="n">confusion_matrix_LCC</span><span class="p">[</span><span class="n">irow</span><span class="p">][:]</span> <span class="p">)</span>
        <span class="k">for</span> <span class="n">icol</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">confusion_matrix_LCC</span><span class="p">[</span><span class="n">irow</span><span class="p">])):</span>
            <span class="k">if</span> <span class="p">(</span> <span class="n">rowsum</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">):</span>
                <span class="n">confusion_matrix_prob_LCC</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">icol</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span> <span class="n">confusion_matrix_LCC</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">icol</span><span class="p">]</span> <span class="o">/</span> <span class="n">rowsum</span> <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">confusion_matrix_prob_LCC</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">icol</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.</span>
        <span class="c1"># debug:print(irow,np.sum(confusion_matrix_prob_LCC[irow]))</span>
    <span class="k">return</span> <span class="n">confusion_matrix_prob_LCC</span>
</pre></div>
</div>
</div>
</div>
<p>We then can pre-compute the factors required in the conversion and in the uncertainty propagation, since they are a time-independent function of the LCC. The LAIs of all possible ‘Chen’-classes related to one LCC by the confusion matrix and by mapping ambiguity are averaged, weighted by probability, to get one most probable LAI per C3S LCC type:
\begin{equation}
\textit{LAI}<em>i(\textit{LAI}</em>\textit{eff},\textrm{LCC}) = \frac{1}{n}\sum_{i=1}^n p_i(\textrm{LCC}) \times
\frac{ \textit{LAI}_\textit{eff} } { \Omega_i(\textrm{LCC}) },
\end{equation}
where <span class="math notranslate nohighlight">\(i\)</span> is an index running over all <span class="math notranslate nohighlight">\(n\)</span> ‘Chen’-classes confused with one C3S LCC.</p>
<p>Since the factor <span class="math notranslate nohighlight">\(\textit{LAI}_\textit{eff}\)</span> is constant in the sum, the sum can be pre-computed into a conversion factor:
\begin{equation}
f_LAI_cl(LCC) = \frac{1}{n} \sum_{i=1}^n \frac{ p_i(\textrm{LCC}) } { \Omega_i(\textrm{LCC}) }.
\end{equation}
With this factor, the conversion becomes
\begin{equation}
\textit{LAI}<em>i(\textit{LAI}</em>\textit{eff},\textrm{LCC}) = f_LAI_cl(LCC) \times \textit{LAI}_\textit{eff}.
\end{equation}</p>
<p>For the uncertainty propagation, this means:
\begin{equation}
\sigma_{\textit{LAI}}(\textit{LAI}<em>\textit{eff},\textrm{LCC})^2 = \left( \sigma</em>{\textit{LAI}<em>\textit{eff}} \times f_LAI_cl \right)^2 +<br />
\left( \sigma</em>{\Omega(\textrm{LCC})} \times \textit{LAI}<em>\textit{eff} \times
( -\frac{1}{n})\sum</em>{i=1}^n \frac{ p_i(\textrm{LCC}) } { \Omega_i(\textrm{LCC})^2 } \right)^2.
\end{equation}
We also pre-compute the LAI-independent part of the factor in the second term of the above equation as
\begin{equation}
f_LAI_unc2_cl(LCC) = \left( \sigma_{\Omega(\textrm{LCC})} \times (-\frac{1}{n})\sum_{i=1}^n \frac{ p_i(\textrm{LCC}) } { \Omega_i(\textrm{LCC})^2 } \right)^2.
\end{equation}
In the computation of the uncertainty, we are treating the uncertainty of effective LAI and the uncertainty of the the clumping factor as independent.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">LCC_to_ix</span><span class="p">(</span><span class="n">LCC</span><span class="p">):</span>
    <span class="k">return</span><span class="p">(</span><span class="nb">int</span><span class="p">)((</span><span class="n">LCC</span><span class="o">-</span><span class="mi">10</span><span class="p">)</span><span class="o">/</span><span class="mi">10</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">vLCC_to_ix</span><span class="p">(</span><span class="n">LCC</span><span class="p">):</span>
    <span class="n">mLCC</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">LCC</span><span class="p">)</span>
    <span class="n">scalar_input</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">if</span> <span class="n">mLCC</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">mLCC</span> <span class="o">=</span> <span class="n">mLCC</span><span class="p">[</span><span class="kc">None</span><span class="p">]</span>  <span class="c1"># Makes x 1D</span>
        <span class="n">scalar_input</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">if</span> <span class="n">scalar_input</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">((</span><span class="nb">int</span><span class="p">)((</span><span class="n">mLCC</span><span class="o">-</span><span class="mi">10</span><span class="p">)</span><span class="o">/</span><span class="mi">10</span><span class="o">+</span><span class="mf">0.5</span><span class="p">))</span>
    <span class="k">return</span> <span class="p">((</span><span class="n">LCC</span><span class="o">-</span><span class="mi">10</span><span class="p">)</span><span class="o">/</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">()</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int8</span><span class="p">)</span>
    
   
<span class="k">def</span> <span class="nf">pre_compute_factors</span><span class="p">(</span><span class="n">confusion_matrix_prob_LCC</span><span class="p">):</span>
    <span class="c1">#</span>
    <span class="c1"># Pre-computation of factors for LAI and uncertainty computation</span>
    <span class="c1">#</span>
    <span class="c1"># Accounts for three sources of uncertainty:</span>
    <span class="c1"># (a) Uncertainty of the effective LAI</span>
    <span class="c1"># (b) Uncertainty caused by mis-classification of Land Cover Class</span>
    <span class="c1"># (c) Uncertainty of the clumping factors</span>
    <span class="c1"># (d) Mapping ambiguity between C3S LCC and Chen et al.&#39;s classes</span>
    <span class="c1">#</span>
    <span class="c1"># intermediate &quot;true&quot; LAI uncertainty factor from clumping uncertainty:</span>
    <span class="n">f_LAI_unc_cl</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">LCCS_codes</span><span class="p">),</span><span class="nb">len</span><span class="p">(</span><span class="n">Clumping</span><span class="o">.</span><span class="n">class_codes</span><span class="p">)])</span> 
    <span class="n">f_LAI_unc2_cl</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">LCCS_codes</span><span class="p">)])</span>
    <span class="c1"># intermediate &quot;true&quot; LAI factor:</span>
    <span class="n">f_LAI_cl</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">LCCS_codes</span><span class="p">)])</span>
    <span class="k">for</span> <span class="n">iLCC</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">LCCS_codes</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">iLCC</span> <span class="o">!=</span> <span class="n">LCC_to_ix</span><span class="p">(</span><span class="n">LCCS_codes</span><span class="p">[</span><span class="n">iLCC</span><span class="p">]):</span>
            <span class="k">raise</span> <span class="s2">&quot;dask limitation requires functional dependence between LCC code and array index.&quot;</span>       
        <span class="c1"># compute variance caused by potential mis-classification</span>
        <span class="k">for</span> <span class="n">icol</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">confusion_matrix_prob_LCC</span><span class="p">[</span><span class="n">iLCC</span><span class="p">])):</span>
            <span class="k">if</span> <span class="p">(</span> <span class="n">confusion_matrix_prob_LCC</span><span class="p">[</span><span class="n">iLCC</span><span class="p">][</span><span class="n">icol</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.</span> <span class="p">):</span>
                <span class="c1"># loop over list of mapped clumping classes</span>
                <span class="n">class_list</span> <span class="o">=</span> <span class="n">Clumping</span><span class="o">.</span><span class="n">class_of_LCCS</span><span class="p">[</span><span class="n">LCCS_codes</span><span class="p">[</span><span class="n">icol</span><span class="p">]]</span>
                <span class="n">nclasses</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">class_list</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;LCC&quot;</span><span class="p">,</span><span class="n">LCCS_codes</span><span class="p">[</span><span class="n">iLCC</span><span class="p">],</span><span class="s2">&quot;could be LCC&quot;</span><span class="p">,</span>
                      <span class="n">LCCS_codes</span><span class="p">[</span><span class="n">icol</span><span class="p">],</span><span class="s2">&quot;with propability&quot;</span><span class="p">,</span><span class="nb">int</span><span class="p">(</span><span class="mi">1000</span><span class="o">*</span><span class="n">confusion_matrix_prob_LCC</span><span class="p">[</span><span class="n">iLCC</span><span class="p">][</span><span class="n">icol</span><span class="p">])</span><span class="o">/</span><span class="mi">1000</span><span class="p">,</span><span class="s2">&quot;which maps to Chen et al. class(es)&quot;</span><span class="p">,</span>
                      <span class="n">class_list</span><span class="p">,</span> <span class="s2">&quot;(&quot;</span><span class="p">,</span><span class="n">nclasses</span><span class="p">,</span><span class="s2">&quot;)&quot;</span><span class="p">)</span> 
                <span class="k">if</span> <span class="p">(</span> <span class="n">nclasses</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="p">):</span>
                    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;unmapped class&quot;</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">ct</span> <span class="ow">in</span> <span class="n">class_list</span><span class="p">:</span> <span class="c1"># mapping ambiguity between LCCS and Chen classes, no uncertainty assigned</span>
                    <span class="n">iclump</span> <span class="o">=</span> <span class="n">Clumping</span><span class="o">.</span><span class="n">class_codes</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">ct</span><span class="p">)</span>
                    <span class="c1"># accumulate LAI factor:</span>
                    <span class="n">f_LAI_cl</span><span class="p">[</span><span class="n">iLCC</span><span class="p">]</span> <span class="o">+=</span> <span class="p">(</span> <span class="n">confusion_matrix_prob_LCC</span><span class="p">[</span><span class="n">iLCC</span><span class="p">][</span><span class="n">icol</span><span class="p">]</span> <span class="o">/</span>
                                      <span class="n">Clumping</span><span class="o">.</span><span class="n">ci_mean</span><span class="p">[</span><span class="n">iclump</span><span class="p">]</span> <span class="p">)</span> <span class="o">/</span> <span class="n">nclasses</span> 
                    <span class="c1"># accumulate uncertainty factor per clumping class; negative sign from derivative arbitrary (squared away in next step), but</span>
                    <span class="c1"># would matter if uncertainty sources were treated as correlated (extra terms):</span>
                    <span class="n">f_LAI_unc_cl</span><span class="p">[</span><span class="n">iLCC</span><span class="p">,</span><span class="n">iclump</span><span class="p">]</span> <span class="o">-=</span>  <span class="p">(</span>
                        <span class="n">Clumping</span><span class="o">.</span><span class="n">ci_uncertainty</span><span class="p">[</span><span class="n">iclump</span><span class="p">]</span> <span class="o">*</span>
                        <span class="n">confusion_matrix_prob_LCC</span><span class="p">[</span><span class="n">iLCC</span><span class="p">][</span><span class="n">icol</span><span class="p">]</span> <span class="o">/</span>
                        <span class="n">Clumping</span><span class="o">.</span><span class="n">ci_mean</span><span class="p">[</span><span class="n">iclump</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="p">)</span> <span class="o">/</span>  <span class="n">nclasses</span>
        <span class="n">f_LAI_unc2_cl</span><span class="p">[</span><span class="n">iLCC</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span> <span class="n">f_LAI_unc_cl</span><span class="p">[</span><span class="n">iLCC</span><span class="p">,:]</span><span class="o">**</span><span class="mi">2</span> <span class="p">)</span>
    <span class="k">return</span> <span class="n">f_LAI_cl</span><span class="p">,</span><span class="n">f_LAI_unc2_cl</span>
</pre></div>
</div>
</div>
</div>
<p>In the actual computation, we can then make use of these factors, limiting the number of operations per pixel to the required minimum.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">convert_LAI</span><span class="p">(</span><span class="n">LAI_eff</span><span class="p">,</span> <span class="n">LAI_eff_uncertainty</span><span class="p">,</span><span class="n">LCC_type</span><span class="p">):</span>
    <span class="n">iLCC</span> <span class="o">=</span> <span class="n">vLCC_to_ix</span><span class="p">(</span><span class="n">LCC_type</span><span class="o">-</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">LAI</span> <span class="o">=</span> <span class="n">f_LAI_cl</span><span class="p">[</span><span class="n">iLCC</span><span class="p">]</span> <span class="o">*</span> <span class="n">LAI_eff</span>
    <span class="n">LAI_uncertainty</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span> <span class="p">(</span> <span class="n">f_LAI_unc2_cl</span><span class="p">[</span><span class="n">iLCC</span><span class="p">]</span> <span class="o">*</span> <span class="n">LAI_eff</span><span class="o">**</span><span class="mi">2</span> <span class="p">)</span> <span class="o">+</span>
                               <span class="p">(</span> <span class="n">f_LAI_cl</span><span class="p">[</span><span class="n">iLCC</span><span class="p">]</span> <span class="o">*</span> <span class="n">LAI_eff_uncertainty</span> <span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="p">)</span>
    <span class="n">LAI_uncertainty</span> <span class="o">=</span> <span class="n">LAI_uncertainty</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">LAI_eff_uncertainty</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
    <span class="n">LAI_uncertainty</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;units&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">LAI_eff_uncertainty</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;units&#39;</span><span class="p">]</span> <span class="c1"># forward unit</span>
    <span class="k">return</span> <span class="n">LAI</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isfinite</span><span class="p">(</span><span class="n">LAI_eff</span><span class="p">)),</span><span class="n">LAI_uncertainty</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isfinite</span><span class="p">(</span><span class="n">LAI_eff</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="setting-things-up">
<h2>Setting things up<a class="headerlink" href="#setting-things-up" title="Link to this heading">#</a></h2>
<p>To actually run the conversion, data needs to be read, the pre-computation steps need to be called, and the output needs to be prepared. Here, we start with the set-up by providing the confusion matrices for all years. They are quite similar, and because there is only a limited number of cases, the sum of them all is thought to give a more robust statistics for the estimation of the confusion probabilites.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># set-up</span>
<span class="n">confusion_matrix_prob_LCC</span> <span class="o">=</span> <span class="n">abs_to_prob</span><span class="p">(</span><span class="n">cm_2016</span><span class="o">+</span><span class="n">cm_2017</span><span class="o">+</span><span class="n">cm_2018</span><span class="o">+</span><span class="n">cm_2019</span><span class="o">+</span><span class="n">cm_2020</span><span class="p">)</span>
<span class="n">f_LAI_cl</span><span class="p">,</span><span class="n">f_LAI_unc2_cl</span> <span class="o">=</span> <span class="n">pre_compute_factors</span><span class="p">(</span><span class="n">confusion_matrix_prob_LCC</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LCC 10 could be LCC 10 with propability 0.681 which maps to Chen et al. class(es) [16] ( 1 )
LCC 10 could be LCC 20 with propability 0.17 which maps to Chen et al. class(es) [15, 16] ( 2 )
LCC 10 could be LCC 50 with propability 0.011 which maps to Chen et al. class(es) [1] ( 1 )
LCC 10 could be LCC 60 with propability 0.005 which maps to Chen et al. class(es) [2, 3] ( 2 )
LCC 10 could be LCC 120 with propability 0.028 which maps to Chen et al. class(es) [1, 11, 12] ( 3 )
LCC 10 could be LCC 130 with propability 0.079 which maps to Chen et al. class(es) [1] ( 1 )
LCC 10 could be LCC 150 with propability 0.011 which maps to Chen et al. class(es) [14] ( 1 )
LCC 10 could be LCC 180 with propability 0.005 which maps to Chen et al. class(es) [15] ( 1 )
LCC 10 could be LCC 200 with propability 0.005 which maps to Chen et al. class(es) [19] ( 1 )
LCC 20 could be LCC 10 with propability 0.257 which maps to Chen et al. class(es) [16] ( 1 )
LCC 20 could be LCC 20 with propability 0.685 which maps to Chen et al. class(es) [15, 16] ( 2 )
LCC 20 could be LCC 60 with propability 0.057 which maps to Chen et al. class(es) [2, 3] ( 2 )
LCC 30 could be LCC 10 with propability 0.462 which maps to Chen et al. class(es) [16] ( 1 )
LCC 30 could be LCC 50 with propability 0.215 which maps to Chen et al. class(es) [1] ( 1 )
LCC 30 could be LCC 60 with propability 0.053 which maps to Chen et al. class(es) [2, 3] ( 2 )
LCC 30 could be LCC 120 with propability 0.107 which maps to Chen et al. class(es) [1, 11, 12] ( 3 )
LCC 30 could be LCC 130 with propability 0.161 which maps to Chen et al. class(es) [1] ( 1 )
LCC 40 could be LCC 10 with propability 0.307 which maps to Chen et al. class(es) [16] ( 1 )
LCC 40 could be LCC 20 with propability 0.038 which maps to Chen et al. class(es) [15, 16] ( 2 )
LCC 40 could be LCC 60 with propability 0.269 which maps to Chen et al. class(es) [2, 3] ( 2 )
LCC 40 could be LCC 120 with propability 0.1 which maps to Chen et al. class(es) [1, 11, 12] ( 3 )
LCC 40 could be LCC 130 with propability 0.269 which maps to Chen et al. class(es) [1] ( 1 )
LCC 40 could be LCC 150 with propability 0.015 which maps to Chen et al. class(es) [14] ( 1 )
LCC 50 could be LCC 10 with propability 0.013 which maps to Chen et al. class(es) [16] ( 1 )
LCC 50 could be LCC 50 with propability 0.882 which maps to Chen et al. class(es) [1] ( 1 )
LCC 50 could be LCC 60 with propability 0.064 which maps to Chen et al. class(es) [2, 3] ( 2 )
LCC 50 could be LCC 70 with propability 0.013 which maps to Chen et al. class(es) [4] ( 1 )
LCC 50 could be LCC 90 with propability 0.011 which maps to Chen et al. class(es) [6] ( 1 )
LCC 50 could be LCC 120 with propability 0.01 which maps to Chen et al. class(es) [1, 11, 12] ( 3 )
LCC 50 could be LCC 130 with propability 0.004 which maps to Chen et al. class(es) [1] ( 1 )
LCC 60 could be LCC 10 with propability 0.008 which maps to Chen et al. class(es) [16] ( 1 )
LCC 60 could be LCC 50 with propability 0.051 which maps to Chen et al. class(es) [1] ( 1 )
LCC 60 could be LCC 60 with propability 0.615 which maps to Chen et al. class(es) [2, 3] ( 2 )
LCC 60 could be LCC 70 with propability 0.008 which maps to Chen et al. class(es) [4] ( 1 )
LCC 60 could be LCC 80 with propability 0.068 which maps to Chen et al. class(es) [5] ( 1 )
LCC 60 could be LCC 90 with propability 0.137 which maps to Chen et al. class(es) [6] ( 1 )
LCC 60 could be LCC 120 with propability 0.108 which maps to Chen et al. class(es) [1, 11, 12] ( 3 )
LCC 70 could be LCC 50 with propability 0.11 which maps to Chen et al. class(es) [1] ( 1 )
LCC 70 could be LCC 60 with propability 0.033 which maps to Chen et al. class(es) [2, 3] ( 2 )
LCC 70 could be LCC 70 with propability 0.589 which maps to Chen et al. class(es) [4] ( 1 )
LCC 70 could be LCC 80 with propability 0.022 which maps to Chen et al. class(es) [5] ( 1 )
LCC 70 could be LCC 90 with propability 0.177 which maps to Chen et al. class(es) [6] ( 1 )
LCC 70 could be LCC 120 with propability 0.022 which maps to Chen et al. class(es) [1, 11, 12] ( 3 )
LCC 70 could be LCC 150 with propability 0.044 which maps to Chen et al. class(es) [14] ( 1 )
LCC 80 could be LCC 70 with propability 0.068 which maps to Chen et al. class(es) [4] ( 1 )
LCC 80 could be LCC 80 with propability 0.608 which maps to Chen et al. class(es) [5] ( 1 )
LCC 80 could be LCC 90 with propability 0.079 which maps to Chen et al. class(es) [6] ( 1 )
LCC 80 could be LCC 120 with propability 0.063 which maps to Chen et al. class(es) [1, 11, 12] ( 3 )
LCC 80 could be LCC 130 with propability 0.074 which maps to Chen et al. class(es) [1] ( 1 )
LCC 80 could be LCC 150 with propability 0.105 which maps to Chen et al. class(es) [14] ( 1 )
LCC 90 could be LCC 60 with propability 0.111 which maps to Chen et al. class(es) [2, 3] ( 2 )
LCC 90 could be LCC 70 with propability 0.055 which maps to Chen et al. class(es) [4] ( 1 )
LCC 90 could be LCC 80 with propability 0.055 which maps to Chen et al. class(es) [5] ( 1 )
LCC 90 could be LCC 90 with propability 0.777 which maps to Chen et al. class(es) [6] ( 1 )
LCC 100 could be LCC 10 with propability 0.063 which maps to Chen et al. class(es) [16] ( 1 )
LCC 100 could be LCC 50 with propability 0.212 which maps to Chen et al. class(es) [1] ( 1 )
LCC 100 could be LCC 60 with propability 0.265 which maps to Chen et al. class(es) [2, 3] ( 2 )
LCC 100 could be LCC 70 with propability 0.069 which maps to Chen et al. class(es) [4] ( 1 )
LCC 100 could be LCC 80 with propability 0.026 which maps to Chen et al. class(es) [5] ( 1 )
LCC 100 could be LCC 120 with propability 0.148 which maps to Chen et al. class(es) [1, 11, 12] ( 3 )
LCC 100 could be LCC 130 with propability 0.132 which maps to Chen et al. class(es) [1] ( 1 )
LCC 100 could be LCC 150 with propability 0.053 which maps to Chen et al. class(es) [14] ( 1 )
LCC 100 could be LCC 180 with propability 0.026 which maps to Chen et al. class(es) [15] ( 1 )
LCC 110 could be LCC 70 with propability 0.096 which maps to Chen et al. class(es) [4] ( 1 )
LCC 110 could be LCC 120 with propability 0.258 which maps to Chen et al. class(es) [1, 11, 12] ( 3 )
LCC 110 could be LCC 130 with propability 0.483 which maps to Chen et al. class(es) [1] ( 1 )
LCC 110 could be LCC 180 with propability 0.161 which maps to Chen et al. class(es) [15] ( 1 )
LCC 120 could be LCC 10 with propability 0.044 which maps to Chen et al. class(es) [16] ( 1 )
LCC 120 could be LCC 50 with propability 0.041 which maps to Chen et al. class(es) [1] ( 1 )
LCC 120 could be LCC 60 with propability 0.111 which maps to Chen et al. class(es) [2, 3] ( 2 )
LCC 120 could be LCC 70 with propability 0.004 which maps to Chen et al. class(es) [4] ( 1 )
LCC 120 could be LCC 80 with propability 0.005 which maps to Chen et al. class(es) [5] ( 1 )
LCC 120 could be LCC 120 with propability 0.615 which maps to Chen et al. class(es) [1, 11, 12] ( 3 )
LCC 120 could be LCC 130 with propability 0.124 which maps to Chen et al. class(es) [1] ( 1 )
LCC 120 could be LCC 150 with propability 0.046 which maps to Chen et al. class(es) [14] ( 1 )
LCC 120 could be LCC 200 with propability 0.005 which maps to Chen et al. class(es) [19] ( 1 )
LCC 130 could be LCC 10 with propability 0.06 which maps to Chen et al. class(es) [16] ( 1 )
LCC 130 could be LCC 20 with propability 0.021 which maps to Chen et al. class(es) [15, 16] ( 2 )
LCC 130 could be LCC 90 with propability 0.007 which maps to Chen et al. class(es) [6] ( 1 )
LCC 130 could be LCC 120 with propability 0.136 which maps to Chen et al. class(es) [1, 11, 12] ( 3 )
LCC 130 could be LCC 130 with propability 0.461 which maps to Chen et al. class(es) [1] ( 1 )
LCC 130 could be LCC 140 with propability 0.007 which maps to Chen et al. class(es) [19] ( 1 )
LCC 130 could be LCC 150 with propability 0.095 which maps to Chen et al. class(es) [14] ( 1 )
LCC 130 could be LCC 180 with propability 0.007 which maps to Chen et al. class(es) [15] ( 1 )
LCC 130 could be LCC 190 with propability 0.007 which maps to Chen et al. class(es) [19] ( 1 )
LCC 130 could be LCC 200 with propability 0.181 which maps to Chen et al. class(es) [19] ( 1 )
LCC 130 could be LCC 210 with propability 0.007 which maps to Chen et al. class(es) [19] ( 1 )
LCC 130 could be LCC 220 with propability 0.007 which maps to Chen et al. class(es) [19] ( 1 )
LCC 140 could be LCC 140 with propability 0.666 which maps to Chen et al. class(es) [19] ( 1 )
LCC 140 could be LCC 150 with propability 0.333 which maps to Chen et al. class(es) [14] ( 1 )
LCC 150 could be LCC 10 with propability 0.056 which maps to Chen et al. class(es) [16] ( 1 )
LCC 150 could be LCC 120 with propability 0.259 which maps to Chen et al. class(es) [1, 11, 12] ( 3 )
LCC 150 could be LCC 130 with propability 0.248 which maps to Chen et al. class(es) [1] ( 1 )
LCC 150 could be LCC 140 with propability 0.033 which maps to Chen et al. class(es) [19] ( 1 )
LCC 150 could be LCC 150 with propability 0.27 which maps to Chen et al. class(es) [14] ( 1 )
LCC 150 could be LCC 200 with propability 0.13 which maps to Chen et al. class(es) [19] ( 1 )
LCC 160 could be LCC 50 with propability 1.0 which maps to Chen et al. class(es) [1] ( 1 )
LCC 170 could be LCC 180 with propability 1.0 which maps to Chen et al. class(es) [15] ( 1 )
LCC 180 could be LCC 130 with propability 0.5 which maps to Chen et al. class(es) [1] ( 1 )
LCC 180 could be LCC 150 with propability 0.083 which maps to Chen et al. class(es) [14] ( 1 )
LCC 180 could be LCC 160 with propability 0.083 which maps to Chen et al. class(es) [7] ( 1 )
LCC 180 could be LCC 180 with propability 0.333 which maps to Chen et al. class(es) [15] ( 1 )
LCC 190 could be LCC 60 with propability 0.25 which maps to Chen et al. class(es) [2, 3] ( 2 )
LCC 190 could be LCC 190 with propability 0.75 which maps to Chen et al. class(es) [19] ( 1 )
LCC 200 could be LCC 10 with propability 0.025 which maps to Chen et al. class(es) [16] ( 1 )
LCC 200 could be LCC 120 with propability 0.012 which maps to Chen et al. class(es) [1, 11, 12] ( 3 )
LCC 200 could be LCC 130 with propability 0.037 which maps to Chen et al. class(es) [1] ( 1 )
LCC 200 could be LCC 150 with propability 0.156 which maps to Chen et al. class(es) [14] ( 1 )
LCC 200 could be LCC 180 with propability 0.01 which maps to Chen et al. class(es) [15] ( 1 )
LCC 200 could be LCC 200 with propability 0.758 which maps to Chen et al. class(es) [19] ( 1 )
LCC 210 could be LCC 20 with propability 0.016 which maps to Chen et al. class(es) [15, 16] ( 2 )
LCC 210 could be LCC 90 with propability 0.016 which maps to Chen et al. class(es) [6] ( 1 )
LCC 210 could be LCC 180 with propability 0.003 which maps to Chen et al. class(es) [15] ( 1 )
LCC 210 could be LCC 210 with propability 0.962 which maps to Chen et al. class(es) [19] ( 1 )
</pre></div>
</div>
</div>
</div>
</section>
<section id="something-to-play-around-with">
<h2>Something to play around with<a class="headerlink" href="#something-to-play-around-with" title="Link to this heading">#</a></h2>
<p>Feel free to vary the inputs in the following cell, as long as all arrays have the same length. This should give you an idea of the magnitude of change of LAI and its uncertainties caused by the conversion for different LCCs.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># output</span>
<span class="n">LAI</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">([</span><span class="mi">6</span><span class="p">])</span>
<span class="n">LAI_uncertainty</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">([</span><span class="mi">6</span><span class="p">])</span>
<span class="c1"># input</span>
<span class="n">LAI_eff</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">([</span><span class="mf">1.</span><span class="p">,</span><span class="mf">2.</span><span class="p">,</span><span class="mf">3.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">2.</span><span class="p">,</span><span class="mf">3.</span><span class="p">],</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;LAI&#39;</span><span class="p">,</span><span class="n">attrs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;units&#39;</span><span class="p">:</span><span class="s1">&#39;m2.m-2&#39;</span><span class="p">})</span>
<span class="n">LAI_eff_uncertainty</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">([</span><span class="mf">0.2</span><span class="p">,</span><span class="mf">0.2</span><span class="p">,</span><span class="mf">0.2</span><span class="p">,</span><span class="mf">0.2</span><span class="p">,</span><span class="mf">0.2</span><span class="p">,</span><span class="mf">0.2</span><span class="p">],</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;LAI_ERR&#39;</span><span class="p">,</span><span class="n">attrs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;units&#39;</span><span class="p">:</span><span class="s1">&#39;m2.m-2&#39;</span><span class="p">})</span>
<span class="n">LCC_type</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">([</span><span class="mi">160</span><span class="p">,</span><span class="mi">160</span><span class="p">,</span><span class="mi">160</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">120</span><span class="p">],</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;LCCS_type&#39;</span><span class="p">)</span>
<span class="c1"># actual conversion:</span>
<span class="n">LAI</span><span class="p">,</span> <span class="n">LAI_uncertainty</span> <span class="o">=</span> <span class="n">convert_LAI</span><span class="p">(</span><span class="n">LAI_eff</span><span class="p">,</span> <span class="n">LAI_eff_uncertainty</span><span class="p">,</span> <span class="n">LCC_type</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;LCC type&quot;</span><span class="p">,</span><span class="n">LCC_type</span><span class="p">)</span>
<span class="k">for</span> <span class="n">cLCC</span> <span class="ow">in</span> <span class="n">LCC_type</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">cLCC</span><span class="p">,</span><span class="s2">&quot; : &quot;</span><span class="p">,</span><span class="n">LCCS_legend</span><span class="p">[(</span><span class="nb">int</span><span class="p">)(</span><span class="n">cLCC</span><span class="o">.</span><span class="n">compute</span><span class="p">())])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;LAI_eff :&quot;</span><span class="p">,</span><span class="n">LAI_eff</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">LAI_eff_unc : &quot;</span><span class="p">,</span><span class="n">LAI_eff_uncertainty</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;LAI     :&quot;</span><span class="p">,</span><span class="n">LAI</span>    <span class="p">,</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">LAI_unc     : &quot;</span><span class="p">,</span><span class="n">LAI_uncertainty</span>    <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LCC type &lt;xarray.DataArray &#39;LCCS_type&#39; (dim_0: 6)&gt;
array([160, 160, 160, 120, 120, 120])
Dimensions without coordinates: dim_0
&lt;xarray.DataArray &#39;LCCS_type&#39; ()&gt;
array(160)  :  Tree cover, flooded, fresh or brackish water
&lt;xarray.DataArray &#39;LCCS_type&#39; ()&gt;
array(160)  :  Tree cover, flooded, fresh or brackish water
&lt;xarray.DataArray &#39;LCCS_type&#39; ()&gt;
array(160)  :  Tree cover, flooded, fresh or brackish water
&lt;xarray.DataArray &#39;LCCS_type&#39; ()&gt;
array(120)  :  Shrubland
&lt;xarray.DataArray &#39;LCCS_type&#39; ()&gt;
array(120)  :  Shrubland
&lt;xarray.DataArray &#39;LCCS_type&#39; ()&gt;
array(120)  :  Shrubland
LAI_eff : &lt;xarray.DataArray &#39;LAI&#39; (dim_0: 6)&gt;
array([1., 2., 3., 1., 2., 3.])
Dimensions without coordinates: dim_0
Attributes:
    units:    m2.m-2 	LAI_eff_unc :  &lt;xarray.DataArray &#39;LAI_ERR&#39; (dim_0: 6)&gt;
array([0.2, 0.2, 0.2, 0.2, 0.2, 0.2])
Dimensions without coordinates: dim_0
Attributes:
    units:    m2.m-2
LAI     : &lt;xarray.DataArray &#39;LAI&#39; (dim_0: 6)&gt;
array([1.40312771, 2.80625543, 4.20938314, 1.51246069, 3.02492137,
       4.53738206])
Dimensions without coordinates: dim_0
Attributes:
    units:    m2.m-2 	LAI_unc     :  &lt;xarray.DataArray &#39;LAI_ERR&#39; (dim_0: 6)&gt;
array([0.28257368, 0.28833913, 0.29770019, 0.30473558, 0.31136893,
       0.3221211 ])
Dimensions without coordinates: dim_0
Attributes:
    units:    m2.m-2
</pre></div>
</div>
</div>
</div>
</section>
<section id="geting-the-data-the-climate-data-store-cds">
<h2>Geting the Data: The Climate Data Store (CDS)<a class="headerlink" href="#geting-the-data-the-climate-data-store-cds" title="Link to this heading">#</a></h2>
<p>We will be using the CDS API. Its usage is explained on the <a class="reference external" href="https://cds.climate.copernicus.eu/how-to-api">CDS API how-to pages</a>. Please consult the tutorial on how to set up a CDS API key, which will be prerequisite to the following code to work. Our code defines a python subroutine <code class="docutils literal notranslate"><span class="pre">get_data</span></code> which downloads LAI and fAPAR data as gzip’ped <code class="docutils literal notranslate"><span class="pre">tar</span></code> archive from the CDS and writes it to the file given by the <code class="docutils literal notranslate"><span class="pre">target</span></code> argument of <code class="docutils literal notranslate"><span class="pre">get_data</span></code>.
The data is retained in a file to avoid repeated downloading when the notebook is run repeatedly and to avoid holding the whole data in memory. This commes at the cost of dublicationg the data on disk in the subsequent extraction step. Currently, there seems to be no way to avoid this, because the CDS /always/ delivers compressed archives when the data is ordered as file.</p>
<p>For this tutorial, we are downloading global effective LAI V4 based on Sentinel-3 (OLCI and SLSTR) data with a resolution of 300 km for April 10, 2019.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_data</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">target</span><span class="p">):</span>
    <span class="kn">import</span> <span class="nn">cdsapi</span>
    <span class="kn">import</span> <span class="nn">os.path</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">target</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;target&quot;</span><span class="p">,</span><span class="n">target</span><span class="p">,</span><span class="s2">&quot;already exists.&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">client</span> <span class="o">=</span> <span class="n">cdsapi</span><span class="o">.</span><span class="n">Client</span><span class="p">()</span>
        <span class="n">client</span><span class="o">.</span><span class="n">retrieve</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span><span class="n">request</span><span class="p">,</span><span class="n">target</span><span class="p">)</span> <span class="c1">#.download()</span>
            
<span class="n">starttime</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="s1">&#39;satellite-lai-fapar&#39;</span>
<span class="n">request</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;tgz&#39;</span><span class="p">,</span>
    <span class="s1">&#39;variable&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;lai&#39;</span><span class="p">],</span>
    <span class="s1">&#39;satellite&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;sentinel_3&#39;</span><span class="p">],</span>
    <span class="s1">&#39;sensor&#39;</span><span class="p">:</span> <span class="s1">&#39;olci_and_slstr&#39;</span><span class="p">,</span>
    <span class="s1">&#39;horizontal_resolution&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;300m&#39;</span><span class="p">],</span>
    <span class="s1">&#39;product_version&#39;</span><span class="p">:</span> <span class="s1">&#39;v4&#39;</span><span class="p">,</span> <span class="c1"># the difference to the old CDS is here</span>
    <span class="s1">&#39;year&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;2019&#39;</span><span class="p">],</span>
    <span class="s1">&#39;month&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;04&#39;</span><span class="p">],</span>
    <span class="s1">&#39;nominal_day&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;10&#39;</span><span class="p">],</span>
    <span class="s1">&#39;area&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">60</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">20</span><span class="p">]</span>
<span class="p">}</span>

<span class="n">laifile</span> <span class="o">=</span> <span class="s1">&#39;laidata.tgz&#39;</span>
<span class="n">get_data</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span><span class="n">request</span><span class="p">,</span><span class="n">target</span><span class="o">=</span><span class="n">laifile</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;got LAI data,       elapsed:&#39;</span><span class="p">,</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">-</span><span class="n">starttime</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-05 11:30:51,593 INFO Request ID is 296a5374-5ac4-4c63-b5f2-3597e68d9636
2024-12-05 11:30:51,660 INFO status has been updated to accepted
2024-12-05 11:30:57,725 INFO status has been updated to running
2024-12-05 12:25:49,107 INFO status has been updated to successful
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "", "version_major": 2, "version_minor": 0}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>got LAI data,       elapsed: 0:55:17.027275
</pre></div>
</div>
</div>
</div>
<p>A similar step is required for the LCC data, to get the corresponding land cover classes for 2019. The resolution of this product is 300m.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">starttime</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="s2">&quot;satellite-land-cover&quot;</span>
<span class="n">request</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;tgz&#39;</span><span class="p">,</span>
    <span class="s1">&#39;variable&#39;</span><span class="p">:</span> <span class="s1">&#39;all&#39;</span><span class="p">,</span>
    <span class="s1">&#39;year&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;2019&#39;</span><span class="p">],</span>
    <span class="s1">&#39;version&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;v2_1_1&#39;</span><span class="p">],</span> <span class="c1"># the difference to the old CDS is here</span>
    <span class="s1">&#39;area&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">60</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">20</span><span class="p">]</span>
<span class="p">}</span>
<span class="n">lccfile</span> <span class="o">=</span> <span class="s1">&#39;lccdata.tgz&#39;</span>
<span class="n">get_data</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span><span class="n">request</span><span class="p">,</span><span class="n">target</span><span class="o">=</span><span class="n">lccfile</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;got LCC data,       elapsed:&#39;</span><span class="p">,</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">-</span><span class="n">starttime</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-05 12:25:59,962 INFO Request ID is 1e8083a2-611f-4551-9d24-62666cf0d8ce
2024-12-05 12:26:00,972 INFO status has been updated to accepted
2024-12-05 12:26:05,349 INFO status has been updated to running
2024-12-05 12:34:25,009 INFO status has been updated to successful
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "", "version_major": 2, "version_minor": 0}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>got LCC data,       elapsed: 0:08:31.194931
</pre></div>
</div>
</div>
</div>
</section>
<section id="unpacking">
<h2>Unpacking<a class="headerlink" href="#unpacking" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">unpack_data</span><span class="p">(</span><span class="n">file</span><span class="p">):</span>
    <span class="kn">import</span> <span class="nn">tarfile</span>
    <span class="kn">import</span> <span class="nn">os.path</span>
    <span class="n">tf</span> <span class="o">=</span> <span class="n">tarfile</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">file</span><span class="p">,</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;opened tar file,  elapsed:&#39;</span><span class="p">,</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">-</span><span class="n">starttime</span><span class="p">)</span>
    <span class="n">tf</span><span class="o">.</span><span class="n">list</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;listing,     elapsed:&#39;</span><span class="p">,</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">-</span><span class="n">starttime</span><span class="p">)</span>
    <span class="c1"># just extract what is not present:</span>
    <span class="k">for</span> <span class="n">xfile</span> <span class="ow">in</span> <span class="n">tf</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">xfile</span><span class="o">.</span><span class="n">name</span><span class="p">)</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;extracting &#39;</span><span class="p">,</span><span class="n">xfile</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="n">tf</span><span class="o">.</span><span class="n">extract</span><span class="p">(</span><span class="n">member</span><span class="o">=</span><span class="n">xfile</span><span class="o">.</span><span class="n">name</span><span class="p">,</span><span class="n">path</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">)</span> <span class="c1"># uses current working directory        </span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;present    &#39;</span><span class="p">,</span><span class="n">xfile</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">tf</span>

<span class="n">starttime</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
<span class="n">lai_tarfileinfo</span> <span class="o">=</span> <span class="n">unpack_data</span><span class="p">(</span><span class="n">laifile</span><span class="p">)</span>
<span class="n">lcc_tarfileinfo</span> <span class="o">=</span> <span class="n">unpack_data</span><span class="p">(</span><span class="n">lccfile</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;unpacked data,    elapsed:&#39;</span><span class="p">,</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">-</span><span class="n">starttime</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>opened tar file,  elapsed: 0:00:00.001765
?rw-r--r-- root/root  112364294 2024-12-05 12:25:36 c3s_LAI_20190410000000_GLOBE_SENTINEL3_V4.0.1.area-subset.60.0.40.20.nc 
listing,     elapsed: 0:00:00.236564
extracting  c3s_LAI_20190410000000_GLOBE_SENTINEL3_V4.0.1.area-subset.60.0.40.20.nc
opened tar file,  elapsed: 0:00:00.590531
?rw-r--r-- root/root   57447299 2024-12-05 12:33:35 C3S-LC-L4-LCCS-Map-300m-P1Y-2019-v2.1.1.area-subset.60.0.40.20.nc 
listing,     elapsed: 0:00:00.693927
extracting  C3S-LC-L4-LCCS-Map-300m-P1Y-2019-v2.1.1.area-subset.60.0.40.20.nc
unpacked data,    elapsed: 0:00:00.859791
</pre></div>
</div>
</div>
</div>
</section>
<section id="reading-the-data">
<h2>Reading the data<a class="headerlink" href="#reading-the-data" title="Link to this heading">#</a></h2>
<p>The data are prepared for reading by passing their names to an <code class="docutils literal notranslate"><span class="pre">xarray</span></code> multi-file object called <code class="docutils literal notranslate"><span class="pre">filedata</span></code> here. This will enable <code class="docutils literal notranslate"><span class="pre">dask</span></code> to work in parallel on multiple files and to hold only subsets in memory.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">starttime</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
<span class="n">varname</span> <span class="o">=</span> <span class="s1">&#39;LAI&#39;</span> 
<span class="n">uncname</span> <span class="o">=</span> <span class="n">varname</span> <span class="o">+</span> <span class="s1">&#39;_ERR&#39;</span> <span class="c1"># name of uncertainty layer</span>
<span class="c1"># extract the file names containting `varname` from `tarfileinfo`</span>
<span class="n">inputfiles</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># start with empty list</span>
<span class="k">for</span> <span class="n">xfile</span> <span class="ow">in</span> <span class="n">lai_tarfileinfo</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">varname</span><span class="o">.</span><span class="n">casefold</span><span class="p">()</span> <span class="ow">in</span> <span class="n">xfile</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">casefold</span><span class="p">():</span>
        <span class="n">inputfiles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">xfile</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
<span class="c1"># give the list to an `xarray` multi-file object</span>
<span class="c1">#dask.config.set({&quot;array.slicing.split_large_chunks&quot;: True})</span>
<span class="c1">#laifiledata = xr.open_mfdataset(inputfiles,chunks=&#39;auto&#39;,parallel=True)</span>
<span class="c1">#laifiledata = xr.open_dataset(inputfiles[0],chunks=&#39;auto&#39;)</span>
<span class="n">laifiledata</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">load_dataset</span><span class="p">(</span><span class="n">inputfiles</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">lccname</span> <span class="o">=</span> <span class="s1">&#39;lccs_class&#39;</span>
<span class="n">inputfiles</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># start with empty list</span>
<span class="k">for</span> <span class="n">xfile</span> <span class="ow">in</span> <span class="n">lcc_tarfileinfo</span><span class="p">:</span>
    <span class="k">if</span> <span class="s1">&#39;LCCS-Map&#39;</span><span class="o">.</span><span class="n">casefold</span><span class="p">()</span> <span class="ow">in</span> <span class="n">xfile</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">casefold</span><span class="p">():</span>
        <span class="n">inputfiles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">xfile</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
<span class="c1">#lccfiledata = xr.open_mfdataset(inputfiles,chunks=&#39;auto&#39;,parallel=True)</span>
<span class="c1">#lccfiledata = xr.open_dataset(inputfiles[0],chunks=&#39;auto&#39;)</span>
<span class="n">lccfiledata</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">load_dataset</span><span class="p">(</span><span class="n">inputfiles</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

<span class="c1">#</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;set up inout files:&#39;</span><span class="p">,</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">-</span><span class="n">starttime</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>set up inout files: 0:00:07.404059
</pre></div>
</div>
</div>
</div>
</section>
<section id="applying-quality-flags">
<h2>Applying quality flags<a class="headerlink" href="#applying-quality-flags" title="Link to this heading">#</a></h2>
<p>TIP LAI and fAPAR come with a set of infomrational and quality flag, stored in the layer <code class="docutils literal notranslate"><span class="pre">retrival_flag</span></code>. We are using the hexadecimal representation <code class="docutils literal notranslate"><span class="pre">0x1C1</span></code> of the bit array <code class="docutils literal notranslate"><span class="pre">111000001</span></code>, here, to avoid cells with the conditions <code class="docutils literal notranslate"><span class="pre">obs_is_fillvalue</span></code>, <code class="docutils literal notranslate"><span class="pre">tip_untrusted</span></code>,<code class="docutils literal notranslate"><span class="pre">obs_unusable</span></code>, and <code class="docutils literal notranslate"><span class="pre">obs_inconsistent</span></code> (see <a class="reference external" href="https://datastore.copernicus-climate.eu/documents/satellite-lai-fapar/D3.3.10-v4.1_PUGS_CDR-ICDR_LAI_FAPAR_SENTINEL3_v4.0_PRODUCTS_v1.1.pdf">PUG</a> for reference). In the end, we must not forget to define the units of the result:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">apply_flags</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">fielddict</span><span class="p">):</span>
    <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
    <span class="n">func</span>     <span class="o">=</span> <span class="k">lambda</span> <span class="n">val</span><span class="p">,</span> <span class="n">flags</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">bitwise_and</span><span class="p">(</span><span class="n">flags</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;uint32&#39;</span><span class="p">),</span><span class="mh">0x1C1</span><span class="p">)</span> <span class="o">==</span> <span class="mh">0x0</span> <span class="p">),</span> <span class="n">val</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span> <span class="p">)</span>
    <span class="n">units</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">fielddict</span><span class="p">[</span><span class="s1">&#39;variable&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;units&#39;</span><span class="p">]</span>
    <span class="n">clean_data</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">apply_ufunc</span><span class="p">(</span><span class="n">func</span><span class="p">,</span>\
                                <span class="n">data</span><span class="p">[</span><span class="n">fielddict</span><span class="p">[</span><span class="s1">&#39;variable&#39;</span><span class="p">]],</span>\
                                <span class="n">data</span><span class="p">[</span><span class="n">fielddict</span><span class="p">[</span><span class="s1">&#39;flags&#39;</span><span class="p">]],</span>\
                                <span class="n">dask</span><span class="o">=</span><span class="s2">&quot;allowed&quot;</span><span class="p">,</span><span class="n">dask_gufunc_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;allow_rechunk&#39;</span><span class="p">:</span><span class="kc">True</span><span class="p">})</span>
    <span class="c1"># set units of result:</span>
    <span class="n">clean_data</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;units&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">units</span>
    <span class="k">return</span> <span class="n">clean_data</span>

<span class="n">starttime</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
<span class="n">laifiledata</span><span class="p">[</span><span class="n">varname</span><span class="p">]</span> <span class="o">=</span> <span class="n">apply_flags</span><span class="p">(</span><span class="n">laifiledata</span><span class="p">,{</span><span class="s1">&#39;variable&#39;</span><span class="p">:</span><span class="n">varname</span><span class="p">,</span><span class="s1">&#39;flags&#39;</span><span class="p">:</span><span class="s1">&#39;retrieval_flag&#39;</span><span class="p">})</span>
<span class="n">laifiledata</span><span class="p">[</span><span class="n">uncname</span><span class="p">]</span> <span class="o">=</span> <span class="n">apply_flags</span><span class="p">(</span><span class="n">laifiledata</span><span class="p">,{</span><span class="s1">&#39;variable&#39;</span><span class="p">:</span><span class="n">uncname</span><span class="p">,</span><span class="s1">&#39;flags&#39;</span><span class="p">:</span><span class="s1">&#39;retrieval_flag&#39;</span><span class="p">})</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;applied flags,  elapsed:&#39;</span><span class="p">,</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">-</span><span class="n">starttime</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>applied flags,  elapsed: 0:00:00.619215
</pre></div>
</div>
</div>
</div>
</section>
<section id="run-the-conversion">
<h2>Run the conversion<a class="headerlink" href="#run-the-conversion" title="Link to this heading">#</a></h2>
<p>It turns out that the datasets to be combined are not defined on the same grid, even if both use a global regular grid with approx. 300m resolution at the equator. Therefore, a nearest neighbour interpolation is nested into the call of the <code class="docutils literal notranslate"><span class="pre">conversion_func</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">starttime</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
<span class="c1"># Test output to check objects</span>
<span class="nb">print</span> <span class="p">(</span><span class="n">laifiledata</span><span class="p">[</span><span class="n">varname</span><span class="p">])</span>
<span class="nb">print</span> <span class="p">(</span><span class="n">laifiledata</span><span class="p">[</span><span class="n">uncname</span><span class="p">])</span>
<span class="n">lccfiledata</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">laifiledata</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span> <span class="c1"># to align time dimension</span>
<span class="nb">print</span><span class="p">(</span><span class="n">lccfiledata</span><span class="p">[</span><span class="n">lccname</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">lccfiledata</span><span class="p">[</span><span class="n">lccname</span><span class="p">]</span><span class="o">.</span>\
                         <span class="n">sel</span><span class="p">(</span><span class="n">lat</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">laifiledata</span><span class="o">.</span><span class="n">lat</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span><span class="n">laifiledata</span><span class="o">.</span><span class="n">lat</span><span class="o">.</span><span class="n">min</span><span class="p">()))</span><span class="o">.</span>\
                         <span class="n">interp</span><span class="p">(</span><span class="n">coords</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;lon&#39;</span><span class="p">:</span><span class="n">laifiledata</span><span class="o">.</span><span class="n">lon</span><span class="p">,</span><span class="s1">&#39;lat&#39;</span><span class="p">:</span><span class="n">laifiledata</span><span class="o">.</span><span class="n">lat</span><span class="p">},</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">,</span><span class="n">assume_sorted</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
<span class="c1"># define conversion as lambda function to apply in dask delayed computation</span>
<span class="n">conversion_func</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">var</span><span class="p">,</span> <span class="n">unc</span><span class="p">,</span> <span class="n">lcc</span> <span class="p">:</span> <span class="n">convert_LAI</span><span class="p">(</span><span class="n">LAI_eff</span><span class="o">=</span><span class="n">var</span><span class="p">,</span> <span class="n">LAI_eff_uncertainty</span><span class="o">=</span><span class="n">unc</span><span class="p">,</span> <span class="n">LCC_type</span><span class="o">=</span><span class="n">lcc</span><span class="p">)</span>
<span class="c1"># set up the conversion</span>
<span class="c1">#LAI  = dask.array.apply_gufunc(conversion_func,</span>
<span class="c1">#                      &#39;(i,j),(i,j),(i,j)-&gt;(i,j)&#39;,</span>
<span class="c1">#                      laifiledata[varname],</span>
<span class="c1">#                      laifiledata[uncname],</span>
<span class="c1">#                      lccfiledata[lccname].\</span>
<span class="c1">#                         sel(lat=slice(laifiledata.lat.min(),laifiledata.lat.max())).\</span>
<span class="c1">#                         interp(coords={&#39;lon&#39;:laifiledata.lon,&#39;lat&#39;:laifiledata.lat},method=&#39;nearest&#39;,assume_sorted=True)</span>
<span class="c1">#                      )</span>
<span class="c1">#LAI, LAIu  = xr.apply_ufunc(conversion_func,</span>
<span class="c1">#                      laifiledata[varname],</span>
<span class="c1">#                      laifiledata[uncname],</span>
<span class="c1">#                      lccfiledata[lccname].\</span>
<span class="c1">#                         sel(lat=slice(laifiledata.lat.max(),laifiledata.lat.min())).\</span>
<span class="c1">#                         interp(coords={&#39;lon&#39;:laifiledata.lon,&#39;lat&#39;:laifiledata.lat},method=&#39;nearest&#39;,assume_sorted=False),</span>
<span class="c1">#                      dask=&quot;allowed&quot;)</span>
<span class="n">LAI</span> <span class="o">=</span> <span class="n">convert_LAI</span><span class="p">(</span><span class="n">LAI_eff</span> <span class="o">=</span> <span class="n">laifiledata</span><span class="p">[</span><span class="n">varname</span><span class="p">],</span>
                   <span class="n">LAI_eff_uncertainty</span> <span class="o">=</span> <span class="n">laifiledata</span><span class="p">[</span><span class="n">uncname</span><span class="p">],</span>
                   <span class="n">LCC_type</span> <span class="o">=</span> <span class="n">lccfiledata</span><span class="p">[</span><span class="n">lccname</span><span class="p">]</span><span class="o">.</span>\
                         <span class="n">sel</span><span class="p">(</span><span class="n">lat</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">laifiledata</span><span class="o">.</span><span class="n">lat</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span><span class="n">laifiledata</span><span class="o">.</span><span class="n">lat</span><span class="o">.</span><span class="n">min</span><span class="p">()))</span><span class="o">.</span>\
                         <span class="n">interp</span><span class="p">(</span><span class="n">coords</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;lon&#39;</span><span class="p">:</span><span class="n">laifiledata</span><span class="o">.</span><span class="n">lon</span><span class="p">,</span><span class="s1">&#39;lat&#39;</span><span class="p">:</span><span class="n">laifiledata</span><span class="o">.</span><span class="n">lat</span><span class="p">},</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">,</span><span class="n">assume_sorted</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;set up computation,  elapsed:&#39;</span><span class="p">,</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">-</span><span class="n">starttime</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;xarray.DataArray &#39;LAI&#39; (time: 1, lat: 6720, lon: 6720)&gt;
array([[[       nan,        nan,        nan, ...,        nan,
                nan,        nan],
        [       nan,        nan,        nan, ...,        nan,
                nan,        nan],
        [       nan,        nan,        nan, ...,        nan,
                nan,        nan],
        ...,
        [0.75202197, 0.64169085, 0.6520677 , ..., 0.8435831 ,
         0.9189684 , 0.55409735],
        [0.6748054 , 0.61712193,        nan, ..., 0.8974515 ,
         0.8507554 , 0.916069  ],
        [0.6218526 , 0.58675414, 0.6010987 , ..., 0.8415993 ,
         0.55287653, 0.61162823]]], dtype=float32)
Coordinates:
  * time     (time) datetime64[ns] 2019-04-10
  * lon      (lon) float64 8.185e-10 0.002976 0.005952 ... 19.99 19.99 20.0
  * lat      (lat) float64 60.0 59.99 59.99 59.99 ... 40.01 40.01 40.0 40.0
Attributes:
    units:    m2.m-2
&lt;xarray.DataArray &#39;LAI_ERR&#39; (time: 1, lat: 6720, lon: 6720)&gt;
array([[[       nan,        nan,        nan, ...,        nan,
                nan,        nan],
        [       nan,        nan,        nan, ...,        nan,
                nan,        nan],
        [       nan,        nan,        nan, ...,        nan,
                nan,        nan],
        ...,
        [0.61208606, 0.5263238 , 0.5374637 , ..., 0.84816116,
         0.9334656 , 0.5267816 ],
        [0.5716466 , 0.528155  ,        nan, ..., 0.9446055 ,
         0.7863574 , 0.8448039 ],
        [0.55272394, 0.51960933, 0.5835495 , ..., 0.7639249 ,
         0.49641386, 0.441935  ]]], dtype=float32)
Coordinates:
  * time     (time) datetime64[ns] 2019-04-10
  * lon      (lon) float64 8.185e-10 0.002976 0.005952 ... 19.99 19.99 20.0
  * lat      (lat) float64 60.0 59.99 59.99 59.99 ... 40.01 40.01 40.0 40.0
Attributes:
    units:    m2.m-2
&lt;xarray.DataArray &#39;lccs_class&#39; (time: 1, lat: 7200, lon: 7200)&gt;
array([[[210, 210, 210, ..., 210, 210, 210],
        [210, 210, 210, ..., 210, 210, 210],
        [210, 210, 210, ..., 210, 210, 210],
        ...,
        [ 12,  12,  12, ...,  12,  40,  40],
        [ 12,  12,  12, ...,  12,  12,  30],
        [ 12,  12,  12, ...,  12,  12,  12]]], dtype=uint8)
Coordinates:
  * lat      (lat) float64 60.0 60.0 59.99 59.99 59.99 ... 40.01 40.01 40.0 40.0
  * lon      (lon) float64 0.001389 0.004167 0.006944 ... 19.99 20.0 20.0
  * time     (time) datetime64[ns] 2019-04-10
Attributes:
    standard_name:        land_cover_lccs
    flag_colors:          #ffff64 #ffff64 #ffff00 #aaf0f0 #dcf064 #c8c864 #00...
    long_name:            Land cover class defined in LCCS
    valid_min:            1
    valid_max:            220
    ancillary_variables:  processed_flag current_pixel_state observation_coun...
    flag_meanings:        no_data cropland_rainfed cropland_rainfed_herbaceou...
    flag_values:          [  0  10  11  12  20  30  40  50  60  61  62  70  7...
&lt;xarray.DataArray &#39;lccs_class&#39; (time: 1, lat: 6720, lon: 6720)&gt;
array([[[ nan,  nan,  nan, ...,  nan,  nan,  nan],
        [ nan, 210., 210., ..., 210., 210., 210.],
        [ nan, 210., 210., ..., 210., 210.,  70.],
        ...,
        [ nan,  12.,  12., ...,  11.,  12.,  40.],
        [ nan,  12.,  12., ...,  10.,  12.,  12.],
        [ nan,  nan,  nan, ...,  nan,  nan,  nan]]])
Coordinates:
  * time     (time) datetime64[ns] 2019-04-10
  * lon      (lon) float64 8.185e-10 0.002976 0.005952 ... 19.99 19.99 20.0
  * lat      (lat) float64 60.0 59.99 59.99 59.99 ... 40.01 40.01 40.0 40.0
Attributes:
    standard_name:        land_cover_lccs
    flag_colors:          #ffff64 #ffff64 #ffff00 #aaf0f0 #dcf064 #c8c864 #00...
    long_name:            Land cover class defined in LCCS
    valid_min:            1
    valid_max:            220
    ancillary_variables:  processed_flag current_pixel_state observation_coun...
    flag_meanings:        no_data cropland_rainfed cropland_rainfed_herbaceou...
    flag_values:          [  0  10  11  12  20  30  40  50  60  61  62  70  7...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/simon/.pyenv/versions/3.8.14/lib/python3.8/site-packages/xarray/core/duck_array_ops.py:187: RuntimeWarning: invalid value encountered in cast
  return data.astype(dtype, **kwargs)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>set up computation,  elapsed: 0:00:08.189314
</pre></div>
</div>
</div>
</div>
<p>There may be an “<em>RuntimeWarning: invalid value encountered in cast</em>” caused by the missing values in the input data, which seems safe to be ignored.</p>
<p>With dask, the computation could actually be delayed until the data values are used, and large datasets could be process in parallel. Here, we run an output method, which would start the sliced computations:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">LAI</span><span class="p">)</span>
<span class="c1">#</span>
<span class="c1"># output to file triggers the delayed computation:</span>
<span class="c1">#</span>
<span class="k">def</span> <span class="nf">write_result</span><span class="p">(</span><span class="n">output</span><span class="p">,</span><span class="n">outfile</span><span class="p">):</span>
    <span class="kn">import</span> <span class="nn">os.path</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">outfile</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;file&quot;</span><span class="p">,</span><span class="n">outfile</span><span class="p">,</span><span class="s2">&quot;already exists. Writing skipped.&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Writing to &quot;</span><span class="p">,</span><span class="n">outfile</span><span class="p">)</span>
        <span class="n">output</span><span class="o">.</span><span class="n">to_netcdf</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span><span class="n">encoding</span><span class="o">=</span><span class="p">{</span><span class="n">varname</span><span class="p">:{</span><span class="s2">&quot;zlib&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s2">&quot;complevel&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,},</span><span class="n">uncname</span><span class="p">:{</span><span class="s2">&quot;zlib&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s2">&quot;complevel&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">}})</span>
    <span class="k">return</span>

<span class="n">starttime</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
<span class="n">output</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">LAI</span><span class="p">)</span>
<span class="n">outfile</span> <span class="o">=</span> <span class="n">varname</span> <span class="o">+</span> <span class="s1">&#39;-clumped.nc&#39;</span>
<span class="n">write_result</span><span class="p">(</span><span class="n">output</span><span class="p">,</span><span class="n">outfile</span><span class="p">)</span>
<span class="n">output</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;After writing output :&#39;</span><span class="p">,</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">-</span><span class="n">starttime</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(&lt;xarray.DataArray &#39;LAI&#39; (time: 1, lat: 6720, lon: 6720)&gt;
array([[[       nan,        nan,        nan, ...,        nan,
                nan,        nan],
        [       nan,        nan,        nan, ...,        nan,
                nan,        nan],
        [       nan,        nan,        nan, ...,        nan,
                nan,        nan],
        ...,
        [1.04131915, 0.        , 0.        , ..., 0.        ,
         0.        , 0.8122886 ],
        [0.93439795, 0.        ,        nan, ..., 0.        ,
         0.        , 0.        ],
        [0.86107457, 0.81247404, 0.83233686, ..., 1.16535618,
         0.76556396, 0.846917  ]]])
Coordinates:
  * time     (time) datetime64[ns] 2019-04-10
  * lon      (lon) float64 8.185e-10 0.002976 0.005952 ... 19.99 19.99 20.0
  * lat      (lat) float64 60.0 59.99 59.99 59.99 ... 40.01 40.01 40.0 40.0
Attributes:
    units:    m2.m-2, &lt;xarray.DataArray &#39;LAI_ERR&#39; (time: 1, lat: 6720, lon: 6720)&gt;
array([[[       nan,        nan,        nan, ...,        nan,
                nan,        nan],
        [       nan,        nan,        nan, ...,        nan,
                nan,        nan],
        [       nan,        nan,        nan, ...,        nan,
                nan,        nan],
        ...,
        [0.84930186, 0.        , 0.        , ..., 0.        ,
         0.        , 0.77273374],
        [0.79306436, 0.        ,        nan, ..., 0.        ,
         0.        , 0.        ],
        [0.76667871, 0.72075493, 0.80921031, ..., 1.05955842,
         0.68854762, 0.61354773]]])
Coordinates:
  * time     (time) datetime64[ns] 2019-04-10
  * lon      (lon) float64 8.185e-10 0.002976 0.005952 ... 19.99 19.99 20.0
  * lat      (lat) float64 60.0 59.99 59.99 59.99 ... 40.01 40.01 40.0 40.0
Attributes:
    units:    m2.m-2)
Writing to  LAI-clumped.nc
After writing output : 0:00:12.572351
</pre></div>
</div>
</div>
</div>
</section>
<section id="cleaning-up">
<h2>Cleaning up<a class="headerlink" href="#cleaning-up" title="Link to this heading">#</a></h2>
<p>The notebook leaves the following files behind:</p>
<ul class="simple">
<li><p><em>laidata.tgz</em> - compressed tar archive retrieved from CDS</p></li>
<li><p><em>lccdata.tgz</em> - compressed tar archive retrieved from CDS</p></li>
<li><p><em>c3s_LAI_20190410000000_GLOBE_SENTINEL3_V4.0.1.area-subset.60.0.40.20.nc</em> - input LAI data</p></li>
<li><p><em><a class="reference external" href="http://C3S-LC-L4-LCCS-Map-300m-P1Y-2019-v2.1.1.area-subset.60.0.40.20.nc">C3S-LC-L4-LCCS-Map-300m-P1Y-2019-v2.1.1.area-subset.60.0.40.20.nc</a></em> - input LCC data</p></li>
<li><p><em><a class="reference external" href="http://LAI-clumped.nc">LAI-clumped.nc</a></em> - output</p></li>
</ul>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./submodules/c3s-training-submodule-sat-obs-land"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#overview">Overview</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#required-packages">Required packages</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data">Data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#methodology">Methodology<a id="Methodology"></a></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mapping-between-land-cover-classes">Mapping between land cover classes</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#setting-things-up">Setting things up</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#something-to-play-around-with">Something to play around with</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#geting-the-data-the-climate-data-store-cds">Geting the Data: The Climate Data Store (CDS)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#unpacking">Unpacking</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reading-the-data">Reading the data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#applying-quality-flags">Applying quality flags</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#run-the-conversion">Run the conversion</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#cleaning-up">Cleaning up</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By the Copernicus Climate Change Service (C3S), entrusted to ECMWF (European Centre for Medium-Range Weather Forecasts)
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=3ee479438cf8b5e0d341"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=3ee479438cf8b5e0d341"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>