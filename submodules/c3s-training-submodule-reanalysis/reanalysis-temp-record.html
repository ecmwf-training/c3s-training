

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Tutorial on July 2023 record-breaking global surface temperatures using climate data from C3S &#8212; Copernicus Climate Change Service (C3S) training book</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/custom.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'submodules/c3s-training-submodule-reanalysis/reanalysis-temp-record';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Tutorials on C3S seasonal forecasts datasets" href="../c3s-training-submodule-seasonal-forecast/intro.html" />
    <link rel="prev" title="Analysis of September 2020 European heatwave using ERA5 climate reanalysis data from C3S" href="reanalysis-heatwave.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>


  <div class="bd-header-announcement container-fluid bd-header-announcement">
    <div class="bd-header-announcement__content">‚ö†Ô∏èThis is a TEST version, this is not an official website‚ö†Ô∏è</div>
  </div>

  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../../intro.html">
  
  
  
  
  
    <p class="title logo__title">Copernicus Climate Change Service (C3S) training book</p>
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    Copernicus Climate Change Service (C3S) data tutorials
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Introduction</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../how-to-run-these-tutorials.html">How to run these tutorials</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../observations/intro.html">Observations</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../c3s-training-submodule-sat-obs-atmos-physics/intro.html">Satellite observations - atmospheric physics</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../c3s-training-submodule-sat-obs-atmos-physics/erb-outgoing-longwave-radiation.html">Outgoing longwave radiation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../c3s-training-submodule-sat-obs-atmos-physics/erb-clara-climatology.html">Analysis of the CLARA Earth radiation budget product</a></li>
<li class="toctree-l3"><a class="reference internal" href="../c3s-training-submodule-sat-obs-atmos-physics/erb-ceres-climatology.html">Analysis of the CERES Earth radiation budget product</a></li>
<li class="toctree-l3"><a class="reference internal" href="../c3s-training-submodule-sat-obs-atmos-physics/total-solar-irradiance.html">Total solar irradiance</a></li>
<li class="toctree-l3"><a class="reference internal" href="../c3s-training-submodule-sat-obs-atmos-physics/srb-climatology-and-anomaly.html">Surface radiation budget climatologies and anomalies</a></li>
<li class="toctree-l3"><a class="reference internal" href="../c3s-training-submodule-sat-obs-atmos-physics/cloud-cover-climatology.html">Cloud fractional cover climatology</a></li>
<li class="toctree-l3"><a class="reference internal" href="../c3s-training-submodule-sat-obs-atmos-physics/total-column-water-vapour-combi.html">Total column water vapour</a></li>
<li class="toctree-l3"><a class="reference internal" href="../c3s-training-submodule-sat-obs-atmos-physics/tropospheric-humidity-from-radio-occultation.html">Tropospheric humidity estimates from satellite-based radio occultation measurements</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../c3s-training-submodule-sat-obs-atmos-comp/intro.html">Satellite observations - atmospheric composition</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../c3s-training-submodule-sat-obs-atmos-comp/total-ozone-columns.html">Total ozone columns</a></li>
<li class="toctree-l3"><a class="reference internal" href="../c3s-training-submodule-sat-obs-atmos-comp/greenhouse-gases-level2-products.html">Greenhouse gas level 2 products</a></li>
<li class="toctree-l3"><a class="reference internal" href="../c3s-training-submodule-sat-obs-atmos-comp/aerosol-single-sensor-demonstrator.html">Exploration of the aerosol properties products</a></li>
<li class="toctree-l3"><a class="reference internal" href="../c3s-training-submodule-sat-obs-atmos-comp/aerosol-multi-sensor-record.html">A multi-sensor climate data record of aerosol properties</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../c3s-training-submodule-sat-obs-hydro-cryo/intro.html">Satellite observations - hydrology and cryosphere</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../c3s-training-submodule-sat-obs-hydro-cryo/ice-sheet-mass-balance.html">Ice sheet mass balance</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="intro.html">Reanalysis</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="reanalysis-climatology.html">Climatology</a></li>
<li class="toctree-l2"><a class="reference internal" href="reanalysis-heatwave.html">Heatwave analysis</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Temperature record</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../c3s-training-submodule-seasonal-forecast/intro.html">Seasonal forecasts</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-6"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../c3s-training-submodule-seasonal-forecast/sf-anomalies.html">Seasonal forecast anomalies</a></li>
<li class="toctree-l2"><a class="reference internal" href="../c3s-training-submodule-seasonal-forecast/sf-verification.html">Seasonal forecast verification</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../c3s-training-submodule-projections/intro.html">Climate projections</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-7"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../c3s-training-submodule-projections/projections-cmip6.html">Global climate projections (CMIP6)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../c3s-training-submodule-projections/projections-cordex.html">Regional climate projections (CORDEX)</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../c3s-training-submodule-climate-indices/intro.html">Climate indicators</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-8"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../c3s-training-submodule-climate-indices/ci-windchill.html">Windchill</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Other learning resources üìö</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../other_learning_resources.html">Useful links to other ECMWF learning resources</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">ECMWF</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference external" href="https://climate.copernicus.eu/help-and-support">Help &amp; support</a></li>
<li class="toctree-l1"><a class="reference external" href="https://climate.copernicus.eu/">Copernicus Climate Change Service (C3S)</a></li>
<li class="toctree-l1"><a class="reference external" href="https://cds.climate.copernicus.eu/">Copernicus Climate Data Store (CDS)</a></li>
<li class="toctree-l1"><a class="reference external" href="https://climate.copernicus.eu/user-learning-services/">C3S learning services</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/ecmwf-training/C3S-training/main?urlpath=lab/tree/submodules/c3s-training-submodule-reanalysis/reanalysis-temp-record.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onBinder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../../_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/ecmwf-training/C3S-training" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/ecmwf-training/C3S-training/issues/new?title=Issue%20on%20page%20%2Fsubmodules/c3s-training-submodule-reanalysis/reanalysis-temp-record.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/submodules/c3s-training-submodule-reanalysis/reanalysis-temp-record.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Tutorial on July 2023 record-breaking global surface temperatures using climate data from C3S</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#learning-objectives">Learning objectives üéØ</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#prepare-your-environment">Prepare your environment</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#set-up-the-cdsapi-and-your-credentials">Set up the CDSAPI and your credentials</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#install-and-import-libraries">(Install and) Import libraries</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#specify-data-directory">Specify data directory</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#explore-data">Explore data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#search-for-the-data">Search for the data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#download-the-data">Download the data</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#inspect-data">Inspect data</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#change-temperature-units-from-kelvin-to-celsius">Change temperature units from Kelvin to Celsius</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-to-be-used">Data to be used</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plotting-one-timestep">Plotting one timestep</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#calculate-a-surface-temperature-climatology-reference-period-1991-2020">Calculate a surface temperature climatology: reference period 1991-2020</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#standard-reference-periods-and-climatologies">Standard reference periods and climatologies</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#visualise-surface-temperature-anomalies">Visualise surface temperature anomalies</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#view-time-series-and-analyse-surface-temperature-trends">View time series and analyse surface temperature trends</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#view-time-series-and-analyse-north-atlantic-sea-surface-temperature-trends">View time series and analyse North Atlantic sea surface temperature trends</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#this-is-a-new-exercise-in-this-part-of-the-tutorial-we-will-be-working-with-monthly-sea-surface-temperature-sst-data">This is a new exercise. In this part of the tutorial we will be working with monthly sea surface temperature (SST) data.</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <p><a class="reference external" href="https://climate.copernicus.eu"><img alt="logo" src="https://climate.copernicus.eu/sites/default/files/custom-uploads/branding/LogoLine_horizon_C3S.png" /></a></p>
<section class="tex2jax_ignore mathjax_ignore" id="tutorial-on-july-2023-record-breaking-global-surface-temperatures-using-climate-data-from-c3s">
<h1>Tutorial on July 2023 record-breaking global surface temperatures using climate data from C3S<a class="headerlink" href="#tutorial-on-july-2023-record-breaking-global-surface-temperatures-using-climate-data-from-c3s" title="Permalink to this heading">#</a></h1>
<p><strong>This notebook can be run on free online platforms, such as Binder, Kaggle and Colab, or they can be accessed from GitHub. The links to run this notebook in these environments are provided here, but please note they are not supported by ECMWF.</strong></p>
<p><a class="reference external" href="https://mybinder.org/v2/gh/ecmwf-training/c3s-training-submodule-reanalysis/main?labpath=reanalysis-temp-record.ipynb"><img alt="binder" src="https://mybinder.org/badge.svg" /></a>
<a class="reference external" href="https://kaggle.com/kernels/welcome?src=https://github.com/ecmwf-training/c3s-training-submodule-reanalysis/blob/main/reanalysis-temp-record.ipynb"><img alt="kaggle" src="https://kaggle.com/static/images/open-in-kaggle.svg" /></a>
<a class="reference external" href="https://colab.research.google.com/github/ecmwf-training/c3s-training-submodule-reanalysis/blob/main/reanalysis-temp-record.ipynb"><img alt="colab" src="https://colab.research.google.com/assets/colab-badge.svg" /></a>
<a class="reference external" href="https://github.com/ecmwf-training/c3s-training-submodule-reanalysis/blob/main/reanalysis-temp-record.ipynb"><img alt="github" src="https://img.shields.io/badge/Open%20in-GitHub-black?logo=github" /></a></p>
<p><img alt="Example of work" src="../../_images/reanalysis-temp-record-000.png" /></p>
<section id="learning-objectives">
<h2>Learning objectives üéØ<a class="headerlink" href="#learning-objectives" title="Permalink to this heading">#</a></h2>
<p>In this tutorial we will access data from the Climate Data Store (CDS) of the Copernicus Climate Change Service (C3S), and analyse air and sea surface temperatures comparing July 2023 record breaking values with climatologies. We will:</p>
<ul class="simple">
<li><p>Calculate a global surface temperature climatology</p></li>
<li><p>Compute and visualise anomalies with respect to the climatology</p></li>
<li><p>View time series and rank global surface temperature records</p></li>
<li><p>Analyse North Atlantic sea surface temperature trends</p></li>
</ul>
</section>
<section id="prepare-your-environment">
<h2>Prepare your environment<a class="headerlink" href="#prepare-your-environment" title="Permalink to this heading">#</a></h2>
<section id="set-up-the-cdsapi-and-your-credentials">
<h3>Set up the CDSAPI and your credentials<a class="headerlink" href="#set-up-the-cdsapi-and-your-credentials" title="Permalink to this heading">#</a></h3>
<p>The code below will ensure that the <code class="docutils literal notranslate"><span class="pre">cdsapi</span></code> package is installed. If you have not setup your <code class="docutils literal notranslate"><span class="pre">~/.cdsapirc</span></code> file with your credenials, you can replace <code class="docutils literal notranslate"><span class="pre">None</span></code> with your credentials that can be found on the <a class="reference external" href="https://cds.climate.copernicus.eu/how-to-api">how to api</a> page (you will need to log in to see your credentials).</p>
<div class="cell tag_api docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>pip install -q cdsapi
<span class="c1"># If you have already setup your .cdsapirc file you can leave this as None</span>
<span class="n">cdsapi_key</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">cdsapi_url</span> <span class="o">=</span> <span class="kc">None</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="install-and-import-libraries">
<h3>(Install and) Import libraries<a class="headerlink" href="#install-and-import-libraries" title="Permalink to this heading">#</a></h3>
<p>We will be working with data in NetCDF format. To best handle this data we will use libraries for working with multidimensional arrays, in particular Xarray. We will also need libraries for plotting and viewing data, in this case we will use Matplotlib and Cartopy.</p>
<div class="cell tag_import docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">urllib3</span>
<span class="n">urllib3</span><span class="o">.</span><span class="n">disable_warnings</span><span class="p">()</span>

<span class="kn">import</span> <span class="nn">os</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">xarray</span> <span class="k">as</span> <span class="nn">xr</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">cartopy.crs</span> <span class="k">as</span> <span class="nn">ccrs</span>
<span class="kn">import</span> <span class="nn">cdsapi</span>

<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;bmh&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="specify-data-directory">
<h3>Specify data directory<a class="headerlink" href="#specify-data-directory" title="Permalink to this heading">#</a></h3>
<div class="cell tag_directory docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Directory to store data</span>
<span class="c1"># Please ensure that data_dir is a location where you have write permissions</span>
<span class="n">DATADIR</span> <span class="o">=</span> <span class="s1">&#39;./data_dir/&#39;</span>
<span class="c1"># Create this directory if it doesn&#39;t exist</span>
<span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">DATADIR</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="explore-data">
<h2>Explore data<a class="headerlink" href="#explore-data" title="Permalink to this heading">#</a></h2>
<p>To search for data, visit the CDS website: <a class="reference external" href="https://cds.climate.copernicus.eu">https://cds.climate.copernicus.eu</a>.
Here you can search for ERA5 data using the search bar. The data we need for this tutorial is the <a class="reference external" href="https://cds.climate.copernicus.eu/datasets/reanalysis-era5-single-levels-monthly-means?tab=overview">ERA5 monthly averaged data on single levels from 1940 to present</a>. ERA5 is the 5th version of the ECMWF Reanalysis dataset. Reanalysis uses a state of the art forecast model and data assimilation system to create a consistent ‚Äúmap without gaps‚Äù of observed and modelled climate variables over the past decades.</p>
<section id="search-for-the-data">
<h3>Search for the data<a class="headerlink" href="#search-for-the-data" title="Permalink to this heading">#</a></h3>
<p>Having selected the correct dataset, we now need to specify what product type, variables, temporal and geographic coverage we are interested in. These can all be selected in the <strong>‚ÄúDownload data‚Äù</strong> tab. In this tab a form appears in which we will select the following parameters to download:</p>
<details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header">
Parameters of data to download<div class="sd-summary-down docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-down" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M5.22 8.72a.75.75 0 000 1.06l6.25 6.25a.75.75 0 001.06 0l6.25-6.25a.75.75 0 00-1.06-1.06L12 14.44 6.28 8.72a.75.75 0 00-1.06 0z"></path></svg></div>
<div class="sd-summary-up docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-up" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M18.78 15.28a.75.75 0 000-1.06l-6.25-6.25a.75.75 0 00-1.06 0l-6.25 6.25a.75.75 0 101.06 1.06L12 9.56l5.72 5.72a.75.75 0 001.06 0z"></path></svg></div>
</summary><div class="sd-summary-content sd-card-body docutils">
<ul class="simple">
<li><p class="sd-card-text">Product type: <code class="docutils literal notranslate"><span class="pre">Monthly</span> <span class="pre">averaged</span> <span class="pre">reanalysis</span></code></p></li>
<li><p class="sd-card-text">Variable: <code class="docutils literal notranslate"><span class="pre">2m</span> <span class="pre">temperature</span></code></p></li>
<li><p class="sd-card-text">Year: <code class="docutils literal notranslate"><span class="pre">1940</span> <span class="pre">to</span> <span class="pre">present</span> <span class="pre">year</span></code></p></li>
<li><p class="sd-card-text">Month: <code class="docutils literal notranslate"><span class="pre">july</span></code></p></li>
<li><p class="sd-card-text">Time: <code class="docutils literal notranslate"><span class="pre">00:00</span></code> (default)</p></li>
<li><p class="sd-card-text">Geographical area: <code class="docutils literal notranslate"><span class="pre">Sub-region</span> <span class="pre">extraction</span></code> and leave the default values, <code class="docutils literal notranslate"><span class="pre">'area':</span> <span class="pre">[90,</span> <span class="pre">-180,</span> <span class="pre">-90,</span> <span class="pre">180],</span> <span class="pre">#</span> <span class="pre">maxlat,</span> <span class="pre">minlon,</span> <span class="pre">minlat,</span> <span class="pre">maxlon</span></code> (this will be explained further below)</p></li>
<li><p class="sd-card-text">Format: <code class="docutils literal notranslate"><span class="pre">NetCDF</span></code></p></li>
</ul>
</div>
</details><p><img alt="" src="../../_images/reanalysis-temp-record-001.png" /></p>
<p>At the end of the download forms, select ‚ÄúShow API request‚Äù. This will reveal a block of code, which you can simply copy and paste into a cell of your Jupyter Notebook (see cell below). Having copied the API request into the cell below, running this will retrieve and download the data you requested into your local directory.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Please remember to accept the terms and conditions of the dataset, at the bottom of the CDS download form!</p>
</div>
</section>
<section id="download-the-data">
<h3>Download the data<a class="headerlink" href="#download-the-data" title="Permalink to this heading">#</a></h3>
<p>With the API request copied into the cell below, running this cell will retrieve and download the data you requested into your local directory.</p>
<div class="cell tag_request docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">c</span> <span class="o">=</span> <span class="n">cdsapi</span><span class="o">.</span><span class="n">Client</span><span class="p">()</span>
<span class="n">c</span><span class="o">.</span><span class="n">retrieve</span><span class="p">(</span>
    <span class="s1">&#39;reanalysis-era5-single-levels-monthly-means&#39;</span><span class="p">,</span>
    <span class="p">{</span>
        <span class="s1">&#39;data_format&#39;</span><span class="p">:</span> <span class="s1">&#39;netcdf&#39;</span><span class="p">,</span>
        <span class="s1">&#39;product_type&#39;</span><span class="p">:</span> <span class="s1">&#39;monthly_averaged_reanalysis&#39;</span><span class="p">,</span>
        <span class="s1">&#39;variable&#39;</span><span class="p">:</span> <span class="s1">&#39;2m_temperature&#39;</span><span class="p">,</span>
        <span class="s1">&#39;year&#39;</span><span class="p">:</span> <span class="p">[</span>
            <span class="s1">&#39;1940&#39;</span><span class="p">,</span> <span class="s1">&#39;1941&#39;</span><span class="p">,</span> <span class="s1">&#39;1942&#39;</span><span class="p">,</span>
            <span class="s1">&#39;1943&#39;</span><span class="p">,</span> <span class="s1">&#39;1944&#39;</span><span class="p">,</span> <span class="s1">&#39;1945&#39;</span><span class="p">,</span>
            <span class="s1">&#39;1946&#39;</span><span class="p">,</span> <span class="s1">&#39;1947&#39;</span><span class="p">,</span> <span class="s1">&#39;1948&#39;</span><span class="p">,</span>
            <span class="s1">&#39;1949&#39;</span><span class="p">,</span> <span class="s1">&#39;1950&#39;</span><span class="p">,</span> <span class="s1">&#39;1951&#39;</span><span class="p">,</span>
            <span class="s1">&#39;1952&#39;</span><span class="p">,</span> <span class="s1">&#39;1953&#39;</span><span class="p">,</span> <span class="s1">&#39;1954&#39;</span><span class="p">,</span>
            <span class="s1">&#39;1955&#39;</span><span class="p">,</span> <span class="s1">&#39;1956&#39;</span><span class="p">,</span> <span class="s1">&#39;1957&#39;</span><span class="p">,</span>
            <span class="s1">&#39;1958&#39;</span><span class="p">,</span> <span class="s1">&#39;1959&#39;</span><span class="p">,</span> <span class="s1">&#39;1960&#39;</span><span class="p">,</span>
            <span class="s1">&#39;1961&#39;</span><span class="p">,</span> <span class="s1">&#39;1962&#39;</span><span class="p">,</span> <span class="s1">&#39;1963&#39;</span><span class="p">,</span>
            <span class="s1">&#39;1964&#39;</span><span class="p">,</span> <span class="s1">&#39;1965&#39;</span><span class="p">,</span> <span class="s1">&#39;1966&#39;</span><span class="p">,</span>
            <span class="s1">&#39;1967&#39;</span><span class="p">,</span> <span class="s1">&#39;1968&#39;</span><span class="p">,</span> <span class="s1">&#39;1969&#39;</span><span class="p">,</span>
            <span class="s1">&#39;1970&#39;</span><span class="p">,</span> <span class="s1">&#39;1971&#39;</span><span class="p">,</span> <span class="s1">&#39;1972&#39;</span><span class="p">,</span>
            <span class="s1">&#39;1973&#39;</span><span class="p">,</span> <span class="s1">&#39;1974&#39;</span><span class="p">,</span> <span class="s1">&#39;1975&#39;</span><span class="p">,</span>
            <span class="s1">&#39;1976&#39;</span><span class="p">,</span> <span class="s1">&#39;1977&#39;</span><span class="p">,</span> <span class="s1">&#39;1978&#39;</span><span class="p">,</span>
            <span class="s1">&#39;1979&#39;</span><span class="p">,</span> <span class="s1">&#39;1980&#39;</span><span class="p">,</span> <span class="s1">&#39;1981&#39;</span><span class="p">,</span>
            <span class="s1">&#39;1982&#39;</span><span class="p">,</span> <span class="s1">&#39;1983&#39;</span><span class="p">,</span> <span class="s1">&#39;1984&#39;</span><span class="p">,</span>
            <span class="s1">&#39;1985&#39;</span><span class="p">,</span> <span class="s1">&#39;1986&#39;</span><span class="p">,</span> <span class="s1">&#39;1987&#39;</span><span class="p">,</span>
            <span class="s1">&#39;1988&#39;</span><span class="p">,</span> <span class="s1">&#39;1989&#39;</span><span class="p">,</span> <span class="s1">&#39;1990&#39;</span><span class="p">,</span>
            <span class="s1">&#39;1991&#39;</span><span class="p">,</span> <span class="s1">&#39;1992&#39;</span><span class="p">,</span> <span class="s1">&#39;1993&#39;</span><span class="p">,</span>
            <span class="s1">&#39;1994&#39;</span><span class="p">,</span> <span class="s1">&#39;1995&#39;</span><span class="p">,</span> <span class="s1">&#39;1996&#39;</span><span class="p">,</span>
            <span class="s1">&#39;1997&#39;</span><span class="p">,</span> <span class="s1">&#39;1998&#39;</span><span class="p">,</span> <span class="s1">&#39;1999&#39;</span><span class="p">,</span>
            <span class="s1">&#39;2000&#39;</span><span class="p">,</span> <span class="s1">&#39;2001&#39;</span><span class="p">,</span> <span class="s1">&#39;2002&#39;</span><span class="p">,</span>
            <span class="s1">&#39;2003&#39;</span><span class="p">,</span> <span class="s1">&#39;2004&#39;</span><span class="p">,</span> <span class="s1">&#39;2005&#39;</span><span class="p">,</span>
            <span class="s1">&#39;2006&#39;</span><span class="p">,</span> <span class="s1">&#39;2007&#39;</span><span class="p">,</span> <span class="s1">&#39;2008&#39;</span><span class="p">,</span>
            <span class="s1">&#39;2009&#39;</span><span class="p">,</span> <span class="s1">&#39;2010&#39;</span><span class="p">,</span> <span class="s1">&#39;2011&#39;</span><span class="p">,</span>
            <span class="s1">&#39;2012&#39;</span><span class="p">,</span> <span class="s1">&#39;2013&#39;</span><span class="p">,</span> <span class="s1">&#39;2014&#39;</span><span class="p">,</span>
            <span class="s1">&#39;2015&#39;</span><span class="p">,</span> <span class="s1">&#39;2016&#39;</span><span class="p">,</span> <span class="s1">&#39;2017&#39;</span><span class="p">,</span>
            <span class="s1">&#39;2018&#39;</span><span class="p">,</span> <span class="s1">&#39;2019&#39;</span><span class="p">,</span> <span class="s1">&#39;2020&#39;</span><span class="p">,</span>
            <span class="s1">&#39;2021&#39;</span><span class="p">,</span> <span class="s1">&#39;2022&#39;</span><span class="p">,</span> <span class="s1">&#39;2023&#39;</span><span class="p">,</span>
        <span class="p">],</span>
        <span class="s1">&#39;month&#39;</span><span class="p">:</span> <span class="s1">&#39;07&#39;</span><span class="p">,</span>
        <span class="s1">&#39;time&#39;</span><span class="p">:</span> <span class="s1">&#39;00:00&#39;</span><span class="p">,</span>
        <span class="s1">&#39;area&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">90</span><span class="p">,</span> <span class="o">-</span><span class="mi">180</span><span class="p">,</span> <span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="mi">180</span><span class="p">],</span> <span class="c1"># maxlat, minlon, minlat, maxlon</span>
    <span class="p">},</span>
    <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">DATADIR</span><span class="si">}</span><span class="s1">t2m_global_july_1940-2023.nc&#39;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-07-15 10:14:14,343 INFO [2024-09-26T00:00:00] Watch our [Forum](https://forum.ecmwf.int/) for Announcements, news and other discussed topics.
2025-07-15 10:14:14,592 INFO Request ID is d03b586b-7198-451c-a56b-25da8fbd041e
2025-07-15 10:14:14,695 INFO status has been updated to accepted
2025-07-15 10:14:23,417 INFO status has been updated to running
2025-07-15 10:14:28,561 INFO status has been updated to accepted
2025-07-15 10:14:36,230 INFO status has been updated to running
2025-07-15 10:14:47,836 INFO status has been updated to successful
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "676a47daebe94cee9cb047a960aa9d6e", "version_major": 2, "version_minor": 0}</script><div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;./data_dir/t2m_global_july_1940-2023.nc&#39;
</pre></div>
</div>
</div>
</div>
<section id="inspect-data">
<h4>Inspect data<a class="headerlink" href="#inspect-data" title="Permalink to this heading">#</a></h4>
<p>Now that we have downloaded the data, we can inspect it. We have requested the data in NetCDF format. This is a commonly used format for array-oriented scientific data. To read and process this data we will make use of the <a class="reference external" href="http://xarray.pydata.org/en/stable/">Xarray</a> library. Xarray is an open source project and Python package that makes working with labelled multi-dimensional arrays simple and efficient. We will read the data from our NetCDF file into an <a class="reference external" href="https://xarray.pydata.org/en/stable/generated/xarray.Dataset.html"><code class="docutils literal notranslate"><span class="pre">xarray.Dataset</span></code></a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ds</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">DATADIR</span><span class="si">}</span><span class="s1">t2m_global_july_1940-2023.nc&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Now we can query our newly created Xarray dataset‚Ä¶ Let‚Äôs have a look at the <code class="docutils literal notranslate"><span class="pre">ds</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ds</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme="dark"],
html[data-theme="dark"],
body[data-theme="dark"],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1f1f1f;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: inline-block;
  opacity: 0;
  height: 0;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:focus + label {
  border: 2px solid var(--xr-font-color0);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: "‚ñ∫";
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: "‚ñº";
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: "(";
}

.xr-dim-list:after {
  content: ")";
}

.xr-dim-list li:not(:last-child):after {
  content: ",";
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 349MB
Dimensions:     (valid_time: 84, latitude: 721, longitude: 1440)
Coordinates:
    number      int64 8B ...
  * valid_time  (valid_time) datetime64[ns] 672B 1940-07-01 ... 2023-07-01
  * latitude    (latitude) float64 6kB 90.0 89.75 89.5 ... -89.5 -89.75 -90.0
  * longitude   (longitude) float64 12kB -180.0 -179.8 -179.5 ... 179.5 179.8
    expver      (valid_time) &lt;U4 1kB ...
Data variables:
    t2m         (valid_time, latitude, longitude) float32 349MB ...
Attributes:
    GRIB_centre:             ecmf
    GRIB_centreDescription:  European Centre for Medium-Range Weather Forecasts
    GRIB_subCentre:          0
    Conventions:             CF-1.7
    institution:             European Centre for Medium-Range Weather Forecasts
    history:                 2025-07-15T08:14 GRIB to CDM+CF via cfgrib-0.9.1...</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-9d3b1dc0-16d6-4eb4-8f94-c9cd235d1b72' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-9d3b1dc0-16d6-4eb4-8f94-c9cd235d1b72' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>valid_time</span>: 84</li><li><span class='xr-has-index'>latitude</span>: 721</li><li><span class='xr-has-index'>longitude</span>: 1440</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-8df545fb-9eda-4dc3-a19d-05d6c2c1543f' class='xr-section-summary-in' type='checkbox'  checked><label for='section-8df545fb-9eda-4dc3-a19d-05d6c2c1543f' class='xr-section-summary' >Coordinates: <span>(5)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>number</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-9879ca92-a32a-4e25-b7e8-6e54566224b2' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-9879ca92-a32a-4e25-b7e8-6e54566224b2' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a32d6ec2-1c4a-48a1-b3a5-0d92c8d20ea5' class='xr-var-data-in' type='checkbox'><label for='data-a32d6ec2-1c4a-48a1-b3a5-0d92c8d20ea5' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>ensemble member numerical id</dd><dt><span>units :</span></dt><dd>1</dd><dt><span>standard_name :</span></dt><dd>realization</dd></dl></div><div class='xr-var-data'><pre>[1 values with dtype=int64]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>valid_time</span></div><div class='xr-var-dims'>(valid_time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>1940-07-01 ... 2023-07-01</div><input id='attrs-2f34ee29-a0ee-4d6f-b5d4-852c97eaaf44' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-2f34ee29-a0ee-4d6f-b5d4-852c97eaaf44' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-355cf06b-f430-4358-8f19-1b81921755ce' class='xr-var-data-in' type='checkbox'><label for='data-355cf06b-f430-4358-8f19-1b81921755ce' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>time</dd><dt><span>standard_name :</span></dt><dd>time</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;1940-07-01T00:00:00.000000000&#x27;, &#x27;1941-07-01T00:00:00.000000000&#x27;,
       &#x27;1942-07-01T00:00:00.000000000&#x27;, &#x27;1943-07-01T00:00:00.000000000&#x27;,
       &#x27;1944-07-01T00:00:00.000000000&#x27;, &#x27;1945-07-01T00:00:00.000000000&#x27;,
       &#x27;1946-07-01T00:00:00.000000000&#x27;, &#x27;1947-07-01T00:00:00.000000000&#x27;,
       &#x27;1948-07-01T00:00:00.000000000&#x27;, &#x27;1949-07-01T00:00:00.000000000&#x27;,
       &#x27;1950-07-01T00:00:00.000000000&#x27;, &#x27;1951-07-01T00:00:00.000000000&#x27;,
       &#x27;1952-07-01T00:00:00.000000000&#x27;, &#x27;1953-07-01T00:00:00.000000000&#x27;,
       &#x27;1954-07-01T00:00:00.000000000&#x27;, &#x27;1955-07-01T00:00:00.000000000&#x27;,
       &#x27;1956-07-01T00:00:00.000000000&#x27;, &#x27;1957-07-01T00:00:00.000000000&#x27;,
       &#x27;1958-07-01T00:00:00.000000000&#x27;, &#x27;1959-07-01T00:00:00.000000000&#x27;,
       &#x27;1960-07-01T00:00:00.000000000&#x27;, &#x27;1961-07-01T00:00:00.000000000&#x27;,
       &#x27;1962-07-01T00:00:00.000000000&#x27;, &#x27;1963-07-01T00:00:00.000000000&#x27;,
       &#x27;1964-07-01T00:00:00.000000000&#x27;, &#x27;1965-07-01T00:00:00.000000000&#x27;,
       &#x27;1966-07-01T00:00:00.000000000&#x27;, &#x27;1967-07-01T00:00:00.000000000&#x27;,
       &#x27;1968-07-01T00:00:00.000000000&#x27;, &#x27;1969-07-01T00:00:00.000000000&#x27;,
       &#x27;1970-07-01T00:00:00.000000000&#x27;, &#x27;1971-07-01T00:00:00.000000000&#x27;,
       &#x27;1972-07-01T00:00:00.000000000&#x27;, &#x27;1973-07-01T00:00:00.000000000&#x27;,
       &#x27;1974-07-01T00:00:00.000000000&#x27;, &#x27;1975-07-01T00:00:00.000000000&#x27;,
       &#x27;1976-07-01T00:00:00.000000000&#x27;, &#x27;1977-07-01T00:00:00.000000000&#x27;,
       &#x27;1978-07-01T00:00:00.000000000&#x27;, &#x27;1979-07-01T00:00:00.000000000&#x27;,
       &#x27;1980-07-01T00:00:00.000000000&#x27;, &#x27;1981-07-01T00:00:00.000000000&#x27;,
       &#x27;1982-07-01T00:00:00.000000000&#x27;, &#x27;1983-07-01T00:00:00.000000000&#x27;,
       &#x27;1984-07-01T00:00:00.000000000&#x27;, &#x27;1985-07-01T00:00:00.000000000&#x27;,
       &#x27;1986-07-01T00:00:00.000000000&#x27;, &#x27;1987-07-01T00:00:00.000000000&#x27;,
       &#x27;1988-07-01T00:00:00.000000000&#x27;, &#x27;1989-07-01T00:00:00.000000000&#x27;,
       &#x27;1990-07-01T00:00:00.000000000&#x27;, &#x27;1991-07-01T00:00:00.000000000&#x27;,
       &#x27;1992-07-01T00:00:00.000000000&#x27;, &#x27;1993-07-01T00:00:00.000000000&#x27;,
       &#x27;1994-07-01T00:00:00.000000000&#x27;, &#x27;1995-07-01T00:00:00.000000000&#x27;,
       &#x27;1996-07-01T00:00:00.000000000&#x27;, &#x27;1997-07-01T00:00:00.000000000&#x27;,
       &#x27;1998-07-01T00:00:00.000000000&#x27;, &#x27;1999-07-01T00:00:00.000000000&#x27;,
       &#x27;2000-07-01T00:00:00.000000000&#x27;, &#x27;2001-07-01T00:00:00.000000000&#x27;,
       &#x27;2002-07-01T00:00:00.000000000&#x27;, &#x27;2003-07-01T00:00:00.000000000&#x27;,
       &#x27;2004-07-01T00:00:00.000000000&#x27;, &#x27;2005-07-01T00:00:00.000000000&#x27;,
       &#x27;2006-07-01T00:00:00.000000000&#x27;, &#x27;2007-07-01T00:00:00.000000000&#x27;,
       &#x27;2008-07-01T00:00:00.000000000&#x27;, &#x27;2009-07-01T00:00:00.000000000&#x27;,
       &#x27;2010-07-01T00:00:00.000000000&#x27;, &#x27;2011-07-01T00:00:00.000000000&#x27;,
       &#x27;2012-07-01T00:00:00.000000000&#x27;, &#x27;2013-07-01T00:00:00.000000000&#x27;,
       &#x27;2014-07-01T00:00:00.000000000&#x27;, &#x27;2015-07-01T00:00:00.000000000&#x27;,
       &#x27;2016-07-01T00:00:00.000000000&#x27;, &#x27;2017-07-01T00:00:00.000000000&#x27;,
       &#x27;2018-07-01T00:00:00.000000000&#x27;, &#x27;2019-07-01T00:00:00.000000000&#x27;,
       &#x27;2020-07-01T00:00:00.000000000&#x27;, &#x27;2021-07-01T00:00:00.000000000&#x27;,
       &#x27;2022-07-01T00:00:00.000000000&#x27;, &#x27;2023-07-01T00:00:00.000000000&#x27;],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>latitude</span></div><div class='xr-var-dims'>(latitude)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>90.0 89.75 89.5 ... -89.75 -90.0</div><input id='attrs-6e28ef0d-415f-4b1f-b2b2-7bb9f22c2740' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-6e28ef0d-415f-4b1f-b2b2-7bb9f22c2740' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-0b223d6f-4616-4028-a6ef-6252737e4099' class='xr-var-data-in' type='checkbox'><label for='data-0b223d6f-4616-4028-a6ef-6252737e4099' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>long_name :</span></dt><dd>latitude</dd><dt><span>stored_direction :</span></dt><dd>decreasing</dd></dl></div><div class='xr-var-data'><pre>array([ 90.  ,  89.75,  89.5 , ..., -89.5 , -89.75, -90.  ], shape=(721,))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>longitude</span></div><div class='xr-var-dims'>(longitude)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-180.0 -179.8 ... 179.5 179.8</div><input id='attrs-c027d979-b125-4c2e-a4e9-5f29d2800e9d' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-c027d979-b125-4c2e-a4e9-5f29d2800e9d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d65362e9-5d2c-4720-9412-0d0854126417' class='xr-var-data-in' type='checkbox'><label for='data-d65362e9-5d2c-4720-9412-0d0854126417' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>long_name :</span></dt><dd>longitude</dd></dl></div><div class='xr-var-data'><pre>array([-180.  , -179.75, -179.5 , ...,  179.25,  179.5 ,  179.75],
      shape=(1440,))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>expver</span></div><div class='xr-var-dims'>(valid_time)</div><div class='xr-var-dtype'>&lt;U4</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-8cb4c05a-bb92-4d39-a351-f75a12b71866' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-8cb4c05a-bb92-4d39-a351-f75a12b71866' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-278ecfc0-8fe5-41b1-815a-6c853fd3050a' class='xr-var-data-in' type='checkbox'><label for='data-278ecfc0-8fe5-41b1-815a-6c853fd3050a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>[84 values with dtype=&lt;U4]</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-5d4acea8-0207-4098-9a06-db8e3e0b92d4' class='xr-section-summary-in' type='checkbox'  checked><label for='section-5d4acea8-0207-4098-9a06-db8e3e0b92d4' class='xr-section-summary' >Data variables: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>t2m</span></div><div class='xr-var-dims'>(valid_time, latitude, longitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-d9a5c5c7-2ae0-4f84-933e-29cd7bf7ae09' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-d9a5c5c7-2ae0-4f84-933e-29cd7bf7ae09' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-08d143d4-e057-4642-a585-053713ef2c78' class='xr-var-data-in' type='checkbox'><label for='data-08d143d4-e057-4642-a585-053713ef2c78' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>GRIB_paramId :</span></dt><dd>167</dd><dt><span>GRIB_dataType :</span></dt><dd>an</dd><dt><span>GRIB_numberOfPoints :</span></dt><dd>1038240</dd><dt><span>GRIB_typeOfLevel :</span></dt><dd>surface</dd><dt><span>GRIB_stepUnits :</span></dt><dd>1</dd><dt><span>GRIB_stepType :</span></dt><dd>avgua</dd><dt><span>GRIB_gridType :</span></dt><dd>regular_ll</dd><dt><span>GRIB_uvRelativeToGrid :</span></dt><dd>0</dd><dt><span>GRIB_NV :</span></dt><dd>0</dd><dt><span>GRIB_Nx :</span></dt><dd>1440</dd><dt><span>GRIB_Ny :</span></dt><dd>721</dd><dt><span>GRIB_cfName :</span></dt><dd>unknown</dd><dt><span>GRIB_cfVarName :</span></dt><dd>t2m</dd><dt><span>GRIB_gridDefinitionDescription :</span></dt><dd>Latitude/Longitude Grid</dd><dt><span>GRIB_iDirectionIncrementInDegrees :</span></dt><dd>0.25</dd><dt><span>GRIB_iScansNegatively :</span></dt><dd>0</dd><dt><span>GRIB_jDirectionIncrementInDegrees :</span></dt><dd>0.25</dd><dt><span>GRIB_jPointsAreConsecutive :</span></dt><dd>0</dd><dt><span>GRIB_jScansPositively :</span></dt><dd>0</dd><dt><span>GRIB_latitudeOfFirstGridPointInDegrees :</span></dt><dd>90.0</dd><dt><span>GRIB_latitudeOfLastGridPointInDegrees :</span></dt><dd>-90.0</dd><dt><span>GRIB_longitudeOfFirstGridPointInDegrees :</span></dt><dd>-180.0</dd><dt><span>GRIB_longitudeOfLastGridPointInDegrees :</span></dt><dd>179.75</dd><dt><span>GRIB_missingValue :</span></dt><dd>3.4028234663852886e+38</dd><dt><span>GRIB_name :</span></dt><dd>2 metre temperature</dd><dt><span>GRIB_shortName :</span></dt><dd>2t</dd><dt><span>GRIB_totalNumber :</span></dt><dd>0</dd><dt><span>GRIB_units :</span></dt><dd>K</dd><dt><span>long_name :</span></dt><dd>2 metre temperature</dd><dt><span>units :</span></dt><dd>K</dd><dt><span>standard_name :</span></dt><dd>unknown</dd><dt><span>GRIB_surface :</span></dt><dd>0.0</dd></dl></div><div class='xr-var-data'><pre>[87212160 values with dtype=float32]</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-6c42c2eb-fab9-4782-8ab7-b14ebc8e2701' class='xr-section-summary-in' type='checkbox'  ><label for='section-6c42c2eb-fab9-4782-8ab7-b14ebc8e2701' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>valid_time</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-cd5f080a-e73a-473c-bf3b-796a8b8ecc1d' class='xr-index-data-in' type='checkbox'/><label for='index-cd5f080a-e73a-473c-bf3b-796a8b8ecc1d' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;1940-07-01&#x27;, &#x27;1941-07-01&#x27;, &#x27;1942-07-01&#x27;, &#x27;1943-07-01&#x27;,
               &#x27;1944-07-01&#x27;, &#x27;1945-07-01&#x27;, &#x27;1946-07-01&#x27;, &#x27;1947-07-01&#x27;,
               &#x27;1948-07-01&#x27;, &#x27;1949-07-01&#x27;, &#x27;1950-07-01&#x27;, &#x27;1951-07-01&#x27;,
               &#x27;1952-07-01&#x27;, &#x27;1953-07-01&#x27;, &#x27;1954-07-01&#x27;, &#x27;1955-07-01&#x27;,
               &#x27;1956-07-01&#x27;, &#x27;1957-07-01&#x27;, &#x27;1958-07-01&#x27;, &#x27;1959-07-01&#x27;,
               &#x27;1960-07-01&#x27;, &#x27;1961-07-01&#x27;, &#x27;1962-07-01&#x27;, &#x27;1963-07-01&#x27;,
               &#x27;1964-07-01&#x27;, &#x27;1965-07-01&#x27;, &#x27;1966-07-01&#x27;, &#x27;1967-07-01&#x27;,
               &#x27;1968-07-01&#x27;, &#x27;1969-07-01&#x27;, &#x27;1970-07-01&#x27;, &#x27;1971-07-01&#x27;,
               &#x27;1972-07-01&#x27;, &#x27;1973-07-01&#x27;, &#x27;1974-07-01&#x27;, &#x27;1975-07-01&#x27;,
               &#x27;1976-07-01&#x27;, &#x27;1977-07-01&#x27;, &#x27;1978-07-01&#x27;, &#x27;1979-07-01&#x27;,
               &#x27;1980-07-01&#x27;, &#x27;1981-07-01&#x27;, &#x27;1982-07-01&#x27;, &#x27;1983-07-01&#x27;,
               &#x27;1984-07-01&#x27;, &#x27;1985-07-01&#x27;, &#x27;1986-07-01&#x27;, &#x27;1987-07-01&#x27;,
               &#x27;1988-07-01&#x27;, &#x27;1989-07-01&#x27;, &#x27;1990-07-01&#x27;, &#x27;1991-07-01&#x27;,
               &#x27;1992-07-01&#x27;, &#x27;1993-07-01&#x27;, &#x27;1994-07-01&#x27;, &#x27;1995-07-01&#x27;,
               &#x27;1996-07-01&#x27;, &#x27;1997-07-01&#x27;, &#x27;1998-07-01&#x27;, &#x27;1999-07-01&#x27;,
               &#x27;2000-07-01&#x27;, &#x27;2001-07-01&#x27;, &#x27;2002-07-01&#x27;, &#x27;2003-07-01&#x27;,
               &#x27;2004-07-01&#x27;, &#x27;2005-07-01&#x27;, &#x27;2006-07-01&#x27;, &#x27;2007-07-01&#x27;,
               &#x27;2008-07-01&#x27;, &#x27;2009-07-01&#x27;, &#x27;2010-07-01&#x27;, &#x27;2011-07-01&#x27;,
               &#x27;2012-07-01&#x27;, &#x27;2013-07-01&#x27;, &#x27;2014-07-01&#x27;, &#x27;2015-07-01&#x27;,
               &#x27;2016-07-01&#x27;, &#x27;2017-07-01&#x27;, &#x27;2018-07-01&#x27;, &#x27;2019-07-01&#x27;,
               &#x27;2020-07-01&#x27;, &#x27;2021-07-01&#x27;, &#x27;2022-07-01&#x27;, &#x27;2023-07-01&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;valid_time&#x27;, freq=None))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>latitude</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-5c123542-1971-47de-a0dc-8f53c14af085' class='xr-index-data-in' type='checkbox'/><label for='index-5c123542-1971-47de-a0dc-8f53c14af085' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([  90.0,  89.75,   89.5,  89.25,   89.0,  88.75,   88.5,  88.25,   88.0,
        87.75,
       ...
       -87.75,  -88.0, -88.25,  -88.5, -88.75,  -89.0, -89.25,  -89.5, -89.75,
        -90.0],
      dtype=&#x27;float64&#x27;, name=&#x27;latitude&#x27;, length=721))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>longitude</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-6254c46b-5d50-4c63-b64f-76f33161a3d7' class='xr-index-data-in' type='checkbox'/><label for='index-6254c46b-5d50-4c63-b64f-76f33161a3d7' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([ -180.0, -179.75,  -179.5, -179.25,  -179.0, -178.75,  -178.5, -178.25,
        -178.0, -177.75,
       ...
         177.5,  177.75,   178.0,  178.25,   178.5,  178.75,   179.0,  179.25,
         179.5,  179.75],
      dtype=&#x27;float64&#x27;, name=&#x27;longitude&#x27;, length=1440))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-68852403-7881-4f95-b6af-5811f605bf86' class='xr-section-summary-in' type='checkbox'  checked><label for='section-68852403-7881-4f95-b6af-5811f605bf86' class='xr-section-summary' >Attributes: <span>(6)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>GRIB_centre :</span></dt><dd>ecmf</dd><dt><span>GRIB_centreDescription :</span></dt><dd>European Centre for Medium-Range Weather Forecasts</dd><dt><span>GRIB_subCentre :</span></dt><dd>0</dd><dt><span>Conventions :</span></dt><dd>CF-1.7</dd><dt><span>institution :</span></dt><dd>European Centre for Medium-Range Weather Forecasts</dd><dt><span>history :</span></dt><dd>2025-07-15T08:14 GRIB to CDM+CF via cfgrib-0.9.15.0/ecCodes-2.41.0 with {&quot;source&quot;: &quot;tmpk6q1ie0d/data.grib&quot;, &quot;filter_by_keys&quot;: {&quot;stream&quot;: [&quot;moda&quot;], &quot;stepType&quot;: [&quot;avgua&quot;]}, &quot;encode_cf&quot;: [&quot;parameter&quot;, &quot;time&quot;, &quot;geography&quot;, &quot;vertical&quot;]}</dd></dl></div></li></ul></div></div></div></div>
</div>
<p>We see that the dataset has one variable called <code class="docutils literal notranslate"><span class="pre">t2m</span></code>, which stands for ‚Äú2 metre temperature‚Äù, and three coordinates of <code class="docutils literal notranslate"><span class="pre">longitude</span></code>, <code class="docutils literal notranslate"><span class="pre">latitude</span></code> and <code class="docutils literal notranslate"><span class="pre">time</span></code>.</p>
<p>Before we have commented to choose the <code class="docutils literal notranslate"><span class="pre">sub-region</span> <span class="pre">extraction</span></code> option but selecting the whole region in the request to the CDSAPI, <code class="docutils literal notranslate"><span class="pre">'area':</span> <span class="pre">[90,</span> <span class="pre">-180,</span> <span class="pre">-90,</span> <span class="pre">180],</span> <span class="pre">#</span> <span class="pre">maxlat,</span> <span class="pre">minlon,</span> <span class="pre">minlat,</span> <span class="pre">maxlon</span></code>. If we had chosen the <code class="docutils literal notranslate"><span class="pre">whole</span> <span class="pre">available</span> <span class="pre">region</span></code> option then the longitudes in the Xarray Dataset would be on a [0, 360] grid instead of [-180, 180] and we should correct this performing some extra steps.</p>
<p>If your longitudes are on a [0, 360] grid you could do the following to bring the longitude coordinates to a [-180, 180] grid:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ds_180</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">assign_coords</span><span class="p">(</span>
    <span class="n">longitude</span><span class="o">=</span><span class="p">(((</span><span class="n">ds</span><span class="o">.</span><span class="n">longitude</span> <span class="o">+</span> <span class="mi">180</span><span class="p">)</span> <span class="o">%</span> <span class="mi">360</span><span class="p">)</span> <span class="o">-</span> <span class="mi">180</span><span class="p">)</span>
<span class="p">)</span><span class="o">.</span><span class="n">sortby</span><span class="p">(</span><span class="s1">&#39;longitude&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>There is also an <code class="docutils literal notranslate"><span class="pre">expver</span></code> coordinate. More on this later.</p>
<p>Select the icons to the right of the table above to expand the attributes of the coordinates and data variables. What are the units of the temperature data?</p>
<p>While an Xarray dataset may contain multiple variables, an Xarray data array holds a single multi-dimensional variable and its coordinates. To make the processing of the <code class="docutils literal notranslate"><span class="pre">t2m</span></code> data easier, we convert it into an Xarray data array. We will call it <code class="docutils literal notranslate"><span class="pre">da_tmp</span></code> (a temporary data array) because we will transform the data in some ways.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">da_tmp</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="s1">&#39;t2m&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>Let‚Äôs view this data:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">da_tmp</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme="dark"],
html[data-theme="dark"],
body[data-theme="dark"],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1f1f1f;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: inline-block;
  opacity: 0;
  height: 0;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:focus + label {
  border: 2px solid var(--xr-font-color0);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: "‚ñ∫";
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: "‚ñº";
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: "(";
}

.xr-dim-list:after {
  content: ")";
}

.xr-dim-list li:not(:last-child):after {
  content: ",";
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;t2m&#x27; (valid_time: 84, latitude: 721, longitude: 1440)&gt; Size: 349MB
[87212160 values with dtype=float32]
Coordinates:
    number      int64 8B ...
  * valid_time  (valid_time) datetime64[ns] 672B 1940-07-01 ... 2023-07-01
  * latitude    (latitude) float64 6kB 90.0 89.75 89.5 ... -89.5 -89.75 -90.0
  * longitude   (longitude) float64 12kB -180.0 -179.8 -179.5 ... 179.5 179.8
    expver      (valid_time) &lt;U4 1kB ...
Attributes: (12/32)
    GRIB_paramId:                             167
    GRIB_dataType:                            an
    GRIB_numberOfPoints:                      1038240
    GRIB_typeOfLevel:                         surface
    GRIB_stepUnits:                           1
    GRIB_stepType:                            avgua
    ...                                       ...
    GRIB_totalNumber:                         0
    GRIB_units:                               K
    long_name:                                2 metre temperature
    units:                                    K
    standard_name:                            unknown
    GRIB_surface:                             0.0</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'t2m'</div><ul class='xr-dim-list'><li><span class='xr-has-index'>valid_time</span>: 84</li><li><span class='xr-has-index'>latitude</span>: 721</li><li><span class='xr-has-index'>longitude</span>: 1440</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-77c8e3b5-c5c6-43e8-87a1-8ca929492302' class='xr-array-in' type='checkbox' checked><label for='section-77c8e3b5-c5c6-43e8-87a1-8ca929492302' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>...</span></div><div class='xr-array-data'><pre>[87212160 values with dtype=float32]</pre></div></div></li><li class='xr-section-item'><input id='section-6833ec4c-7c88-4935-b785-269dcfff103a' class='xr-section-summary-in' type='checkbox'  checked><label for='section-6833ec4c-7c88-4935-b785-269dcfff103a' class='xr-section-summary' >Coordinates: <span>(5)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>number</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-b58393f6-a17b-4302-849e-eac4e8994375' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-b58393f6-a17b-4302-849e-eac4e8994375' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-23009095-970d-49ef-aba0-d5b2918e956d' class='xr-var-data-in' type='checkbox'><label for='data-23009095-970d-49ef-aba0-d5b2918e956d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>ensemble member numerical id</dd><dt><span>units :</span></dt><dd>1</dd><dt><span>standard_name :</span></dt><dd>realization</dd></dl></div><div class='xr-var-data'><pre>[1 values with dtype=int64]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>valid_time</span></div><div class='xr-var-dims'>(valid_time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>1940-07-01 ... 2023-07-01</div><input id='attrs-638a48b9-1772-4afd-ac75-3bbe1b8e3ac2' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-638a48b9-1772-4afd-ac75-3bbe1b8e3ac2' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-9a75e2aa-043e-443f-ae40-9e3e5d9f2c81' class='xr-var-data-in' type='checkbox'><label for='data-9a75e2aa-043e-443f-ae40-9e3e5d9f2c81' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>time</dd><dt><span>standard_name :</span></dt><dd>time</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;1940-07-01T00:00:00.000000000&#x27;, &#x27;1941-07-01T00:00:00.000000000&#x27;,
       &#x27;1942-07-01T00:00:00.000000000&#x27;, &#x27;1943-07-01T00:00:00.000000000&#x27;,
       &#x27;1944-07-01T00:00:00.000000000&#x27;, &#x27;1945-07-01T00:00:00.000000000&#x27;,
       &#x27;1946-07-01T00:00:00.000000000&#x27;, &#x27;1947-07-01T00:00:00.000000000&#x27;,
       &#x27;1948-07-01T00:00:00.000000000&#x27;, &#x27;1949-07-01T00:00:00.000000000&#x27;,
       &#x27;1950-07-01T00:00:00.000000000&#x27;, &#x27;1951-07-01T00:00:00.000000000&#x27;,
       &#x27;1952-07-01T00:00:00.000000000&#x27;, &#x27;1953-07-01T00:00:00.000000000&#x27;,
       &#x27;1954-07-01T00:00:00.000000000&#x27;, &#x27;1955-07-01T00:00:00.000000000&#x27;,
       &#x27;1956-07-01T00:00:00.000000000&#x27;, &#x27;1957-07-01T00:00:00.000000000&#x27;,
       &#x27;1958-07-01T00:00:00.000000000&#x27;, &#x27;1959-07-01T00:00:00.000000000&#x27;,
       &#x27;1960-07-01T00:00:00.000000000&#x27;, &#x27;1961-07-01T00:00:00.000000000&#x27;,
       &#x27;1962-07-01T00:00:00.000000000&#x27;, &#x27;1963-07-01T00:00:00.000000000&#x27;,
       &#x27;1964-07-01T00:00:00.000000000&#x27;, &#x27;1965-07-01T00:00:00.000000000&#x27;,
       &#x27;1966-07-01T00:00:00.000000000&#x27;, &#x27;1967-07-01T00:00:00.000000000&#x27;,
       &#x27;1968-07-01T00:00:00.000000000&#x27;, &#x27;1969-07-01T00:00:00.000000000&#x27;,
       &#x27;1970-07-01T00:00:00.000000000&#x27;, &#x27;1971-07-01T00:00:00.000000000&#x27;,
       &#x27;1972-07-01T00:00:00.000000000&#x27;, &#x27;1973-07-01T00:00:00.000000000&#x27;,
       &#x27;1974-07-01T00:00:00.000000000&#x27;, &#x27;1975-07-01T00:00:00.000000000&#x27;,
       &#x27;1976-07-01T00:00:00.000000000&#x27;, &#x27;1977-07-01T00:00:00.000000000&#x27;,
       &#x27;1978-07-01T00:00:00.000000000&#x27;, &#x27;1979-07-01T00:00:00.000000000&#x27;,
       &#x27;1980-07-01T00:00:00.000000000&#x27;, &#x27;1981-07-01T00:00:00.000000000&#x27;,
       &#x27;1982-07-01T00:00:00.000000000&#x27;, &#x27;1983-07-01T00:00:00.000000000&#x27;,
       &#x27;1984-07-01T00:00:00.000000000&#x27;, &#x27;1985-07-01T00:00:00.000000000&#x27;,
       &#x27;1986-07-01T00:00:00.000000000&#x27;, &#x27;1987-07-01T00:00:00.000000000&#x27;,
       &#x27;1988-07-01T00:00:00.000000000&#x27;, &#x27;1989-07-01T00:00:00.000000000&#x27;,
       &#x27;1990-07-01T00:00:00.000000000&#x27;, &#x27;1991-07-01T00:00:00.000000000&#x27;,
       &#x27;1992-07-01T00:00:00.000000000&#x27;, &#x27;1993-07-01T00:00:00.000000000&#x27;,
       &#x27;1994-07-01T00:00:00.000000000&#x27;, &#x27;1995-07-01T00:00:00.000000000&#x27;,
       &#x27;1996-07-01T00:00:00.000000000&#x27;, &#x27;1997-07-01T00:00:00.000000000&#x27;,
       &#x27;1998-07-01T00:00:00.000000000&#x27;, &#x27;1999-07-01T00:00:00.000000000&#x27;,
       &#x27;2000-07-01T00:00:00.000000000&#x27;, &#x27;2001-07-01T00:00:00.000000000&#x27;,
       &#x27;2002-07-01T00:00:00.000000000&#x27;, &#x27;2003-07-01T00:00:00.000000000&#x27;,
       &#x27;2004-07-01T00:00:00.000000000&#x27;, &#x27;2005-07-01T00:00:00.000000000&#x27;,
       &#x27;2006-07-01T00:00:00.000000000&#x27;, &#x27;2007-07-01T00:00:00.000000000&#x27;,
       &#x27;2008-07-01T00:00:00.000000000&#x27;, &#x27;2009-07-01T00:00:00.000000000&#x27;,
       &#x27;2010-07-01T00:00:00.000000000&#x27;, &#x27;2011-07-01T00:00:00.000000000&#x27;,
       &#x27;2012-07-01T00:00:00.000000000&#x27;, &#x27;2013-07-01T00:00:00.000000000&#x27;,
       &#x27;2014-07-01T00:00:00.000000000&#x27;, &#x27;2015-07-01T00:00:00.000000000&#x27;,
       &#x27;2016-07-01T00:00:00.000000000&#x27;, &#x27;2017-07-01T00:00:00.000000000&#x27;,
       &#x27;2018-07-01T00:00:00.000000000&#x27;, &#x27;2019-07-01T00:00:00.000000000&#x27;,
       &#x27;2020-07-01T00:00:00.000000000&#x27;, &#x27;2021-07-01T00:00:00.000000000&#x27;,
       &#x27;2022-07-01T00:00:00.000000000&#x27;, &#x27;2023-07-01T00:00:00.000000000&#x27;],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>latitude</span></div><div class='xr-var-dims'>(latitude)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>90.0 89.75 89.5 ... -89.75 -90.0</div><input id='attrs-288e1ffd-2a3f-42b8-b43d-d99675a2de9d' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-288e1ffd-2a3f-42b8-b43d-d99675a2de9d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-6278a90c-418b-4608-8530-bfc91ede1723' class='xr-var-data-in' type='checkbox'><label for='data-6278a90c-418b-4608-8530-bfc91ede1723' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>long_name :</span></dt><dd>latitude</dd><dt><span>stored_direction :</span></dt><dd>decreasing</dd></dl></div><div class='xr-var-data'><pre>array([ 90.  ,  89.75,  89.5 , ..., -89.5 , -89.75, -90.  ], shape=(721,))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>longitude</span></div><div class='xr-var-dims'>(longitude)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-180.0 -179.8 ... 179.5 179.8</div><input id='attrs-19a7d1ad-d0ab-4b90-a86b-954a88d8c83c' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-19a7d1ad-d0ab-4b90-a86b-954a88d8c83c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-de3cc607-84f8-45ba-9a90-ded38282a4e5' class='xr-var-data-in' type='checkbox'><label for='data-de3cc607-84f8-45ba-9a90-ded38282a4e5' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>long_name :</span></dt><dd>longitude</dd></dl></div><div class='xr-var-data'><pre>array([-180.  , -179.75, -179.5 , ...,  179.25,  179.5 ,  179.75],
      shape=(1440,))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>expver</span></div><div class='xr-var-dims'>(valid_time)</div><div class='xr-var-dtype'>&lt;U4</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-44bffb02-739d-4fef-baa9-d82105af7260' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-44bffb02-739d-4fef-baa9-d82105af7260' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f6dcc28d-a728-4723-a447-0cb577942f5c' class='xr-var-data-in' type='checkbox'><label for='data-f6dcc28d-a728-4723-a447-0cb577942f5c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>[84 values with dtype=&lt;U4]</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-27190e1e-5d04-4594-bd2f-1e3480491daa' class='xr-section-summary-in' type='checkbox'  ><label for='section-27190e1e-5d04-4594-bd2f-1e3480491daa' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>valid_time</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-54b5985e-8182-47f8-899e-2c99c78dd946' class='xr-index-data-in' type='checkbox'/><label for='index-54b5985e-8182-47f8-899e-2c99c78dd946' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;1940-07-01&#x27;, &#x27;1941-07-01&#x27;, &#x27;1942-07-01&#x27;, &#x27;1943-07-01&#x27;,
               &#x27;1944-07-01&#x27;, &#x27;1945-07-01&#x27;, &#x27;1946-07-01&#x27;, &#x27;1947-07-01&#x27;,
               &#x27;1948-07-01&#x27;, &#x27;1949-07-01&#x27;, &#x27;1950-07-01&#x27;, &#x27;1951-07-01&#x27;,
               &#x27;1952-07-01&#x27;, &#x27;1953-07-01&#x27;, &#x27;1954-07-01&#x27;, &#x27;1955-07-01&#x27;,
               &#x27;1956-07-01&#x27;, &#x27;1957-07-01&#x27;, &#x27;1958-07-01&#x27;, &#x27;1959-07-01&#x27;,
               &#x27;1960-07-01&#x27;, &#x27;1961-07-01&#x27;, &#x27;1962-07-01&#x27;, &#x27;1963-07-01&#x27;,
               &#x27;1964-07-01&#x27;, &#x27;1965-07-01&#x27;, &#x27;1966-07-01&#x27;, &#x27;1967-07-01&#x27;,
               &#x27;1968-07-01&#x27;, &#x27;1969-07-01&#x27;, &#x27;1970-07-01&#x27;, &#x27;1971-07-01&#x27;,
               &#x27;1972-07-01&#x27;, &#x27;1973-07-01&#x27;, &#x27;1974-07-01&#x27;, &#x27;1975-07-01&#x27;,
               &#x27;1976-07-01&#x27;, &#x27;1977-07-01&#x27;, &#x27;1978-07-01&#x27;, &#x27;1979-07-01&#x27;,
               &#x27;1980-07-01&#x27;, &#x27;1981-07-01&#x27;, &#x27;1982-07-01&#x27;, &#x27;1983-07-01&#x27;,
               &#x27;1984-07-01&#x27;, &#x27;1985-07-01&#x27;, &#x27;1986-07-01&#x27;, &#x27;1987-07-01&#x27;,
               &#x27;1988-07-01&#x27;, &#x27;1989-07-01&#x27;, &#x27;1990-07-01&#x27;, &#x27;1991-07-01&#x27;,
               &#x27;1992-07-01&#x27;, &#x27;1993-07-01&#x27;, &#x27;1994-07-01&#x27;, &#x27;1995-07-01&#x27;,
               &#x27;1996-07-01&#x27;, &#x27;1997-07-01&#x27;, &#x27;1998-07-01&#x27;, &#x27;1999-07-01&#x27;,
               &#x27;2000-07-01&#x27;, &#x27;2001-07-01&#x27;, &#x27;2002-07-01&#x27;, &#x27;2003-07-01&#x27;,
               &#x27;2004-07-01&#x27;, &#x27;2005-07-01&#x27;, &#x27;2006-07-01&#x27;, &#x27;2007-07-01&#x27;,
               &#x27;2008-07-01&#x27;, &#x27;2009-07-01&#x27;, &#x27;2010-07-01&#x27;, &#x27;2011-07-01&#x27;,
               &#x27;2012-07-01&#x27;, &#x27;2013-07-01&#x27;, &#x27;2014-07-01&#x27;, &#x27;2015-07-01&#x27;,
               &#x27;2016-07-01&#x27;, &#x27;2017-07-01&#x27;, &#x27;2018-07-01&#x27;, &#x27;2019-07-01&#x27;,
               &#x27;2020-07-01&#x27;, &#x27;2021-07-01&#x27;, &#x27;2022-07-01&#x27;, &#x27;2023-07-01&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;valid_time&#x27;, freq=None))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>latitude</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-b9d59d18-dec6-458c-88d4-03489e44b155' class='xr-index-data-in' type='checkbox'/><label for='index-b9d59d18-dec6-458c-88d4-03489e44b155' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([  90.0,  89.75,   89.5,  89.25,   89.0,  88.75,   88.5,  88.25,   88.0,
        87.75,
       ...
       -87.75,  -88.0, -88.25,  -88.5, -88.75,  -89.0, -89.25,  -89.5, -89.75,
        -90.0],
      dtype=&#x27;float64&#x27;, name=&#x27;latitude&#x27;, length=721))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>longitude</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-85d06808-c8b7-42b1-bbc3-c07fff3dcb5e' class='xr-index-data-in' type='checkbox'/><label for='index-85d06808-c8b7-42b1-bbc3-c07fff3dcb5e' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([ -180.0, -179.75,  -179.5, -179.25,  -179.0, -178.75,  -178.5, -178.25,
        -178.0, -177.75,
       ...
         177.5,  177.75,   178.0,  178.25,   178.5,  178.75,   179.0,  179.25,
         179.5,  179.75],
      dtype=&#x27;float64&#x27;, name=&#x27;longitude&#x27;, length=1440))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-f24425ce-0291-421b-b951-c3dc9432e7b3' class='xr-section-summary-in' type='checkbox'  ><label for='section-f24425ce-0291-421b-b951-c3dc9432e7b3' class='xr-section-summary' >Attributes: <span>(32)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>GRIB_paramId :</span></dt><dd>167</dd><dt><span>GRIB_dataType :</span></dt><dd>an</dd><dt><span>GRIB_numberOfPoints :</span></dt><dd>1038240</dd><dt><span>GRIB_typeOfLevel :</span></dt><dd>surface</dd><dt><span>GRIB_stepUnits :</span></dt><dd>1</dd><dt><span>GRIB_stepType :</span></dt><dd>avgua</dd><dt><span>GRIB_gridType :</span></dt><dd>regular_ll</dd><dt><span>GRIB_uvRelativeToGrid :</span></dt><dd>0</dd><dt><span>GRIB_NV :</span></dt><dd>0</dd><dt><span>GRIB_Nx :</span></dt><dd>1440</dd><dt><span>GRIB_Ny :</span></dt><dd>721</dd><dt><span>GRIB_cfName :</span></dt><dd>unknown</dd><dt><span>GRIB_cfVarName :</span></dt><dd>t2m</dd><dt><span>GRIB_gridDefinitionDescription :</span></dt><dd>Latitude/Longitude Grid</dd><dt><span>GRIB_iDirectionIncrementInDegrees :</span></dt><dd>0.25</dd><dt><span>GRIB_iScansNegatively :</span></dt><dd>0</dd><dt><span>GRIB_jDirectionIncrementInDegrees :</span></dt><dd>0.25</dd><dt><span>GRIB_jPointsAreConsecutive :</span></dt><dd>0</dd><dt><span>GRIB_jScansPositively :</span></dt><dd>0</dd><dt><span>GRIB_latitudeOfFirstGridPointInDegrees :</span></dt><dd>90.0</dd><dt><span>GRIB_latitudeOfLastGridPointInDegrees :</span></dt><dd>-90.0</dd><dt><span>GRIB_longitudeOfFirstGridPointInDegrees :</span></dt><dd>-180.0</dd><dt><span>GRIB_longitudeOfLastGridPointInDegrees :</span></dt><dd>179.75</dd><dt><span>GRIB_missingValue :</span></dt><dd>3.4028234663852886e+38</dd><dt><span>GRIB_name :</span></dt><dd>2 metre temperature</dd><dt><span>GRIB_shortName :</span></dt><dd>2t</dd><dt><span>GRIB_totalNumber :</span></dt><dd>0</dd><dt><span>GRIB_units :</span></dt><dd>K</dd><dt><span>long_name :</span></dt><dd>2 metre temperature</dd><dt><span>units :</span></dt><dd>K</dd><dt><span>standard_name :</span></dt><dd>unknown</dd><dt><span>GRIB_surface :</span></dt><dd>0.0</dd></dl></div></li></ul></div></div></div></div>
</div>
<p>From the result of the cell above you can see that now we have a <code class="docutils literal notranslate"><span class="pre">xarray.DataArray</span></code>.</p>
</section>
</section>
<section id="change-temperature-units-from-kelvin-to-celsius">
<h3>Change temperature units from Kelvin to Celsius<a class="headerlink" href="#change-temperature-units-from-kelvin-to-celsius" title="Permalink to this heading">#</a></h3>
<p>Notice that the ERA5 temperature data are in units of <em>Kelvin</em>, the base unit for temperature in the International System of Units (SI). If you want to convert the values from <em>Kelvin</em> to <em>degrees Celsius</em>, you have to subtract 273.15.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Subtract 273.15 to convert to Celsius</span>
<span class="n">da_celsius</span> <span class="o">=</span> <span class="n">da_tmp</span> <span class="o">-</span> <span class="mf">273.15</span>
<span class="c1"># Update the attributes of the DataArray to add Celsius units</span>
<span class="n">da_celsius</span> <span class="o">=</span> <span class="n">da_celsius</span><span class="o">.</span><span class="n">assign_attrs</span><span class="p">(</span><span class="n">da_tmp</span><span class="o">.</span><span class="n">attrs</span><span class="p">)</span>
<span class="n">da_celsius</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;units&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;¬∞C&#39;</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="data-to-be-used">
<h3>Data to be used<a class="headerlink" href="#data-to-be-used" title="Permalink to this heading">#</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">da_celsius</span></code> data array will be used in the rest of the surface temperature exercise. Let‚Äôs check what we have:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">da_celsius</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme="dark"],
html[data-theme="dark"],
body[data-theme="dark"],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1f1f1f;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: inline-block;
  opacity: 0;
  height: 0;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:focus + label {
  border: 2px solid var(--xr-font-color0);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: "‚ñ∫";
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: "‚ñº";
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: "(";
}

.xr-dim-list:after {
  content: ")";
}

.xr-dim-list li:not(:last-child):after {
  content: ",";
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;t2m&#x27; (valid_time: 84, latitude: 721, longitude: 1440)&gt; Size: 349MB
array([[[  0.85317993,   0.85317993,   0.85317993, ...,   0.85317993,
           0.85317993,   0.85317993],
        [  0.8590393 ,   0.8590393 ,   0.8590393 , ...,   0.8590393 ,
           0.8590393 ,   0.8590393 ],
        [  0.85317993,   0.85317993,   0.85317993, ...,   0.85317993,
           0.85317993,   0.85317993],
        ...,
        [-55.322586  , -55.320633  , -55.320633  , ..., -55.326492  ,
         -55.326492  , -55.32454   ],
        [-55.234695  , -55.234695  , -55.232742  , ..., -55.23665   ,
         -55.23665   , -55.234695  ],
        [-54.98079   , -54.98079   , -54.98079   , ..., -54.98079   ,
         -54.98079   , -54.98079   ]],

       [[  0.898468  ,   0.898468  ,   0.898468  , ...,   0.898468  ,
           0.898468  ,   0.898468  ],
        [  0.89456177,   0.89456177,   0.89456177, ...,   0.89456177,
           0.89456177,   0.89456177],
        [  0.8808899 ,   0.8808899 ,   0.8808899 , ...,   0.882843  ,
           0.8808899 ,   0.8808899 ],
...
         -56.495087  , -56.49118   ],
        [-56.72751   , -56.725555  , -56.723602  , ..., -56.733368  ,
         -56.731415  , -56.72946   ],
        [-56.506805  , -56.506805  , -56.506805  , ..., -56.506805  ,
         -56.506805  , -56.506805  ]],

       [[  0.7371521 ,   0.7371521 ,   0.7371521 , ...,   0.7371521 ,
           0.7371521 ,   0.7371521 ],
        [  0.7312927 ,   0.7312927 ,   0.7312927 , ...,   0.7312927 ,
           0.7312927 ,   0.7312927 ],
        [  0.7215271 ,   0.7215271 ,   0.7215271 , ...,   0.7215271 ,
           0.7215271 ,   0.7215271 ],
        ...,
        [-53.130035  , -53.12613   , -53.122223  , ..., -53.1398    ,
         -53.135895  , -53.13199   ],
        [-53.23941   , -53.237457  , -53.235504  , ..., -53.243317  ,
         -53.243317  , -53.241364  ],
        [-53.294098  , -53.294098  , -53.294098  , ..., -53.294098  ,
         -53.294098  , -53.294098  ]]],
      shape=(84, 721, 1440), dtype=float32)
Coordinates:
    number      int64 8B ...
  * valid_time  (valid_time) datetime64[ns] 672B 1940-07-01 ... 2023-07-01
  * latitude    (latitude) float64 6kB 90.0 89.75 89.5 ... -89.5 -89.75 -90.0
  * longitude   (longitude) float64 12kB -180.0 -179.8 -179.5 ... 179.5 179.8
    expver      (valid_time) &lt;U4 1kB ...
Attributes: (12/32)
    GRIB_paramId:                             167
    GRIB_dataType:                            an
    GRIB_numberOfPoints:                      1038240
    GRIB_typeOfLevel:                         surface
    GRIB_stepUnits:                           1
    GRIB_stepType:                            avgua
    ...                                       ...
    GRIB_totalNumber:                         0
    GRIB_units:                               K
    long_name:                                2 metre temperature
    units:                                    ¬∞C
    standard_name:                            unknown
    GRIB_surface:                             0.0</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'t2m'</div><ul class='xr-dim-list'><li><span class='xr-has-index'>valid_time</span>: 84</li><li><span class='xr-has-index'>latitude</span>: 721</li><li><span class='xr-has-index'>longitude</span>: 1440</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-4a275791-aed0-4c03-8ec3-95215fa17105' class='xr-array-in' type='checkbox' checked><label for='section-4a275791-aed0-4c03-8ec3-95215fa17105' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>0.8532 0.8532 0.8532 0.8532 0.8532 ... -53.29 -53.29 -53.29 -53.29</span></div><div class='xr-array-data'><pre>array([[[  0.85317993,   0.85317993,   0.85317993, ...,   0.85317993,
           0.85317993,   0.85317993],
        [  0.8590393 ,   0.8590393 ,   0.8590393 , ...,   0.8590393 ,
           0.8590393 ,   0.8590393 ],
        [  0.85317993,   0.85317993,   0.85317993, ...,   0.85317993,
           0.85317993,   0.85317993],
        ...,
        [-55.322586  , -55.320633  , -55.320633  , ..., -55.326492  ,
         -55.326492  , -55.32454   ],
        [-55.234695  , -55.234695  , -55.232742  , ..., -55.23665   ,
         -55.23665   , -55.234695  ],
        [-54.98079   , -54.98079   , -54.98079   , ..., -54.98079   ,
         -54.98079   , -54.98079   ]],

       [[  0.898468  ,   0.898468  ,   0.898468  , ...,   0.898468  ,
           0.898468  ,   0.898468  ],
        [  0.89456177,   0.89456177,   0.89456177, ...,   0.89456177,
           0.89456177,   0.89456177],
        [  0.8808899 ,   0.8808899 ,   0.8808899 , ...,   0.882843  ,
           0.8808899 ,   0.8808899 ],
...
         -56.495087  , -56.49118   ],
        [-56.72751   , -56.725555  , -56.723602  , ..., -56.733368  ,
         -56.731415  , -56.72946   ],
        [-56.506805  , -56.506805  , -56.506805  , ..., -56.506805  ,
         -56.506805  , -56.506805  ]],

       [[  0.7371521 ,   0.7371521 ,   0.7371521 , ...,   0.7371521 ,
           0.7371521 ,   0.7371521 ],
        [  0.7312927 ,   0.7312927 ,   0.7312927 , ...,   0.7312927 ,
           0.7312927 ,   0.7312927 ],
        [  0.7215271 ,   0.7215271 ,   0.7215271 , ...,   0.7215271 ,
           0.7215271 ,   0.7215271 ],
        ...,
        [-53.130035  , -53.12613   , -53.122223  , ..., -53.1398    ,
         -53.135895  , -53.13199   ],
        [-53.23941   , -53.237457  , -53.235504  , ..., -53.243317  ,
         -53.243317  , -53.241364  ],
        [-53.294098  , -53.294098  , -53.294098  , ..., -53.294098  ,
         -53.294098  , -53.294098  ]]],
      shape=(84, 721, 1440), dtype=float32)</pre></div></div></li><li class='xr-section-item'><input id='section-4b0915f1-7698-46dc-976a-1c2c299f208d' class='xr-section-summary-in' type='checkbox'  checked><label for='section-4b0915f1-7698-46dc-976a-1c2c299f208d' class='xr-section-summary' >Coordinates: <span>(5)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>number</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-4ce2c05e-76a1-4997-86cb-7c1701598151' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-4ce2c05e-76a1-4997-86cb-7c1701598151' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-4a294f4d-62ef-402d-89c6-1fc164b9874f' class='xr-var-data-in' type='checkbox'><label for='data-4a294f4d-62ef-402d-89c6-1fc164b9874f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>ensemble member numerical id</dd><dt><span>units :</span></dt><dd>1</dd><dt><span>standard_name :</span></dt><dd>realization</dd></dl></div><div class='xr-var-data'><pre>[1 values with dtype=int64]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>valid_time</span></div><div class='xr-var-dims'>(valid_time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>1940-07-01 ... 2023-07-01</div><input id='attrs-ecfbc468-1efb-4fe9-8b9c-0003286d5720' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-ecfbc468-1efb-4fe9-8b9c-0003286d5720' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-13659d8d-7f22-4bfa-bf5f-85c6b92a8072' class='xr-var-data-in' type='checkbox'><label for='data-13659d8d-7f22-4bfa-bf5f-85c6b92a8072' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>time</dd><dt><span>standard_name :</span></dt><dd>time</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;1940-07-01T00:00:00.000000000&#x27;, &#x27;1941-07-01T00:00:00.000000000&#x27;,
       &#x27;1942-07-01T00:00:00.000000000&#x27;, &#x27;1943-07-01T00:00:00.000000000&#x27;,
       &#x27;1944-07-01T00:00:00.000000000&#x27;, &#x27;1945-07-01T00:00:00.000000000&#x27;,
       &#x27;1946-07-01T00:00:00.000000000&#x27;, &#x27;1947-07-01T00:00:00.000000000&#x27;,
       &#x27;1948-07-01T00:00:00.000000000&#x27;, &#x27;1949-07-01T00:00:00.000000000&#x27;,
       &#x27;1950-07-01T00:00:00.000000000&#x27;, &#x27;1951-07-01T00:00:00.000000000&#x27;,
       &#x27;1952-07-01T00:00:00.000000000&#x27;, &#x27;1953-07-01T00:00:00.000000000&#x27;,
       &#x27;1954-07-01T00:00:00.000000000&#x27;, &#x27;1955-07-01T00:00:00.000000000&#x27;,
       &#x27;1956-07-01T00:00:00.000000000&#x27;, &#x27;1957-07-01T00:00:00.000000000&#x27;,
       &#x27;1958-07-01T00:00:00.000000000&#x27;, &#x27;1959-07-01T00:00:00.000000000&#x27;,
       &#x27;1960-07-01T00:00:00.000000000&#x27;, &#x27;1961-07-01T00:00:00.000000000&#x27;,
       &#x27;1962-07-01T00:00:00.000000000&#x27;, &#x27;1963-07-01T00:00:00.000000000&#x27;,
       &#x27;1964-07-01T00:00:00.000000000&#x27;, &#x27;1965-07-01T00:00:00.000000000&#x27;,
       &#x27;1966-07-01T00:00:00.000000000&#x27;, &#x27;1967-07-01T00:00:00.000000000&#x27;,
       &#x27;1968-07-01T00:00:00.000000000&#x27;, &#x27;1969-07-01T00:00:00.000000000&#x27;,
       &#x27;1970-07-01T00:00:00.000000000&#x27;, &#x27;1971-07-01T00:00:00.000000000&#x27;,
       &#x27;1972-07-01T00:00:00.000000000&#x27;, &#x27;1973-07-01T00:00:00.000000000&#x27;,
       &#x27;1974-07-01T00:00:00.000000000&#x27;, &#x27;1975-07-01T00:00:00.000000000&#x27;,
       &#x27;1976-07-01T00:00:00.000000000&#x27;, &#x27;1977-07-01T00:00:00.000000000&#x27;,
       &#x27;1978-07-01T00:00:00.000000000&#x27;, &#x27;1979-07-01T00:00:00.000000000&#x27;,
       &#x27;1980-07-01T00:00:00.000000000&#x27;, &#x27;1981-07-01T00:00:00.000000000&#x27;,
       &#x27;1982-07-01T00:00:00.000000000&#x27;, &#x27;1983-07-01T00:00:00.000000000&#x27;,
       &#x27;1984-07-01T00:00:00.000000000&#x27;, &#x27;1985-07-01T00:00:00.000000000&#x27;,
       &#x27;1986-07-01T00:00:00.000000000&#x27;, &#x27;1987-07-01T00:00:00.000000000&#x27;,
       &#x27;1988-07-01T00:00:00.000000000&#x27;, &#x27;1989-07-01T00:00:00.000000000&#x27;,
       &#x27;1990-07-01T00:00:00.000000000&#x27;, &#x27;1991-07-01T00:00:00.000000000&#x27;,
       &#x27;1992-07-01T00:00:00.000000000&#x27;, &#x27;1993-07-01T00:00:00.000000000&#x27;,
       &#x27;1994-07-01T00:00:00.000000000&#x27;, &#x27;1995-07-01T00:00:00.000000000&#x27;,
       &#x27;1996-07-01T00:00:00.000000000&#x27;, &#x27;1997-07-01T00:00:00.000000000&#x27;,
       &#x27;1998-07-01T00:00:00.000000000&#x27;, &#x27;1999-07-01T00:00:00.000000000&#x27;,
       &#x27;2000-07-01T00:00:00.000000000&#x27;, &#x27;2001-07-01T00:00:00.000000000&#x27;,
       &#x27;2002-07-01T00:00:00.000000000&#x27;, &#x27;2003-07-01T00:00:00.000000000&#x27;,
       &#x27;2004-07-01T00:00:00.000000000&#x27;, &#x27;2005-07-01T00:00:00.000000000&#x27;,
       &#x27;2006-07-01T00:00:00.000000000&#x27;, &#x27;2007-07-01T00:00:00.000000000&#x27;,
       &#x27;2008-07-01T00:00:00.000000000&#x27;, &#x27;2009-07-01T00:00:00.000000000&#x27;,
       &#x27;2010-07-01T00:00:00.000000000&#x27;, &#x27;2011-07-01T00:00:00.000000000&#x27;,
       &#x27;2012-07-01T00:00:00.000000000&#x27;, &#x27;2013-07-01T00:00:00.000000000&#x27;,
       &#x27;2014-07-01T00:00:00.000000000&#x27;, &#x27;2015-07-01T00:00:00.000000000&#x27;,
       &#x27;2016-07-01T00:00:00.000000000&#x27;, &#x27;2017-07-01T00:00:00.000000000&#x27;,
       &#x27;2018-07-01T00:00:00.000000000&#x27;, &#x27;2019-07-01T00:00:00.000000000&#x27;,
       &#x27;2020-07-01T00:00:00.000000000&#x27;, &#x27;2021-07-01T00:00:00.000000000&#x27;,
       &#x27;2022-07-01T00:00:00.000000000&#x27;, &#x27;2023-07-01T00:00:00.000000000&#x27;],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>latitude</span></div><div class='xr-var-dims'>(latitude)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>90.0 89.75 89.5 ... -89.75 -90.0</div><input id='attrs-4970c51a-d3f8-416f-9315-10767aed8431' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-4970c51a-d3f8-416f-9315-10767aed8431' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-5f7094d8-7b65-479d-9de3-d7b6a30325e2' class='xr-var-data-in' type='checkbox'><label for='data-5f7094d8-7b65-479d-9de3-d7b6a30325e2' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>long_name :</span></dt><dd>latitude</dd><dt><span>stored_direction :</span></dt><dd>decreasing</dd></dl></div><div class='xr-var-data'><pre>array([ 90.  ,  89.75,  89.5 , ..., -89.5 , -89.75, -90.  ], shape=(721,))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>longitude</span></div><div class='xr-var-dims'>(longitude)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-180.0 -179.8 ... 179.5 179.8</div><input id='attrs-c17e8d59-5c96-4b9f-b163-d3b913b2731e' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-c17e8d59-5c96-4b9f-b163-d3b913b2731e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-0b9d877e-17d0-43cc-a71f-84e948cb7192' class='xr-var-data-in' type='checkbox'><label for='data-0b9d877e-17d0-43cc-a71f-84e948cb7192' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>long_name :</span></dt><dd>longitude</dd></dl></div><div class='xr-var-data'><pre>array([-180.  , -179.75, -179.5 , ...,  179.25,  179.5 ,  179.75],
      shape=(1440,))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>expver</span></div><div class='xr-var-dims'>(valid_time)</div><div class='xr-var-dtype'>&lt;U4</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-f5fabf71-ade3-4b94-96ad-e43dc4261f2d' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-f5fabf71-ade3-4b94-96ad-e43dc4261f2d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-aadcbddb-ce9f-492a-94ef-83c8568085bc' class='xr-var-data-in' type='checkbox'><label for='data-aadcbddb-ce9f-492a-94ef-83c8568085bc' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>[84 values with dtype=&lt;U4]</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-ae54a4e9-1eda-4c93-b5e5-d762e43fe617' class='xr-section-summary-in' type='checkbox'  ><label for='section-ae54a4e9-1eda-4c93-b5e5-d762e43fe617' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>valid_time</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-4b66f22a-8237-4f65-941d-9e35d1081390' class='xr-index-data-in' type='checkbox'/><label for='index-4b66f22a-8237-4f65-941d-9e35d1081390' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;1940-07-01&#x27;, &#x27;1941-07-01&#x27;, &#x27;1942-07-01&#x27;, &#x27;1943-07-01&#x27;,
               &#x27;1944-07-01&#x27;, &#x27;1945-07-01&#x27;, &#x27;1946-07-01&#x27;, &#x27;1947-07-01&#x27;,
               &#x27;1948-07-01&#x27;, &#x27;1949-07-01&#x27;, &#x27;1950-07-01&#x27;, &#x27;1951-07-01&#x27;,
               &#x27;1952-07-01&#x27;, &#x27;1953-07-01&#x27;, &#x27;1954-07-01&#x27;, &#x27;1955-07-01&#x27;,
               &#x27;1956-07-01&#x27;, &#x27;1957-07-01&#x27;, &#x27;1958-07-01&#x27;, &#x27;1959-07-01&#x27;,
               &#x27;1960-07-01&#x27;, &#x27;1961-07-01&#x27;, &#x27;1962-07-01&#x27;, &#x27;1963-07-01&#x27;,
               &#x27;1964-07-01&#x27;, &#x27;1965-07-01&#x27;, &#x27;1966-07-01&#x27;, &#x27;1967-07-01&#x27;,
               &#x27;1968-07-01&#x27;, &#x27;1969-07-01&#x27;, &#x27;1970-07-01&#x27;, &#x27;1971-07-01&#x27;,
               &#x27;1972-07-01&#x27;, &#x27;1973-07-01&#x27;, &#x27;1974-07-01&#x27;, &#x27;1975-07-01&#x27;,
               &#x27;1976-07-01&#x27;, &#x27;1977-07-01&#x27;, &#x27;1978-07-01&#x27;, &#x27;1979-07-01&#x27;,
               &#x27;1980-07-01&#x27;, &#x27;1981-07-01&#x27;, &#x27;1982-07-01&#x27;, &#x27;1983-07-01&#x27;,
               &#x27;1984-07-01&#x27;, &#x27;1985-07-01&#x27;, &#x27;1986-07-01&#x27;, &#x27;1987-07-01&#x27;,
               &#x27;1988-07-01&#x27;, &#x27;1989-07-01&#x27;, &#x27;1990-07-01&#x27;, &#x27;1991-07-01&#x27;,
               &#x27;1992-07-01&#x27;, &#x27;1993-07-01&#x27;, &#x27;1994-07-01&#x27;, &#x27;1995-07-01&#x27;,
               &#x27;1996-07-01&#x27;, &#x27;1997-07-01&#x27;, &#x27;1998-07-01&#x27;, &#x27;1999-07-01&#x27;,
               &#x27;2000-07-01&#x27;, &#x27;2001-07-01&#x27;, &#x27;2002-07-01&#x27;, &#x27;2003-07-01&#x27;,
               &#x27;2004-07-01&#x27;, &#x27;2005-07-01&#x27;, &#x27;2006-07-01&#x27;, &#x27;2007-07-01&#x27;,
               &#x27;2008-07-01&#x27;, &#x27;2009-07-01&#x27;, &#x27;2010-07-01&#x27;, &#x27;2011-07-01&#x27;,
               &#x27;2012-07-01&#x27;, &#x27;2013-07-01&#x27;, &#x27;2014-07-01&#x27;, &#x27;2015-07-01&#x27;,
               &#x27;2016-07-01&#x27;, &#x27;2017-07-01&#x27;, &#x27;2018-07-01&#x27;, &#x27;2019-07-01&#x27;,
               &#x27;2020-07-01&#x27;, &#x27;2021-07-01&#x27;, &#x27;2022-07-01&#x27;, &#x27;2023-07-01&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;valid_time&#x27;, freq=None))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>latitude</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-63206d5e-a112-4a26-9e4a-0c0a5def40f7' class='xr-index-data-in' type='checkbox'/><label for='index-63206d5e-a112-4a26-9e4a-0c0a5def40f7' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([  90.0,  89.75,   89.5,  89.25,   89.0,  88.75,   88.5,  88.25,   88.0,
        87.75,
       ...
       -87.75,  -88.0, -88.25,  -88.5, -88.75,  -89.0, -89.25,  -89.5, -89.75,
        -90.0],
      dtype=&#x27;float64&#x27;, name=&#x27;latitude&#x27;, length=721))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>longitude</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-464c53d0-b86a-472c-9e82-95b098a45e3f' class='xr-index-data-in' type='checkbox'/><label for='index-464c53d0-b86a-472c-9e82-95b098a45e3f' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([ -180.0, -179.75,  -179.5, -179.25,  -179.0, -178.75,  -178.5, -178.25,
        -178.0, -177.75,
       ...
         177.5,  177.75,   178.0,  178.25,   178.5,  178.75,   179.0,  179.25,
         179.5,  179.75],
      dtype=&#x27;float64&#x27;, name=&#x27;longitude&#x27;, length=1440))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-020fe323-da8c-4b2a-bf52-749ac8922461' class='xr-section-summary-in' type='checkbox'  ><label for='section-020fe323-da8c-4b2a-bf52-749ac8922461' class='xr-section-summary' >Attributes: <span>(32)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>GRIB_paramId :</span></dt><dd>167</dd><dt><span>GRIB_dataType :</span></dt><dd>an</dd><dt><span>GRIB_numberOfPoints :</span></dt><dd>1038240</dd><dt><span>GRIB_typeOfLevel :</span></dt><dd>surface</dd><dt><span>GRIB_stepUnits :</span></dt><dd>1</dd><dt><span>GRIB_stepType :</span></dt><dd>avgua</dd><dt><span>GRIB_gridType :</span></dt><dd>regular_ll</dd><dt><span>GRIB_uvRelativeToGrid :</span></dt><dd>0</dd><dt><span>GRIB_NV :</span></dt><dd>0</dd><dt><span>GRIB_Nx :</span></dt><dd>1440</dd><dt><span>GRIB_Ny :</span></dt><dd>721</dd><dt><span>GRIB_cfName :</span></dt><dd>unknown</dd><dt><span>GRIB_cfVarName :</span></dt><dd>t2m</dd><dt><span>GRIB_gridDefinitionDescription :</span></dt><dd>Latitude/Longitude Grid</dd><dt><span>GRIB_iDirectionIncrementInDegrees :</span></dt><dd>0.25</dd><dt><span>GRIB_iScansNegatively :</span></dt><dd>0</dd><dt><span>GRIB_jDirectionIncrementInDegrees :</span></dt><dd>0.25</dd><dt><span>GRIB_jPointsAreConsecutive :</span></dt><dd>0</dd><dt><span>GRIB_jScansPositively :</span></dt><dd>0</dd><dt><span>GRIB_latitudeOfFirstGridPointInDegrees :</span></dt><dd>90.0</dd><dt><span>GRIB_latitudeOfLastGridPointInDegrees :</span></dt><dd>-90.0</dd><dt><span>GRIB_longitudeOfFirstGridPointInDegrees :</span></dt><dd>-180.0</dd><dt><span>GRIB_longitudeOfLastGridPointInDegrees :</span></dt><dd>179.75</dd><dt><span>GRIB_missingValue :</span></dt><dd>3.4028234663852886e+38</dd><dt><span>GRIB_name :</span></dt><dd>2 metre temperature</dd><dt><span>GRIB_shortName :</span></dt><dd>2t</dd><dt><span>GRIB_totalNumber :</span></dt><dd>0</dd><dt><span>GRIB_units :</span></dt><dd>K</dd><dt><span>long_name :</span></dt><dd>2 metre temperature</dd><dt><span>units :</span></dt><dd>¬∞C</dd><dt><span>standard_name :</span></dt><dd>unknown</dd><dt><span>GRIB_surface :</span></dt><dd>0.0</dd></dl></div></li></ul></div></div></div></div>
</div>
<p>Now we can see the updated values in <em>Celsius</em> and the <code class="docutils literal notranslate"><span class="pre">units</span></code> attribute updated accordingly.</p>
</section>
<section id="plotting-one-timestep">
<h3>Plotting one timestep<a class="headerlink" href="#plotting-one-timestep" title="Permalink to this heading">#</a></h3>
<p>Just to check what we have so far, let‚Äôs plot a map of 2m temperature for the first (July 1940) and the last (July 2023) timesteps. We will plot these maps using the convenience method <code class="docutils literal notranslate"><span class="pre">plot</span></code> available for <code class="docutils literal notranslate"><span class="pre">xarray.DataArray</span></code>. This allows the creation of simple plots using one line of code. Also, with the xarray method¬†<code class="docutils literal notranslate"><span class="pre">sel()</span></code>, you can select a data array based on coordinate labels.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">da_celsius</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">valid_time</span><span class="o">=</span><span class="s1">&#39;1940&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.collections.QuadMesh at 0x148623050&gt;
</pre></div>
</div>
<img alt="../../_images/0c66955def6477e282e846abea5f4458edbcae98d5c5c27bd7a710143dc38b53.png" src="../../_images/0c66955def6477e282e846abea5f4458edbcae98d5c5c27bd7a710143dc38b53.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">da_celsius</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">valid_time</span><span class="o">=</span><span class="s1">&#39;2023&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.collections.QuadMesh at 0x15b026900&gt;
</pre></div>
</div>
<img alt="../../_images/780b88152cb0e368d0e7050bc86954ef383cd41f0acb1afe5e321f18df046caa.png" src="../../_images/780b88152cb0e368d0e7050bc86954ef383cd41f0acb1afe5e321f18df046caa.png" />
</div>
</div>
</section>
</section>
<section id="calculate-a-surface-temperature-climatology-reference-period-1991-2020">
<h2>Calculate a surface temperature climatology: reference period 1991-2020<a class="headerlink" href="#calculate-a-surface-temperature-climatology-reference-period-1991-2020" title="Permalink to this heading">#</a></h2>
<section id="standard-reference-periods-and-climatologies">
<h3>Standard reference periods and climatologies<a class="headerlink" href="#standard-reference-periods-and-climatologies" title="Permalink to this heading">#</a></h3>
<p>Anthropogenic activities and natural variations from years to decades shape the Earth‚Äôs climate. In order to evaluate anomalous conditions for a specific month or year, the World Meteorological Organization (WMO) defines <code class="docutils literal notranslate"><span class="pre">standard</span> <span class="pre">reference</span> <span class="pre">periods</span></code> used to create <code class="docutils literal notranslate"><span class="pre">climatologies</span></code>, also known as <code class="docutils literal notranslate"><span class="pre">climate</span> <span class="pre">normals</span></code>. <code class="docutils literal notranslate"><span class="pre">Climatologies</span></code> can be considered as the typical climate for the period they are based on.</p>
<p>Until 2020, the most current and widely used standard reference period was the 30-year range of 1981-2010. With the start of 2021, the WMO recommended updating the climate normal reference period to the range 1991-2020.</p>
<p>First, let us calculate the temperature climatology for July during the reference period 1991-2020. For this, we will select the reference period and then average along the <code class="docutils literal notranslate"><span class="pre">time</span></code> dimension. The resulting object contains the average July mean surface air temperature on each grid point.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t2m_ref_per</span> <span class="o">=</span> <span class="n">da_celsius</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">valid_time</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="s1">&#39;1991-01-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2020-12-31&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;valid_time&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>If we have a look at this data object we will see now we have only two coordinates, <code class="docutils literal notranslate"><span class="pre">latitude</span></code> and <code class="docutils literal notranslate"><span class="pre">longitude</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t2m_ref_per</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme="dark"],
html[data-theme="dark"],
body[data-theme="dark"],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1f1f1f;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: inline-block;
  opacity: 0;
  height: 0;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:focus + label {
  border: 2px solid var(--xr-font-color0);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: "‚ñ∫";
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: "‚ñº";
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: "(";
}

.xr-dim-list:after {
  content: ")";
}

.xr-dim-list li:not(:last-child):after {
  content: ",";
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;t2m&#x27; (latitude: 721, longitude: 1440)&gt; Size: 4MB
array([[  0.7482117 ,   0.7482117 ,   0.7482117 , ...,   0.7482117 ,
          0.7482117 ,   0.7482117 ],
       [  0.7403341 ,   0.7403992 ,   0.74046427, ...,   0.7397481 ,
          0.74000853,   0.74020386],
       [  0.72770387,   0.72783405,   0.7280294 , ...,   0.726532  ,
          0.72692263,   0.7273783 ],
       ...,
       [-55.417484  , -55.414036  , -55.410713  , ..., -55.427708  ,
        -55.42432   , -55.42087   ],
       [-55.408566  , -55.406937  , -55.405376  , ..., -55.413837  ,
        -55.412014  , -55.41039   ],
       [-55.04561   , -55.04561   , -55.04561   , ..., -55.04561   ,
        -55.04561   , -55.04561   ]], shape=(721, 1440), dtype=float32)
Coordinates:
    number     int64 8B ...
  * latitude   (latitude) float64 6kB 90.0 89.75 89.5 ... -89.5 -89.75 -90.0
  * longitude  (longitude) float64 12kB -180.0 -179.8 -179.5 ... 179.5 179.8</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'t2m'</div><ul class='xr-dim-list'><li><span class='xr-has-index'>latitude</span>: 721</li><li><span class='xr-has-index'>longitude</span>: 1440</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-1b01c66c-ab11-4744-b938-a287ef82bc52' class='xr-array-in' type='checkbox' checked><label for='section-1b01c66c-ab11-4744-b938-a287ef82bc52' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>0.7482 0.7482 0.7482 0.7482 0.7482 ... -55.05 -55.05 -55.05 -55.05</span></div><div class='xr-array-data'><pre>array([[  0.7482117 ,   0.7482117 ,   0.7482117 , ...,   0.7482117 ,
          0.7482117 ,   0.7482117 ],
       [  0.7403341 ,   0.7403992 ,   0.74046427, ...,   0.7397481 ,
          0.74000853,   0.74020386],
       [  0.72770387,   0.72783405,   0.7280294 , ...,   0.726532  ,
          0.72692263,   0.7273783 ],
       ...,
       [-55.417484  , -55.414036  , -55.410713  , ..., -55.427708  ,
        -55.42432   , -55.42087   ],
       [-55.408566  , -55.406937  , -55.405376  , ..., -55.413837  ,
        -55.412014  , -55.41039   ],
       [-55.04561   , -55.04561   , -55.04561   , ..., -55.04561   ,
        -55.04561   , -55.04561   ]], shape=(721, 1440), dtype=float32)</pre></div></div></li><li class='xr-section-item'><input id='section-e9307ca4-9b05-4b7e-bbc5-7b10a0c489ef' class='xr-section-summary-in' type='checkbox'  checked><label for='section-e9307ca4-9b05-4b7e-bbc5-7b10a0c489ef' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>number</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-b84c6f33-55ec-42b1-a0d2-f210d32a2f9c' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-b84c6f33-55ec-42b1-a0d2-f210d32a2f9c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-750b857c-2fd8-4f16-845b-37ca9f31e3d8' class='xr-var-data-in' type='checkbox'><label for='data-750b857c-2fd8-4f16-845b-37ca9f31e3d8' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>ensemble member numerical id</dd><dt><span>units :</span></dt><dd>1</dd><dt><span>standard_name :</span></dt><dd>realization</dd></dl></div><div class='xr-var-data'><pre>[1 values with dtype=int64]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>latitude</span></div><div class='xr-var-dims'>(latitude)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>90.0 89.75 89.5 ... -89.75 -90.0</div><input id='attrs-9ba032a4-ea57-482d-8180-cbb3da67d1ec' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-9ba032a4-ea57-482d-8180-cbb3da67d1ec' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-00ae09d9-57f2-4580-9f57-506fa60073ab' class='xr-var-data-in' type='checkbox'><label for='data-00ae09d9-57f2-4580-9f57-506fa60073ab' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>long_name :</span></dt><dd>latitude</dd><dt><span>stored_direction :</span></dt><dd>decreasing</dd></dl></div><div class='xr-var-data'><pre>array([ 90.  ,  89.75,  89.5 , ..., -89.5 , -89.75, -90.  ], shape=(721,))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>longitude</span></div><div class='xr-var-dims'>(longitude)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-180.0 -179.8 ... 179.5 179.8</div><input id='attrs-fa8dc34c-1b48-4b0c-ae9c-1da8f04350e5' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-fa8dc34c-1b48-4b0c-ae9c-1da8f04350e5' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-92474831-d53d-4fbc-a372-9782d9af0c77' class='xr-var-data-in' type='checkbox'><label for='data-92474831-d53d-4fbc-a372-9782d9af0c77' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>long_name :</span></dt><dd>longitude</dd></dl></div><div class='xr-var-data'><pre>array([-180.  , -179.75, -179.5 , ...,  179.25,  179.5 ,  179.75],
      shape=(1440,))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-9519a069-17e0-415a-83fa-e87925a8e971' class='xr-section-summary-in' type='checkbox'  ><label for='section-9519a069-17e0-415a-83fa-e87925a8e971' class='xr-section-summary' >Indexes: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>latitude</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-0515e9b8-77db-414f-9f5b-fdad4592ca79' class='xr-index-data-in' type='checkbox'/><label for='index-0515e9b8-77db-414f-9f5b-fdad4592ca79' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([  90.0,  89.75,   89.5,  89.25,   89.0,  88.75,   88.5,  88.25,   88.0,
        87.75,
       ...
       -87.75,  -88.0, -88.25,  -88.5, -88.75,  -89.0, -89.25,  -89.5, -89.75,
        -90.0],
      dtype=&#x27;float64&#x27;, name=&#x27;latitude&#x27;, length=721))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>longitude</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-95a419bd-6a29-44c2-95f7-10d03305d348' class='xr-index-data-in' type='checkbox'/><label for='index-95a419bd-6a29-44c2-95f7-10d03305d348' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([ -180.0, -179.75,  -179.5, -179.25,  -179.0, -178.75,  -178.5, -178.25,
        -178.0, -177.75,
       ...
         177.5,  177.75,   178.0,  178.25,   178.5,  178.75,   179.0,  179.25,
         179.5,  179.75],
      dtype=&#x27;float64&#x27;, name=&#x27;longitude&#x27;, length=1440))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-835424b4-3db8-4379-8bce-c674d26ff30f' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-835424b4-3db8-4379-8bce-c674d26ff30f' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div></div></div>
</div>
<p>We can also make a quick plot to have an exploratory view of this new <code class="docutils literal notranslate"><span class="pre">xarray.DataArray</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t2m_ref_per</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.collections.QuadMesh at 0x16a0a8680&gt;
</pre></div>
</div>
<img alt="../../_images/c8003d85fa5cc438eb3058a1de64e5800a3f6c60df3a6a4d971b0476d47fe20b.png" src="../../_images/c8003d85fa5cc438eb3058a1de64e5800a3f6c60df3a6a4d971b0476d47fe20b.png" />
</div>
</div>
</section>
</section>
<section id="visualise-surface-temperature-anomalies">
<h2>Visualise surface temperature anomalies<a class="headerlink" href="#visualise-surface-temperature-anomalies" title="Permalink to this heading">#</a></h2>
<p>The next step is now to calculate the anomaly for July 2023 with respect to the climatology (1991-2020). The term anomaly refers to the deviation of a value from the long-term average. Positive or negative anomalies indicate that the average temperatures of a particular month were respectively warmer or cooler than the reference value for the same month.</p>
<p>Let us calculate the temperature anomaly for the year 2023. In a first step, we select the average near-surface temperature values for the year 2023 from the <code class="docutils literal notranslate"><span class="pre">xarray.DataArray</span></code> object <code class="docutils literal notranslate"><span class="pre">da_celsius</span></code>. As commented before, with the xarray method <code class="docutils literal notranslate"><span class="pre">sel()</span></code>, you can select a data array based on coordinate labels. The coordinate label of interest is <code class="docutils literal notranslate"><span class="pre">year='2023'</span></code>. As we are not doing, for instance, an aggregation operation like the mean over a dimension we will have the <code class="docutils literal notranslate"><span class="pre">time</span></code> dimension in the resulting data array. To remove the <code class="docutils literal notranslate"><span class="pre">time</span></code> dimension we can use the <code class="docutils literal notranslate"><span class="pre">squeeze</span></code> method.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t2m_july2023</span> <span class="o">=</span> <span class="n">da_celsius</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">valid_time</span><span class="o">=</span><span class="s1">&#39;2023&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t2m_july2023</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme="dark"],
html[data-theme="dark"],
body[data-theme="dark"],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1f1f1f;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: inline-block;
  opacity: 0;
  height: 0;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:focus + label {
  border: 2px solid var(--xr-font-color0);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: "‚ñ∫";
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: "‚ñº";
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: "(";
}

.xr-dim-list:after {
  content: ")";
}

.xr-dim-list li:not(:last-child):after {
  content: ",";
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;t2m&#x27; (valid_time: 1, latitude: 721, longitude: 1440)&gt; Size: 4MB
array([[[  0.7371521,   0.7371521,   0.7371521, ...,   0.7371521,
           0.7371521,   0.7371521],
        [  0.7312927,   0.7312927,   0.7312927, ...,   0.7312927,
           0.7312927,   0.7312927],
        [  0.7215271,   0.7215271,   0.7215271, ...,   0.7215271,
           0.7215271,   0.7215271],
        ...,
        [-53.130035 , -53.12613  , -53.122223 , ..., -53.1398   ,
         -53.135895 , -53.13199  ],
        [-53.23941  , -53.237457 , -53.235504 , ..., -53.243317 ,
         -53.243317 , -53.241364 ],
        [-53.294098 , -53.294098 , -53.294098 , ..., -53.294098 ,
         -53.294098 , -53.294098 ]]], shape=(1, 721, 1440), dtype=float32)
Coordinates:
    number      int64 8B ...
  * valid_time  (valid_time) datetime64[ns] 8B 2023-07-01
  * latitude    (latitude) float64 6kB 90.0 89.75 89.5 ... -89.5 -89.75 -90.0
  * longitude   (longitude) float64 12kB -180.0 -179.8 -179.5 ... 179.5 179.8
    expver      (valid_time) &lt;U4 16B ...
Attributes: (12/32)
    GRIB_paramId:                             167
    GRIB_dataType:                            an
    GRIB_numberOfPoints:                      1038240
    GRIB_typeOfLevel:                         surface
    GRIB_stepUnits:                           1
    GRIB_stepType:                            avgua
    ...                                       ...
    GRIB_totalNumber:                         0
    GRIB_units:                               K
    long_name:                                2 metre temperature
    units:                                    ¬∞C
    standard_name:                            unknown
    GRIB_surface:                             0.0</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'t2m'</div><ul class='xr-dim-list'><li><span class='xr-has-index'>valid_time</span>: 1</li><li><span class='xr-has-index'>latitude</span>: 721</li><li><span class='xr-has-index'>longitude</span>: 1440</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-d9de8043-0205-4ec6-b064-fb032948aeff' class='xr-array-in' type='checkbox' checked><label for='section-d9de8043-0205-4ec6-b064-fb032948aeff' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>0.7372 0.7372 0.7372 0.7372 0.7372 ... -53.29 -53.29 -53.29 -53.29</span></div><div class='xr-array-data'><pre>array([[[  0.7371521,   0.7371521,   0.7371521, ...,   0.7371521,
           0.7371521,   0.7371521],
        [  0.7312927,   0.7312927,   0.7312927, ...,   0.7312927,
           0.7312927,   0.7312927],
        [  0.7215271,   0.7215271,   0.7215271, ...,   0.7215271,
           0.7215271,   0.7215271],
        ...,
        [-53.130035 , -53.12613  , -53.122223 , ..., -53.1398   ,
         -53.135895 , -53.13199  ],
        [-53.23941  , -53.237457 , -53.235504 , ..., -53.243317 ,
         -53.243317 , -53.241364 ],
        [-53.294098 , -53.294098 , -53.294098 , ..., -53.294098 ,
         -53.294098 , -53.294098 ]]], shape=(1, 721, 1440), dtype=float32)</pre></div></div></li><li class='xr-section-item'><input id='section-e547e47e-b7b0-44c8-ae35-99fef75b8dc1' class='xr-section-summary-in' type='checkbox'  checked><label for='section-e547e47e-b7b0-44c8-ae35-99fef75b8dc1' class='xr-section-summary' >Coordinates: <span>(5)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>number</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-c4a51892-dd12-4b26-97ca-1b1a44ce568d' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-c4a51892-dd12-4b26-97ca-1b1a44ce568d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-92e2fc82-ef5d-4a72-b089-5a1942a113db' class='xr-var-data-in' type='checkbox'><label for='data-92e2fc82-ef5d-4a72-b089-5a1942a113db' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>ensemble member numerical id</dd><dt><span>units :</span></dt><dd>1</dd><dt><span>standard_name :</span></dt><dd>realization</dd></dl></div><div class='xr-var-data'><pre>[1 values with dtype=int64]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>valid_time</span></div><div class='xr-var-dims'>(valid_time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2023-07-01</div><input id='attrs-28a202b3-7656-436a-acb9-e47d0a405b76' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-28a202b3-7656-436a-acb9-e47d0a405b76' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-07fc9f0e-34bf-4f04-ae63-309ca532074a' class='xr-var-data-in' type='checkbox'><label for='data-07fc9f0e-34bf-4f04-ae63-309ca532074a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>time</dd><dt><span>standard_name :</span></dt><dd>time</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;2023-07-01T00:00:00.000000000&#x27;], dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>latitude</span></div><div class='xr-var-dims'>(latitude)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>90.0 89.75 89.5 ... -89.75 -90.0</div><input id='attrs-4d779415-98e1-487e-a3bf-02a24e73945c' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-4d779415-98e1-487e-a3bf-02a24e73945c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-72199090-378b-49d7-b212-7ca54604c47b' class='xr-var-data-in' type='checkbox'><label for='data-72199090-378b-49d7-b212-7ca54604c47b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>long_name :</span></dt><dd>latitude</dd><dt><span>stored_direction :</span></dt><dd>decreasing</dd></dl></div><div class='xr-var-data'><pre>array([ 90.  ,  89.75,  89.5 , ..., -89.5 , -89.75, -90.  ], shape=(721,))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>longitude</span></div><div class='xr-var-dims'>(longitude)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-180.0 -179.8 ... 179.5 179.8</div><input id='attrs-076402aa-6bcf-4fe8-adf2-95c532696ef2' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-076402aa-6bcf-4fe8-adf2-95c532696ef2' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a5f4e1c4-d6c1-4e07-aa8d-26db06803908' class='xr-var-data-in' type='checkbox'><label for='data-a5f4e1c4-d6c1-4e07-aa8d-26db06803908' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>long_name :</span></dt><dd>longitude</dd></dl></div><div class='xr-var-data'><pre>array([-180.  , -179.75, -179.5 , ...,  179.25,  179.5 ,  179.75],
      shape=(1440,))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>expver</span></div><div class='xr-var-dims'>(valid_time)</div><div class='xr-var-dtype'>&lt;U4</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-47aed349-97fd-4032-ac9f-f0baff6085db' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-47aed349-97fd-4032-ac9f-f0baff6085db' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-6e6fc675-b00e-428e-b952-65c744e28b96' class='xr-var-data-in' type='checkbox'><label for='data-6e6fc675-b00e-428e-b952-65c744e28b96' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>[1 values with dtype=&lt;U4]</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-d183fa7a-6f69-41fb-9247-113b30f231de' class='xr-section-summary-in' type='checkbox'  ><label for='section-d183fa7a-6f69-41fb-9247-113b30f231de' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>valid_time</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-c209cb36-a3bc-4f1a-8984-b377cc1d9689' class='xr-index-data-in' type='checkbox'/><label for='index-c209cb36-a3bc-4f1a-8984-b377cc1d9689' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;2023-07-01&#x27;], dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;valid_time&#x27;, freq=None))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>latitude</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-fd9c3e6d-f88e-4632-961b-dbc03ee793d9' class='xr-index-data-in' type='checkbox'/><label for='index-fd9c3e6d-f88e-4632-961b-dbc03ee793d9' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([  90.0,  89.75,   89.5,  89.25,   89.0,  88.75,   88.5,  88.25,   88.0,
        87.75,
       ...
       -87.75,  -88.0, -88.25,  -88.5, -88.75,  -89.0, -89.25,  -89.5, -89.75,
        -90.0],
      dtype=&#x27;float64&#x27;, name=&#x27;latitude&#x27;, length=721))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>longitude</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-ac7fe8b5-785f-4263-9823-ecb2576917f4' class='xr-index-data-in' type='checkbox'/><label for='index-ac7fe8b5-785f-4263-9823-ecb2576917f4' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([ -180.0, -179.75,  -179.5, -179.25,  -179.0, -178.75,  -178.5, -178.25,
        -178.0, -177.75,
       ...
         177.5,  177.75,   178.0,  178.25,   178.5,  178.75,   179.0,  179.25,
         179.5,  179.75],
      dtype=&#x27;float64&#x27;, name=&#x27;longitude&#x27;, length=1440))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-6f0a6b12-9a48-48c5-960e-db9f205beb33' class='xr-section-summary-in' type='checkbox'  ><label for='section-6f0a6b12-9a48-48c5-960e-db9f205beb33' class='xr-section-summary' >Attributes: <span>(32)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>GRIB_paramId :</span></dt><dd>167</dd><dt><span>GRIB_dataType :</span></dt><dd>an</dd><dt><span>GRIB_numberOfPoints :</span></dt><dd>1038240</dd><dt><span>GRIB_typeOfLevel :</span></dt><dd>surface</dd><dt><span>GRIB_stepUnits :</span></dt><dd>1</dd><dt><span>GRIB_stepType :</span></dt><dd>avgua</dd><dt><span>GRIB_gridType :</span></dt><dd>regular_ll</dd><dt><span>GRIB_uvRelativeToGrid :</span></dt><dd>0</dd><dt><span>GRIB_NV :</span></dt><dd>0</dd><dt><span>GRIB_Nx :</span></dt><dd>1440</dd><dt><span>GRIB_Ny :</span></dt><dd>721</dd><dt><span>GRIB_cfName :</span></dt><dd>unknown</dd><dt><span>GRIB_cfVarName :</span></dt><dd>t2m</dd><dt><span>GRIB_gridDefinitionDescription :</span></dt><dd>Latitude/Longitude Grid</dd><dt><span>GRIB_iDirectionIncrementInDegrees :</span></dt><dd>0.25</dd><dt><span>GRIB_iScansNegatively :</span></dt><dd>0</dd><dt><span>GRIB_jDirectionIncrementInDegrees :</span></dt><dd>0.25</dd><dt><span>GRIB_jPointsAreConsecutive :</span></dt><dd>0</dd><dt><span>GRIB_jScansPositively :</span></dt><dd>0</dd><dt><span>GRIB_latitudeOfFirstGridPointInDegrees :</span></dt><dd>90.0</dd><dt><span>GRIB_latitudeOfLastGridPointInDegrees :</span></dt><dd>-90.0</dd><dt><span>GRIB_longitudeOfFirstGridPointInDegrees :</span></dt><dd>-180.0</dd><dt><span>GRIB_longitudeOfLastGridPointInDegrees :</span></dt><dd>179.75</dd><dt><span>GRIB_missingValue :</span></dt><dd>3.4028234663852886e+38</dd><dt><span>GRIB_name :</span></dt><dd>2 metre temperature</dd><dt><span>GRIB_shortName :</span></dt><dd>2t</dd><dt><span>GRIB_totalNumber :</span></dt><dd>0</dd><dt><span>GRIB_units :</span></dt><dd>K</dd><dt><span>long_name :</span></dt><dd>2 metre temperature</dd><dt><span>units :</span></dt><dd>¬∞C</dd><dt><span>standard_name :</span></dt><dd>unknown</dd><dt><span>GRIB_surface :</span></dt><dd>0.0</dd></dl></div></li></ul></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t2m_july2023</span> <span class="o">=</span> <span class="n">t2m_july2023</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="s1">&#39;valid_time&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t2m_july2023</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme="dark"],
html[data-theme="dark"],
body[data-theme="dark"],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1f1f1f;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: inline-block;
  opacity: 0;
  height: 0;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:focus + label {
  border: 2px solid var(--xr-font-color0);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: "‚ñ∫";
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: "‚ñº";
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: "(";
}

.xr-dim-list:after {
  content: ")";
}

.xr-dim-list li:not(:last-child):after {
  content: ",";
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;t2m&#x27; (latitude: 721, longitude: 1440)&gt; Size: 4MB
array([[  0.7371521,   0.7371521,   0.7371521, ...,   0.7371521,
          0.7371521,   0.7371521],
       [  0.7312927,   0.7312927,   0.7312927, ...,   0.7312927,
          0.7312927,   0.7312927],
       [  0.7215271,   0.7215271,   0.7215271, ...,   0.7215271,
          0.7215271,   0.7215271],
       ...,
       [-53.130035 , -53.12613  , -53.122223 , ..., -53.1398   ,
        -53.135895 , -53.13199  ],
       [-53.23941  , -53.237457 , -53.235504 , ..., -53.243317 ,
        -53.243317 , -53.241364 ],
       [-53.294098 , -53.294098 , -53.294098 , ..., -53.294098 ,
        -53.294098 , -53.294098 ]], shape=(721, 1440), dtype=float32)
Coordinates:
    number      int64 8B ...
    valid_time  datetime64[ns] 8B 2023-07-01
  * latitude    (latitude) float64 6kB 90.0 89.75 89.5 ... -89.5 -89.75 -90.0
  * longitude   (longitude) float64 12kB -180.0 -179.8 -179.5 ... 179.5 179.8
    expver      &lt;U4 16B ...
Attributes: (12/32)
    GRIB_paramId:                             167
    GRIB_dataType:                            an
    GRIB_numberOfPoints:                      1038240
    GRIB_typeOfLevel:                         surface
    GRIB_stepUnits:                           1
    GRIB_stepType:                            avgua
    ...                                       ...
    GRIB_totalNumber:                         0
    GRIB_units:                               K
    long_name:                                2 metre temperature
    units:                                    ¬∞C
    standard_name:                            unknown
    GRIB_surface:                             0.0</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'t2m'</div><ul class='xr-dim-list'><li><span class='xr-has-index'>latitude</span>: 721</li><li><span class='xr-has-index'>longitude</span>: 1440</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-c9e24d46-8421-4ed4-87d5-b7685dd9f07e' class='xr-array-in' type='checkbox' checked><label for='section-c9e24d46-8421-4ed4-87d5-b7685dd9f07e' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>0.7372 0.7372 0.7372 0.7372 0.7372 ... -53.29 -53.29 -53.29 -53.29</span></div><div class='xr-array-data'><pre>array([[  0.7371521,   0.7371521,   0.7371521, ...,   0.7371521,
          0.7371521,   0.7371521],
       [  0.7312927,   0.7312927,   0.7312927, ...,   0.7312927,
          0.7312927,   0.7312927],
       [  0.7215271,   0.7215271,   0.7215271, ...,   0.7215271,
          0.7215271,   0.7215271],
       ...,
       [-53.130035 , -53.12613  , -53.122223 , ..., -53.1398   ,
        -53.135895 , -53.13199  ],
       [-53.23941  , -53.237457 , -53.235504 , ..., -53.243317 ,
        -53.243317 , -53.241364 ],
       [-53.294098 , -53.294098 , -53.294098 , ..., -53.294098 ,
        -53.294098 , -53.294098 ]], shape=(721, 1440), dtype=float32)</pre></div></div></li><li class='xr-section-item'><input id='section-3e97f427-cd81-4823-b079-50877a89acfb' class='xr-section-summary-in' type='checkbox'  checked><label for='section-3e97f427-cd81-4823-b079-50877a89acfb' class='xr-section-summary' >Coordinates: <span>(5)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>number</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-d6ef083f-733a-4fc5-ae79-d23ff739db87' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-d6ef083f-733a-4fc5-ae79-d23ff739db87' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-1389f6ac-e4dc-4215-bf72-fb27e8f2b18a' class='xr-var-data-in' type='checkbox'><label for='data-1389f6ac-e4dc-4215-bf72-fb27e8f2b18a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>ensemble member numerical id</dd><dt><span>units :</span></dt><dd>1</dd><dt><span>standard_name :</span></dt><dd>realization</dd></dl></div><div class='xr-var-data'><pre>[1 values with dtype=int64]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>valid_time</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2023-07-01</div><input id='attrs-00dfad7b-15f0-431b-be11-2c1534bfdd38' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-00dfad7b-15f0-431b-be11-2c1534bfdd38' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b7b02b2f-5808-4027-9bda-37597e24e71a' class='xr-var-data-in' type='checkbox'><label for='data-b7b02b2f-5808-4027-9bda-37597e24e71a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>time</dd><dt><span>standard_name :</span></dt><dd>time</dd></dl></div><div class='xr-var-data'><pre>array(&#x27;2023-07-01T00:00:00.000000000&#x27;, dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>latitude</span></div><div class='xr-var-dims'>(latitude)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>90.0 89.75 89.5 ... -89.75 -90.0</div><input id='attrs-1c4b2e73-c38e-4184-87be-0df4f3385219' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-1c4b2e73-c38e-4184-87be-0df4f3385219' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-c4324bf9-20b8-4bbc-a0f9-1e6d93fefb3e' class='xr-var-data-in' type='checkbox'><label for='data-c4324bf9-20b8-4bbc-a0f9-1e6d93fefb3e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>long_name :</span></dt><dd>latitude</dd><dt><span>stored_direction :</span></dt><dd>decreasing</dd></dl></div><div class='xr-var-data'><pre>array([ 90.  ,  89.75,  89.5 , ..., -89.5 , -89.75, -90.  ], shape=(721,))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>longitude</span></div><div class='xr-var-dims'>(longitude)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-180.0 -179.8 ... 179.5 179.8</div><input id='attrs-e6ee44d3-d549-44f7-920a-e18c5b5f4310' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-e6ee44d3-d549-44f7-920a-e18c5b5f4310' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-12640bcb-467c-433b-8e5a-c2182b7b9bbd' class='xr-var-data-in' type='checkbox'><label for='data-12640bcb-467c-433b-8e5a-c2182b7b9bbd' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>long_name :</span></dt><dd>longitude</dd></dl></div><div class='xr-var-data'><pre>array([-180.  , -179.75, -179.5 , ...,  179.25,  179.5 ,  179.75],
      shape=(1440,))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>expver</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>&lt;U4</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-15c031b7-9152-4a7a-a3a9-d62e06585acf' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-15c031b7-9152-4a7a-a3a9-d62e06585acf' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a1930e84-8754-4fd4-bd52-f10b13326ed6' class='xr-var-data-in' type='checkbox'><label for='data-a1930e84-8754-4fd4-bd52-f10b13326ed6' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>[1 values with dtype=&lt;U4]</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-89c544b4-ae0c-4baa-8cc8-1b445bc9fd10' class='xr-section-summary-in' type='checkbox'  ><label for='section-89c544b4-ae0c-4baa-8cc8-1b445bc9fd10' class='xr-section-summary' >Indexes: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>latitude</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-bcef4056-6f9c-407d-8d6f-9d7a6dd9e32c' class='xr-index-data-in' type='checkbox'/><label for='index-bcef4056-6f9c-407d-8d6f-9d7a6dd9e32c' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([  90.0,  89.75,   89.5,  89.25,   89.0,  88.75,   88.5,  88.25,   88.0,
        87.75,
       ...
       -87.75,  -88.0, -88.25,  -88.5, -88.75,  -89.0, -89.25,  -89.5, -89.75,
        -90.0],
      dtype=&#x27;float64&#x27;, name=&#x27;latitude&#x27;, length=721))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>longitude</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-ae91bd83-80a5-4cc0-b078-584820f8e94e' class='xr-index-data-in' type='checkbox'/><label for='index-ae91bd83-80a5-4cc0-b078-584820f8e94e' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([ -180.0, -179.75,  -179.5, -179.25,  -179.0, -178.75,  -178.5, -178.25,
        -178.0, -177.75,
       ...
         177.5,  177.75,   178.0,  178.25,   178.5,  178.75,   179.0,  179.25,
         179.5,  179.75],
      dtype=&#x27;float64&#x27;, name=&#x27;longitude&#x27;, length=1440))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-60c27955-963d-417e-b9f0-6e274257c293' class='xr-section-summary-in' type='checkbox'  ><label for='section-60c27955-963d-417e-b9f0-6e274257c293' class='xr-section-summary' >Attributes: <span>(32)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>GRIB_paramId :</span></dt><dd>167</dd><dt><span>GRIB_dataType :</span></dt><dd>an</dd><dt><span>GRIB_numberOfPoints :</span></dt><dd>1038240</dd><dt><span>GRIB_typeOfLevel :</span></dt><dd>surface</dd><dt><span>GRIB_stepUnits :</span></dt><dd>1</dd><dt><span>GRIB_stepType :</span></dt><dd>avgua</dd><dt><span>GRIB_gridType :</span></dt><dd>regular_ll</dd><dt><span>GRIB_uvRelativeToGrid :</span></dt><dd>0</dd><dt><span>GRIB_NV :</span></dt><dd>0</dd><dt><span>GRIB_Nx :</span></dt><dd>1440</dd><dt><span>GRIB_Ny :</span></dt><dd>721</dd><dt><span>GRIB_cfName :</span></dt><dd>unknown</dd><dt><span>GRIB_cfVarName :</span></dt><dd>t2m</dd><dt><span>GRIB_gridDefinitionDescription :</span></dt><dd>Latitude/Longitude Grid</dd><dt><span>GRIB_iDirectionIncrementInDegrees :</span></dt><dd>0.25</dd><dt><span>GRIB_iScansNegatively :</span></dt><dd>0</dd><dt><span>GRIB_jDirectionIncrementInDegrees :</span></dt><dd>0.25</dd><dt><span>GRIB_jPointsAreConsecutive :</span></dt><dd>0</dd><dt><span>GRIB_jScansPositively :</span></dt><dd>0</dd><dt><span>GRIB_latitudeOfFirstGridPointInDegrees :</span></dt><dd>90.0</dd><dt><span>GRIB_latitudeOfLastGridPointInDegrees :</span></dt><dd>-90.0</dd><dt><span>GRIB_longitudeOfFirstGridPointInDegrees :</span></dt><dd>-180.0</dd><dt><span>GRIB_longitudeOfLastGridPointInDegrees :</span></dt><dd>179.75</dd><dt><span>GRIB_missingValue :</span></dt><dd>3.4028234663852886e+38</dd><dt><span>GRIB_name :</span></dt><dd>2 metre temperature</dd><dt><span>GRIB_shortName :</span></dt><dd>2t</dd><dt><span>GRIB_totalNumber :</span></dt><dd>0</dd><dt><span>GRIB_units :</span></dt><dd>K</dd><dt><span>long_name :</span></dt><dd>2 metre temperature</dd><dt><span>units :</span></dt><dd>¬∞C</dd><dt><span>standard_name :</span></dt><dd>unknown</dd><dt><span>GRIB_surface :</span></dt><dd>0.0</dd></dl></div></li></ul></div></div></div></div>
</div>
<p>The anomaly will be the difference between <code class="docutils literal notranslate"><span class="pre">t2m_july2023</span></code> and <code class="docutils literal notranslate"><span class="pre">t2m_ref_per</span></code>. A positive value means July 2023 is above the expected mean:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">anom</span> <span class="o">=</span> <span class="n">t2m_july2023</span> <span class="o">-</span> <span class="n">t2m_ref_per</span>
</pre></div>
</div>
</div>
</div>
<p>The previous operation results in the anomaly on each longitude and latitude location stored in the <code class="docutils literal notranslate"><span class="pre">anom</span></code> data array. We can plot this in a map to check where the anomaly was positive (July 2023 warmer than the climatology) or negative (July 2023 colder than the climatology). This time we will create the plot using the <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code> and <code class="docutils literal notranslate"><span class="pre">cartopy</span></code> libraries.</p>
<p>The code below is briefly commented in the code cell. The key part is <a class="reference external" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.pcolormesh.html"><code class="docutils literal notranslate"><span class="pre">plt.pcolormesh</span></code></a>, which is used to plot the 2D data array on each (longitude, latitude) grid cell. The colours are defined using the <code class="docutils literal notranslate"><span class="pre">RdBr_r</span></code> colormap in a range between -12 and 12 (¬∫C). This is a <a class="reference external" href="https://matplotlib.org/stable/tutorials/colors/colormaps.html#diverging">diverging colormap</a> that goes from red to blue but in reverse order, this is why it has the <code class="docutils literal notranslate"><span class="pre">_r</span></code> suffix. So, in this specific case, -12 degrees is shown in dark blue, 12 in dark red and 0, equal to the climate normal, in white.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># create the figure panel and the map using the Cartopy PlateCarree projection</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="n">subplot_kw</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;projection&#39;</span><span class="p">:</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">()})</span>

<span class="c1"># Plot the data</span>
<span class="n">im</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span>
    <span class="n">anom</span><span class="o">.</span><span class="n">longitude</span><span class="p">,</span> 
    <span class="n">anom</span><span class="o">.</span><span class="n">latitude</span><span class="p">,</span> 
    <span class="n">anom</span><span class="p">,</span> 
    <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;RdBu_r&#39;</span><span class="p">,</span>
    <span class="n">vmin</span><span class="o">=-</span><span class="mi">12</span><span class="p">,</span> 
    <span class="n">vmax</span><span class="o">=</span><span class="mi">12</span>
<span class="p">)</span> 

<span class="c1"># Set the figure title, add lat/lon grid and coastlines</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Temperature anomaly for July 2023 (with respect to 1991-2020 July mean)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">gridlines</span><span class="p">(</span>
    <span class="n">draw_labels</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
    <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> 
    <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> 
    <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> 
    <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span>
<span class="p">)</span> 
<span class="n">ax</span><span class="o">.</span><span class="n">coastlines</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>

<span class="c1"># Specify the colorbar and set a label for the colorbar</span>
<span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">fraction</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.04</span><span class="p">)</span>
<span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;Temperature anomaly&#39;</span><span class="p">)</span> 

<span class="c1"># Show or save the figure, uncomment the line/s in case of need</span>
<span class="c1">#fig.show() # not needed in a notebook inline context</span>
<span class="c1">#fig.savefig(&#39;near_sfc_t2m_anomaly_july2023.png&#39;) # not needed in a notebook inline context</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/93a63a43bc6af9702ba022a351ffbfe4625166ea753e7056cafe1a07244574e7.png" src="../../_images/93a63a43bc6af9702ba022a351ffbfe4625166ea753e7056cafe1a07244574e7.png" />
</div>
</div>
</section>
<section id="view-time-series-and-analyse-surface-temperature-trends">
<h2>View time series and analyse surface temperature trends<a class="headerlink" href="#view-time-series-and-analyse-surface-temperature-trends" title="Permalink to this heading">#</a></h2>
<p>Now let us view the time series from 1940 to 2023 averaged over the entire region. To do this we need to average <code class="docutils literal notranslate"><span class="pre">da_celsius</span></code> over the latitude and longitude dimensions. A very important consideration however is that the gridded data cells do not all correspond to the same areas. The size covered by each data point on the model grid varies as a function of latitude. We need to take this into account when calculating spatial averages.</p>
<p>One way to do this is to use the cosine of the latitude as a proxy for the varying sizes.</p>
<p>Another way would be to use <a class="reference external" href="https://stackoverflow.com/a/65353505"><strong>cdo</strong> that would take into account the varying cell area</a>. The command to do this is <code class="docutils literal notranslate"><span class="pre">cdo</span> <span class="pre">fldmean</span> <span class="pre">in.nc</span> <span class="pre">out.nc</span></code>.</p>
<p>In order to keep things simple we will stick to the solution using <code class="docutils literal notranslate"><span class="pre">xarray</span></code>.</p>
<p>First we calculate the weights by using the cosine of the latitude (in radians), then we apply these weights to the data array with the xarray method <code class="docutils literal notranslate"><span class="pre">weighted()</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="n">da_celsius</span><span class="o">.</span><span class="n">latitude</span><span class="p">))</span>
<span class="n">weights</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;weights&quot;</span>
<span class="n">da_celsius_weighted</span> <span class="o">=</span> <span class="n">da_celsius</span><span class="o">.</span><span class="n">weighted</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Then we calculate the weighted mean so we will have a time series with the spatially averaged July <code class="docutils literal notranslate"><span class="pre">t2m</span></code> from 1940 to 2023.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t2m_global</span> <span class="o">=</span> <span class="n">da_celsius_weighted</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="s2">&quot;longitude&quot;</span><span class="p">,</span> <span class="s2">&quot;latitude&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>Let‚Äôs look at the new data array:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t2m_global</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme="dark"],
html[data-theme="dark"],
body[data-theme="dark"],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1f1f1f;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: inline-block;
  opacity: 0;
  height: 0;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:focus + label {
  border: 2px solid var(--xr-font-color0);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: "‚ñ∫";
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: "‚ñº";
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: "(";
}

.xr-dim-list:after {
  content: ")";
}

.xr-dim-list li:not(:last-child):after {
  content: ",";
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;t2m&#x27; (valid_time: 84)&gt; Size: 672B
array([15.77944134, 15.68620715, 15.50451569, 15.48716511, 15.69700522,
       15.58132919, 15.65149032, 15.68705624, 15.63438369, 15.67172358,
       15.51662268, 15.56192631, 15.68824825, 15.72781826, 15.49778106,
       15.46653342, 15.4491943 , 15.65261151, 15.74385955, 15.70026759,
       15.65211903, 15.7370714 , 15.68776148, 15.80164802, 15.72590586,
       15.59623776, 15.82068347, 15.70151791, 15.63563469, 15.70298426,
       15.71303478, 15.52586028, 15.81258276, 15.7778222 , 15.52932399,
       15.50037555, 15.57268697, 15.789472  , 15.74125733, 15.73199896,
       16.02019316, 15.98798049, 15.89153454, 15.91304376, 15.69771985,
       15.69392959, 15.78107717, 16.14044935, 16.03236312, 15.99193291,
       16.15157001, 16.18179695, 15.767838  , 15.87908026, 15.95437756,
       16.12509654, 16.02258372, 16.05694355, 16.35076069, 16.02704447,
       15.99123957, 16.20850865, 16.26295181, 16.18176182, 15.95315449,
       16.31432207, 16.23229984, 16.23531856, 16.205525  , 16.36665523,
       16.280928  , 16.37203418, 16.26923834, 16.20393046, 16.29469434,
       16.38262507, 16.58947245, 16.49455379, 16.50727328, 16.62583005,
       16.5542178 , 16.55974187, 16.60631455, 16.95316422])
Coordinates:
    number      int64 8B 0
  * valid_time  (valid_time) datetime64[ns] 672B 1940-07-01 ... 2023-07-01
    expver      (valid_time) &lt;U4 1kB &#x27;0001&#x27; &#x27;0001&#x27; &#x27;0001&#x27; ... &#x27;0001&#x27; &#x27;0001&#x27;</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'t2m'</div><ul class='xr-dim-list'><li><span class='xr-has-index'>valid_time</span>: 84</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-65cba572-962a-41f3-afdc-060e4c179c1d' class='xr-array-in' type='checkbox' checked><label for='section-65cba572-962a-41f3-afdc-060e4c179c1d' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>15.78 15.69 15.5 15.49 15.7 15.58 ... 16.63 16.55 16.56 16.61 16.95</span></div><div class='xr-array-data'><pre>array([15.77944134, 15.68620715, 15.50451569, 15.48716511, 15.69700522,
       15.58132919, 15.65149032, 15.68705624, 15.63438369, 15.67172358,
       15.51662268, 15.56192631, 15.68824825, 15.72781826, 15.49778106,
       15.46653342, 15.4491943 , 15.65261151, 15.74385955, 15.70026759,
       15.65211903, 15.7370714 , 15.68776148, 15.80164802, 15.72590586,
       15.59623776, 15.82068347, 15.70151791, 15.63563469, 15.70298426,
       15.71303478, 15.52586028, 15.81258276, 15.7778222 , 15.52932399,
       15.50037555, 15.57268697, 15.789472  , 15.74125733, 15.73199896,
       16.02019316, 15.98798049, 15.89153454, 15.91304376, 15.69771985,
       15.69392959, 15.78107717, 16.14044935, 16.03236312, 15.99193291,
       16.15157001, 16.18179695, 15.767838  , 15.87908026, 15.95437756,
       16.12509654, 16.02258372, 16.05694355, 16.35076069, 16.02704447,
       15.99123957, 16.20850865, 16.26295181, 16.18176182, 15.95315449,
       16.31432207, 16.23229984, 16.23531856, 16.205525  , 16.36665523,
       16.280928  , 16.37203418, 16.26923834, 16.20393046, 16.29469434,
       16.38262507, 16.58947245, 16.49455379, 16.50727328, 16.62583005,
       16.5542178 , 16.55974187, 16.60631455, 16.95316422])</pre></div></div></li><li class='xr-section-item'><input id='section-aeb27ae3-ad28-4933-b0f5-76ca931920c7' class='xr-section-summary-in' type='checkbox'  checked><label for='section-aeb27ae3-ad28-4933-b0f5-76ca931920c7' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>number</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0</div><input id='attrs-256cc159-ecc9-4932-8a60-dae3f8d7e241' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-256cc159-ecc9-4932-8a60-dae3f8d7e241' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-667d2211-1ce8-437c-8c43-7095bfaad176' class='xr-var-data-in' type='checkbox'><label for='data-667d2211-1ce8-437c-8c43-7095bfaad176' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(0)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>valid_time</span></div><div class='xr-var-dims'>(valid_time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>1940-07-01 ... 2023-07-01</div><input id='attrs-495a2881-eaa4-492a-9bb1-53cda6027a10' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-495a2881-eaa4-492a-9bb1-53cda6027a10' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-c399c96e-b7cd-425c-be3a-8e5908af083a' class='xr-var-data-in' type='checkbox'><label for='data-c399c96e-b7cd-425c-be3a-8e5908af083a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;1940-07-01T00:00:00.000000000&#x27;, &#x27;1941-07-01T00:00:00.000000000&#x27;,
       &#x27;1942-07-01T00:00:00.000000000&#x27;, &#x27;1943-07-01T00:00:00.000000000&#x27;,
       &#x27;1944-07-01T00:00:00.000000000&#x27;, &#x27;1945-07-01T00:00:00.000000000&#x27;,
       &#x27;1946-07-01T00:00:00.000000000&#x27;, &#x27;1947-07-01T00:00:00.000000000&#x27;,
       &#x27;1948-07-01T00:00:00.000000000&#x27;, &#x27;1949-07-01T00:00:00.000000000&#x27;,
       &#x27;1950-07-01T00:00:00.000000000&#x27;, &#x27;1951-07-01T00:00:00.000000000&#x27;,
       &#x27;1952-07-01T00:00:00.000000000&#x27;, &#x27;1953-07-01T00:00:00.000000000&#x27;,
       &#x27;1954-07-01T00:00:00.000000000&#x27;, &#x27;1955-07-01T00:00:00.000000000&#x27;,
       &#x27;1956-07-01T00:00:00.000000000&#x27;, &#x27;1957-07-01T00:00:00.000000000&#x27;,
       &#x27;1958-07-01T00:00:00.000000000&#x27;, &#x27;1959-07-01T00:00:00.000000000&#x27;,
       &#x27;1960-07-01T00:00:00.000000000&#x27;, &#x27;1961-07-01T00:00:00.000000000&#x27;,
       &#x27;1962-07-01T00:00:00.000000000&#x27;, &#x27;1963-07-01T00:00:00.000000000&#x27;,
       &#x27;1964-07-01T00:00:00.000000000&#x27;, &#x27;1965-07-01T00:00:00.000000000&#x27;,
       &#x27;1966-07-01T00:00:00.000000000&#x27;, &#x27;1967-07-01T00:00:00.000000000&#x27;,
       &#x27;1968-07-01T00:00:00.000000000&#x27;, &#x27;1969-07-01T00:00:00.000000000&#x27;,
       &#x27;1970-07-01T00:00:00.000000000&#x27;, &#x27;1971-07-01T00:00:00.000000000&#x27;,
       &#x27;1972-07-01T00:00:00.000000000&#x27;, &#x27;1973-07-01T00:00:00.000000000&#x27;,
       &#x27;1974-07-01T00:00:00.000000000&#x27;, &#x27;1975-07-01T00:00:00.000000000&#x27;,
       &#x27;1976-07-01T00:00:00.000000000&#x27;, &#x27;1977-07-01T00:00:00.000000000&#x27;,
       &#x27;1978-07-01T00:00:00.000000000&#x27;, &#x27;1979-07-01T00:00:00.000000000&#x27;,
       &#x27;1980-07-01T00:00:00.000000000&#x27;, &#x27;1981-07-01T00:00:00.000000000&#x27;,
       &#x27;1982-07-01T00:00:00.000000000&#x27;, &#x27;1983-07-01T00:00:00.000000000&#x27;,
       &#x27;1984-07-01T00:00:00.000000000&#x27;, &#x27;1985-07-01T00:00:00.000000000&#x27;,
       &#x27;1986-07-01T00:00:00.000000000&#x27;, &#x27;1987-07-01T00:00:00.000000000&#x27;,
       &#x27;1988-07-01T00:00:00.000000000&#x27;, &#x27;1989-07-01T00:00:00.000000000&#x27;,
       &#x27;1990-07-01T00:00:00.000000000&#x27;, &#x27;1991-07-01T00:00:00.000000000&#x27;,
       &#x27;1992-07-01T00:00:00.000000000&#x27;, &#x27;1993-07-01T00:00:00.000000000&#x27;,
       &#x27;1994-07-01T00:00:00.000000000&#x27;, &#x27;1995-07-01T00:00:00.000000000&#x27;,
       &#x27;1996-07-01T00:00:00.000000000&#x27;, &#x27;1997-07-01T00:00:00.000000000&#x27;,
       &#x27;1998-07-01T00:00:00.000000000&#x27;, &#x27;1999-07-01T00:00:00.000000000&#x27;,
       &#x27;2000-07-01T00:00:00.000000000&#x27;, &#x27;2001-07-01T00:00:00.000000000&#x27;,
       &#x27;2002-07-01T00:00:00.000000000&#x27;, &#x27;2003-07-01T00:00:00.000000000&#x27;,
       &#x27;2004-07-01T00:00:00.000000000&#x27;, &#x27;2005-07-01T00:00:00.000000000&#x27;,
       &#x27;2006-07-01T00:00:00.000000000&#x27;, &#x27;2007-07-01T00:00:00.000000000&#x27;,
       &#x27;2008-07-01T00:00:00.000000000&#x27;, &#x27;2009-07-01T00:00:00.000000000&#x27;,
       &#x27;2010-07-01T00:00:00.000000000&#x27;, &#x27;2011-07-01T00:00:00.000000000&#x27;,
       &#x27;2012-07-01T00:00:00.000000000&#x27;, &#x27;2013-07-01T00:00:00.000000000&#x27;,
       &#x27;2014-07-01T00:00:00.000000000&#x27;, &#x27;2015-07-01T00:00:00.000000000&#x27;,
       &#x27;2016-07-01T00:00:00.000000000&#x27;, &#x27;2017-07-01T00:00:00.000000000&#x27;,
       &#x27;2018-07-01T00:00:00.000000000&#x27;, &#x27;2019-07-01T00:00:00.000000000&#x27;,
       &#x27;2020-07-01T00:00:00.000000000&#x27;, &#x27;2021-07-01T00:00:00.000000000&#x27;,
       &#x27;2022-07-01T00:00:00.000000000&#x27;, &#x27;2023-07-01T00:00:00.000000000&#x27;],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>expver</span></div><div class='xr-var-dims'>(valid_time)</div><div class='xr-var-dtype'>&lt;U4</div><div class='xr-var-preview xr-preview'>&#x27;0001&#x27; &#x27;0001&#x27; ... &#x27;0001&#x27; &#x27;0001&#x27;</div><input id='attrs-e2ac62c9-4040-4c5f-93f0-a7217a7d0889' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-e2ac62c9-4040-4c5f-93f0-a7217a7d0889' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-12a38859-e089-4839-a50c-2ddd3506b716' class='xr-var-data-in' type='checkbox'><label for='data-12a38859-e089-4839-a50c-2ddd3506b716' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;0001&#x27;, &#x27;0001&#x27;, &#x27;0001&#x27;, &#x27;0001&#x27;, &#x27;0001&#x27;, &#x27;0001&#x27;, &#x27;0001&#x27;, &#x27;0001&#x27;,
       &#x27;0001&#x27;, &#x27;0001&#x27;, &#x27;0001&#x27;, &#x27;0001&#x27;, &#x27;0001&#x27;, &#x27;0001&#x27;, &#x27;0001&#x27;, &#x27;0001&#x27;,
       &#x27;0001&#x27;, &#x27;0001&#x27;, &#x27;0001&#x27;, &#x27;0001&#x27;, &#x27;0001&#x27;, &#x27;0001&#x27;, &#x27;0001&#x27;, &#x27;0001&#x27;,
       &#x27;0001&#x27;, &#x27;0001&#x27;, &#x27;0001&#x27;, &#x27;0001&#x27;, &#x27;0001&#x27;, &#x27;0001&#x27;, &#x27;0001&#x27;, &#x27;0001&#x27;,
       &#x27;0001&#x27;, &#x27;0001&#x27;, &#x27;0001&#x27;, &#x27;0001&#x27;, &#x27;0001&#x27;, &#x27;0001&#x27;, &#x27;0001&#x27;, &#x27;0001&#x27;,
       &#x27;0001&#x27;, &#x27;0001&#x27;, &#x27;0001&#x27;, &#x27;0001&#x27;, &#x27;0001&#x27;, &#x27;0001&#x27;, &#x27;0001&#x27;, &#x27;0001&#x27;,
       &#x27;0001&#x27;, &#x27;0001&#x27;, &#x27;0001&#x27;, &#x27;0001&#x27;, &#x27;0001&#x27;, &#x27;0001&#x27;, &#x27;0001&#x27;, &#x27;0001&#x27;,
       &#x27;0001&#x27;, &#x27;0001&#x27;, &#x27;0001&#x27;, &#x27;0001&#x27;, &#x27;0001&#x27;, &#x27;0001&#x27;, &#x27;0001&#x27;, &#x27;0001&#x27;,
       &#x27;0001&#x27;, &#x27;0001&#x27;, &#x27;0001&#x27;, &#x27;0001&#x27;, &#x27;0001&#x27;, &#x27;0001&#x27;, &#x27;0001&#x27;, &#x27;0001&#x27;,
       &#x27;0001&#x27;, &#x27;0001&#x27;, &#x27;0001&#x27;, &#x27;0001&#x27;, &#x27;0001&#x27;, &#x27;0001&#x27;, &#x27;0001&#x27;, &#x27;0001&#x27;,
       &#x27;0001&#x27;, &#x27;0001&#x27;, &#x27;0001&#x27;, &#x27;0001&#x27;], dtype=&#x27;&lt;U4&#x27;)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-fbec20ee-4f5d-426a-97f3-916d27543123' class='xr-section-summary-in' type='checkbox'  ><label for='section-fbec20ee-4f5d-426a-97f3-916d27543123' class='xr-section-summary' >Indexes: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>valid_time</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-21f3e923-2c66-42bc-af26-9c90ec8e653d' class='xr-index-data-in' type='checkbox'/><label for='index-21f3e923-2c66-42bc-af26-9c90ec8e653d' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;1940-07-01&#x27;, &#x27;1941-07-01&#x27;, &#x27;1942-07-01&#x27;, &#x27;1943-07-01&#x27;,
               &#x27;1944-07-01&#x27;, &#x27;1945-07-01&#x27;, &#x27;1946-07-01&#x27;, &#x27;1947-07-01&#x27;,
               &#x27;1948-07-01&#x27;, &#x27;1949-07-01&#x27;, &#x27;1950-07-01&#x27;, &#x27;1951-07-01&#x27;,
               &#x27;1952-07-01&#x27;, &#x27;1953-07-01&#x27;, &#x27;1954-07-01&#x27;, &#x27;1955-07-01&#x27;,
               &#x27;1956-07-01&#x27;, &#x27;1957-07-01&#x27;, &#x27;1958-07-01&#x27;, &#x27;1959-07-01&#x27;,
               &#x27;1960-07-01&#x27;, &#x27;1961-07-01&#x27;, &#x27;1962-07-01&#x27;, &#x27;1963-07-01&#x27;,
               &#x27;1964-07-01&#x27;, &#x27;1965-07-01&#x27;, &#x27;1966-07-01&#x27;, &#x27;1967-07-01&#x27;,
               &#x27;1968-07-01&#x27;, &#x27;1969-07-01&#x27;, &#x27;1970-07-01&#x27;, &#x27;1971-07-01&#x27;,
               &#x27;1972-07-01&#x27;, &#x27;1973-07-01&#x27;, &#x27;1974-07-01&#x27;, &#x27;1975-07-01&#x27;,
               &#x27;1976-07-01&#x27;, &#x27;1977-07-01&#x27;, &#x27;1978-07-01&#x27;, &#x27;1979-07-01&#x27;,
               &#x27;1980-07-01&#x27;, &#x27;1981-07-01&#x27;, &#x27;1982-07-01&#x27;, &#x27;1983-07-01&#x27;,
               &#x27;1984-07-01&#x27;, &#x27;1985-07-01&#x27;, &#x27;1986-07-01&#x27;, &#x27;1987-07-01&#x27;,
               &#x27;1988-07-01&#x27;, &#x27;1989-07-01&#x27;, &#x27;1990-07-01&#x27;, &#x27;1991-07-01&#x27;,
               &#x27;1992-07-01&#x27;, &#x27;1993-07-01&#x27;, &#x27;1994-07-01&#x27;, &#x27;1995-07-01&#x27;,
               &#x27;1996-07-01&#x27;, &#x27;1997-07-01&#x27;, &#x27;1998-07-01&#x27;, &#x27;1999-07-01&#x27;,
               &#x27;2000-07-01&#x27;, &#x27;2001-07-01&#x27;, &#x27;2002-07-01&#x27;, &#x27;2003-07-01&#x27;,
               &#x27;2004-07-01&#x27;, &#x27;2005-07-01&#x27;, &#x27;2006-07-01&#x27;, &#x27;2007-07-01&#x27;,
               &#x27;2008-07-01&#x27;, &#x27;2009-07-01&#x27;, &#x27;2010-07-01&#x27;, &#x27;2011-07-01&#x27;,
               &#x27;2012-07-01&#x27;, &#x27;2013-07-01&#x27;, &#x27;2014-07-01&#x27;, &#x27;2015-07-01&#x27;,
               &#x27;2016-07-01&#x27;, &#x27;2017-07-01&#x27;, &#x27;2018-07-01&#x27;, &#x27;2019-07-01&#x27;,
               &#x27;2020-07-01&#x27;, &#x27;2021-07-01&#x27;, &#x27;2022-07-01&#x27;, &#x27;2023-07-01&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;valid_time&#x27;, freq=None))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-339df63e-b64a-433f-859c-6f119a3bd055' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-339df63e-b64a-433f-859c-6f119a3bd055' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div></div></div>
</div>
<p>We will calculate the climatology for this global spatially averaged July <code class="docutils literal notranslate"><span class="pre">t2m</span></code>. This value will be used later to check which years have global average 2m temperature above or below the climatology.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t2m_global_ref_per</span> <span class="o">=</span> <span class="n">t2m_global</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">valid_time</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="s1">&#39;1991-01-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2020-12-31&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;valid_time&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">t2m_global_ref_per</span><span class="o">.</span><span class="n">values</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1"> </span><span class="se">\N{DEGREE SIGN}</span><span class="s1">C&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>16.23 ¬∞C
</pre></div>
</div>
</div>
</div>
<p>We will create a constant array with the climatology value that has the same length as the time series:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t2m_clim</span> <span class="o">=</span> <span class="n">t2m_global_ref_per</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">values</span>
</pre></div>
</div>
</div>
</div>
<p>Let‚Äôs plot the mean value since 1940. The values below the climatology will be highlighted in light blue while the values above the climatology will be highlighted in red. Code is commented in the code cell below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># create the figure panel and the axes</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="c1"># we use the xarray plot method passing the axes we want to use</span>
<span class="c1"># to plot the global time series from 1940 to 2023</span>
<span class="n">t2m_global</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>

<span class="c1"># we use the t2m_clim variable to plot a horizontal line</span>
<span class="c1"># with the global climate normal value (1991-2020)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">t2m_clim</span><span class="p">,</span> <span class="n">xmin</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">=</span> <span class="mf">0.95</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>

<span class="c1"># In order to highlight years above or below the global climate value</span>
<span class="c1"># we use two times the fill_between method that fills the area between two lines</span>
<span class="c1"># The first one is for values below the global climate normal in &#39;mediumslateblue&#39; color</span>
<span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span>
    <span class="n">t2m_global</span><span class="o">.</span><span class="n">valid_time</span><span class="p">,</span> 
    <span class="n">t2m_global</span><span class="p">,</span> 
    <span class="n">t2m_clim</span><span class="p">,</span> 
    <span class="n">where</span><span class="o">=</span><span class="p">(</span><span class="n">t2m_global</span> <span class="o">&lt;</span> <span class="n">t2m_clim</span><span class="p">),</span> 
    <span class="n">color</span><span class="o">=</span><span class="s1">&#39;mediumslateblue&#39;</span><span class="p">,</span> 
    <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span>
    <span class="n">interpolate</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
<span class="c1"># The second one is for values above the global climate normal in &#39;tomato&#39; color</span>
<span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span>
    <span class="n">t2m_global</span><span class="o">.</span><span class="n">valid_time</span><span class="p">,</span> 
    <span class="n">t2m_global</span><span class="p">,</span> 
    <span class="n">t2m_clim</span><span class="p">,</span> 
    <span class="n">where</span><span class="o">=</span><span class="p">(</span><span class="n">t2m_global</span> <span class="o">&gt;</span> <span class="n">t2m_clim</span><span class="p">),</span> 
    <span class="n">color</span><span class="o">=</span><span class="s1">&#39;tomato&#39;</span><span class="p">,</span> 
    <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span>
    <span class="n">interpolate</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>

<span class="c1"># Show or save the figure, uncomment the line/s in case of need</span>
<span class="c1">#fig.show() # not needed in a notebook inline context</span>
<span class="c1">#fig.savefig(&#39;near_sfc_t2m_global_avg_july.png&#39;) # not needed in a notebook inline context</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.collections.FillBetweenPolyCollection at 0x16c0f5820&gt;
</pre></div>
</div>
<img alt="../../_images/9cacaa5dbcdcda87f4f8cb48f6a0cdfee5291ef682b4cb9dd3141d67f1a349bd.png" src="../../_images/9cacaa5dbcdcda87f4f8cb48f6a0cdfee5291ef682b4cb9dd3141d67f1a349bd.png" />
</div>
</div>
<p>Could you try a similar figure but using the anomalies (<em>‚Äúmonthly value‚Äù - ‚Äú1991-2020 climatological value‚Äù</em>) instead of the spatially aggregated average monthly values?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Your code here</span>
</pre></div>
</div>
</div>
</div>
<p>Now let‚Äôs order the months from colder to warmer.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t2m_global_sorted</span> <span class="o">=</span> <span class="n">t2m_global</span><span class="o">.</span><span class="n">sortby</span><span class="p">(</span><span class="n">t2m_global</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Let‚Äôs have a look to the result and check if it is sorted.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t2m_global_sorted</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme="dark"],
html[data-theme="dark"],
body[data-theme="dark"],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1f1f1f;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: inline-block;
  opacity: 0;
  height: 0;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:focus + label {
  border: 2px solid var(--xr-font-color0);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: "‚ñ∫";
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: "‚ñº";
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: "(";
}

.xr-dim-list:after {
  content: ")";
}

.xr-dim-list li:not(:last-child):after {
  content: ",";
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;t2m&#x27; (valid_time: 84)&gt; Size: 672B
array([15.4491943 , 15.46653342, 15.48716511, 15.49778106, 15.50037555,
       15.50451569, 15.51662268, 15.52586028, 15.52932399, 15.56192631,
       15.57268697, 15.58132919, 15.59623776, 15.63438369, 15.63563469,
       15.65149032, 15.65211903, 15.65261151, 15.67172358, 15.68620715,
       15.68705624, 15.68776148, 15.68824825, 15.69392959, 15.69700522,
       15.69771985, 15.70026759, 15.70151791, 15.70298426, 15.71303478,
       15.72590586, 15.72781826, 15.73199896, 15.7370714 , 15.74125733,
       15.74385955, 15.767838  , 15.7778222 , 15.77944134, 15.78107717,
       15.789472  , 15.80164802, 15.81258276, 15.82068347, 15.87908026,
       15.89153454, 15.91304376, 15.95315449, 15.95437756, 15.98798049,
       15.99123957, 15.99193291, 16.02019316, 16.02258372, 16.02704447,
       16.03236312, 16.05694355, 16.12509654, 16.14044935, 16.15157001,
       16.18176182, 16.18179695, 16.20393046, 16.205525  , 16.20850865,
       16.23229984, 16.23531856, 16.26295181, 16.26923834, 16.280928  ,
       16.29469434, 16.31432207, 16.35076069, 16.36665523, 16.37203418,
       16.38262507, 16.49455379, 16.50727328, 16.5542178 , 16.55974187,
       16.58947245, 16.60631455, 16.62583005, 16.95316422])
Coordinates:
    number      int64 8B 0
  * valid_time  (valid_time) datetime64[ns] 672B 1956-07-01 ... 2023-07-01
    expver      (valid_time) &lt;U4 1kB &#x27;0001&#x27; &#x27;0001&#x27; &#x27;0001&#x27; ... &#x27;0001&#x27; &#x27;0001&#x27;</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'t2m'</div><ul class='xr-dim-list'><li><span class='xr-has-index'>valid_time</span>: 84</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-c03d5cdb-5068-4a55-8a75-ce9bdd66ca3e' class='xr-array-in' type='checkbox' checked><label for='section-c03d5cdb-5068-4a55-8a75-ce9bdd66ca3e' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>15.45 15.47 15.49 15.5 15.5 15.5 ... 16.56 16.59 16.61 16.63 16.95</span></div><div class='xr-array-data'><pre>array([15.4491943 , 15.46653342, 15.48716511, 15.49778106, 15.50037555,
       15.50451569, 15.51662268, 15.52586028, 15.52932399, 15.56192631,
       15.57268697, 15.58132919, 15.59623776, 15.63438369, 15.63563469,
       15.65149032, 15.65211903, 15.65261151, 15.67172358, 15.68620715,
       15.68705624, 15.68776148, 15.68824825, 15.69392959, 15.69700522,
       15.69771985, 15.70026759, 15.70151791, 15.70298426, 15.71303478,
       15.72590586, 15.72781826, 15.73199896, 15.7370714 , 15.74125733,
       15.74385955, 15.767838  , 15.7778222 , 15.77944134, 15.78107717,
       15.789472  , 15.80164802, 15.81258276, 15.82068347, 15.87908026,
       15.89153454, 15.91304376, 15.95315449, 15.95437756, 15.98798049,
       15.99123957, 15.99193291, 16.02019316, 16.02258372, 16.02704447,
       16.03236312, 16.05694355, 16.12509654, 16.14044935, 16.15157001,
       16.18176182, 16.18179695, 16.20393046, 16.205525  , 16.20850865,
       16.23229984, 16.23531856, 16.26295181, 16.26923834, 16.280928  ,
       16.29469434, 16.31432207, 16.35076069, 16.36665523, 16.37203418,
       16.38262507, 16.49455379, 16.50727328, 16.5542178 , 16.55974187,
       16.58947245, 16.60631455, 16.62583005, 16.95316422])</pre></div></div></li><li class='xr-section-item'><input id='section-49f7e569-6bb9-4719-aa84-b9259e9ebf05' class='xr-section-summary-in' type='checkbox'  checked><label for='section-49f7e569-6bb9-4719-aa84-b9259e9ebf05' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>number</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0</div><input id='attrs-96d209eb-3c6b-4d35-aed1-cb8c6005e61c' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-96d209eb-3c6b-4d35-aed1-cb8c6005e61c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b62daeec-64a5-4967-9e98-3c55426e5af8' class='xr-var-data-in' type='checkbox'><label for='data-b62daeec-64a5-4967-9e98-3c55426e5af8' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(0)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>valid_time</span></div><div class='xr-var-dims'>(valid_time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>1956-07-01 ... 2023-07-01</div><input id='attrs-6cd0b003-93e3-46ed-870a-392a51906fca' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-6cd0b003-93e3-46ed-870a-392a51906fca' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-1315125f-7ec5-4c1e-9d4c-0cecedc9754f' class='xr-var-data-in' type='checkbox'><label for='data-1315125f-7ec5-4c1e-9d4c-0cecedc9754f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;1956-07-01T00:00:00.000000000&#x27;, &#x27;1955-07-01T00:00:00.000000000&#x27;,
       &#x27;1943-07-01T00:00:00.000000000&#x27;, &#x27;1954-07-01T00:00:00.000000000&#x27;,
       &#x27;1975-07-01T00:00:00.000000000&#x27;, &#x27;1942-07-01T00:00:00.000000000&#x27;,
       &#x27;1950-07-01T00:00:00.000000000&#x27;, &#x27;1971-07-01T00:00:00.000000000&#x27;,
       &#x27;1974-07-01T00:00:00.000000000&#x27;, &#x27;1951-07-01T00:00:00.000000000&#x27;,
       &#x27;1976-07-01T00:00:00.000000000&#x27;, &#x27;1945-07-01T00:00:00.000000000&#x27;,
       &#x27;1965-07-01T00:00:00.000000000&#x27;, &#x27;1948-07-01T00:00:00.000000000&#x27;,
       &#x27;1968-07-01T00:00:00.000000000&#x27;, &#x27;1946-07-01T00:00:00.000000000&#x27;,
       &#x27;1960-07-01T00:00:00.000000000&#x27;, &#x27;1957-07-01T00:00:00.000000000&#x27;,
       &#x27;1949-07-01T00:00:00.000000000&#x27;, &#x27;1941-07-01T00:00:00.000000000&#x27;,
       &#x27;1947-07-01T00:00:00.000000000&#x27;, &#x27;1962-07-01T00:00:00.000000000&#x27;,
       &#x27;1952-07-01T00:00:00.000000000&#x27;, &#x27;1985-07-01T00:00:00.000000000&#x27;,
       &#x27;1944-07-01T00:00:00.000000000&#x27;, &#x27;1984-07-01T00:00:00.000000000&#x27;,
       &#x27;1959-07-01T00:00:00.000000000&#x27;, &#x27;1967-07-01T00:00:00.000000000&#x27;,
       &#x27;1969-07-01T00:00:00.000000000&#x27;, &#x27;1970-07-01T00:00:00.000000000&#x27;,
       &#x27;1964-07-01T00:00:00.000000000&#x27;, &#x27;1953-07-01T00:00:00.000000000&#x27;,
       &#x27;1979-07-01T00:00:00.000000000&#x27;, &#x27;1961-07-01T00:00:00.000000000&#x27;,
       &#x27;1978-07-01T00:00:00.000000000&#x27;, &#x27;1958-07-01T00:00:00.000000000&#x27;,
       &#x27;1992-07-01T00:00:00.000000000&#x27;, &#x27;1973-07-01T00:00:00.000000000&#x27;,
       &#x27;1940-07-01T00:00:00.000000000&#x27;, &#x27;1986-07-01T00:00:00.000000000&#x27;,
       &#x27;1977-07-01T00:00:00.000000000&#x27;, &#x27;1963-07-01T00:00:00.000000000&#x27;,
       &#x27;1972-07-01T00:00:00.000000000&#x27;, &#x27;1966-07-01T00:00:00.000000000&#x27;,
       &#x27;1993-07-01T00:00:00.000000000&#x27;, &#x27;1982-07-01T00:00:00.000000000&#x27;,
       &#x27;1983-07-01T00:00:00.000000000&#x27;, &#x27;2004-07-01T00:00:00.000000000&#x27;,
       &#x27;1994-07-01T00:00:00.000000000&#x27;, &#x27;1981-07-01T00:00:00.000000000&#x27;,
       &#x27;2000-07-01T00:00:00.000000000&#x27;, &#x27;1989-07-01T00:00:00.000000000&#x27;,
       &#x27;1980-07-01T00:00:00.000000000&#x27;, &#x27;1996-07-01T00:00:00.000000000&#x27;,
       &#x27;1999-07-01T00:00:00.000000000&#x27;, &#x27;1988-07-01T00:00:00.000000000&#x27;,
       &#x27;1997-07-01T00:00:00.000000000&#x27;, &#x27;1995-07-01T00:00:00.000000000&#x27;,
       &#x27;1987-07-01T00:00:00.000000000&#x27;, &#x27;1990-07-01T00:00:00.000000000&#x27;,
       &#x27;2003-07-01T00:00:00.000000000&#x27;, &#x27;1991-07-01T00:00:00.000000000&#x27;,
       &#x27;2013-07-01T00:00:00.000000000&#x27;, &#x27;2008-07-01T00:00:00.000000000&#x27;,
       &#x27;2001-07-01T00:00:00.000000000&#x27;, &#x27;2006-07-01T00:00:00.000000000&#x27;,
       &#x27;2007-07-01T00:00:00.000000000&#x27;, &#x27;2002-07-01T00:00:00.000000000&#x27;,
       &#x27;2012-07-01T00:00:00.000000000&#x27;, &#x27;2010-07-01T00:00:00.000000000&#x27;,
       &#x27;2014-07-01T00:00:00.000000000&#x27;, &#x27;2005-07-01T00:00:00.000000000&#x27;,
       &#x27;1998-07-01T00:00:00.000000000&#x27;, &#x27;2009-07-01T00:00:00.000000000&#x27;,
       &#x27;2011-07-01T00:00:00.000000000&#x27;, &#x27;2015-07-01T00:00:00.000000000&#x27;,
       &#x27;2017-07-01T00:00:00.000000000&#x27;, &#x27;2018-07-01T00:00:00.000000000&#x27;,
       &#x27;2020-07-01T00:00:00.000000000&#x27;, &#x27;2021-07-01T00:00:00.000000000&#x27;,
       &#x27;2016-07-01T00:00:00.000000000&#x27;, &#x27;2022-07-01T00:00:00.000000000&#x27;,
       &#x27;2019-07-01T00:00:00.000000000&#x27;, &#x27;2023-07-01T00:00:00.000000000&#x27;],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>expver</span></div><div class='xr-var-dims'>(valid_time)</div><div class='xr-var-dtype'>&lt;U4</div><div class='xr-var-preview xr-preview'>&#x27;0001&#x27; &#x27;0001&#x27; ... &#x27;0001&#x27; &#x27;0001&#x27;</div><input id='attrs-21e56b51-9f98-441f-9fc8-16a38224383e' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-21e56b51-9f98-441f-9fc8-16a38224383e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-6d5c0bac-dbc5-4c84-b9cd-6c41c9d5f371' class='xr-var-data-in' type='checkbox'><label for='data-6d5c0bac-dbc5-4c84-b9cd-6c41c9d5f371' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;0001&#x27;, &#x27;0001&#x27;, &#x27;0001&#x27;, &#x27;0001&#x27;, &#x27;0001&#x27;, &#x27;0001&#x27;, &#x27;0001&#x27;, &#x27;0001&#x27;,
       &#x27;0001&#x27;, &#x27;0001&#x27;, &#x27;0001&#x27;, &#x27;0001&#x27;, &#x27;0001&#x27;, &#x27;0001&#x27;, &#x27;0001&#x27;, &#x27;0001&#x27;,
       &#x27;0001&#x27;, &#x27;0001&#x27;, &#x27;0001&#x27;, &#x27;0001&#x27;, &#x27;0001&#x27;, &#x27;0001&#x27;, &#x27;0001&#x27;, &#x27;0001&#x27;,
       &#x27;0001&#x27;, &#x27;0001&#x27;, &#x27;0001&#x27;, &#x27;0001&#x27;, &#x27;0001&#x27;, &#x27;0001&#x27;, &#x27;0001&#x27;, &#x27;0001&#x27;,
       &#x27;0001&#x27;, &#x27;0001&#x27;, &#x27;0001&#x27;, &#x27;0001&#x27;, &#x27;0001&#x27;, &#x27;0001&#x27;, &#x27;0001&#x27;, &#x27;0001&#x27;,
       &#x27;0001&#x27;, &#x27;0001&#x27;, &#x27;0001&#x27;, &#x27;0001&#x27;, &#x27;0001&#x27;, &#x27;0001&#x27;, &#x27;0001&#x27;, &#x27;0001&#x27;,
       &#x27;0001&#x27;, &#x27;0001&#x27;, &#x27;0001&#x27;, &#x27;0001&#x27;, &#x27;0001&#x27;, &#x27;0001&#x27;, &#x27;0001&#x27;, &#x27;0001&#x27;,
       &#x27;0001&#x27;, &#x27;0001&#x27;, &#x27;0001&#x27;, &#x27;0001&#x27;, &#x27;0001&#x27;, &#x27;0001&#x27;, &#x27;0001&#x27;, &#x27;0001&#x27;,
       &#x27;0001&#x27;, &#x27;0001&#x27;, &#x27;0001&#x27;, &#x27;0001&#x27;, &#x27;0001&#x27;, &#x27;0001&#x27;, &#x27;0001&#x27;, &#x27;0001&#x27;,
       &#x27;0001&#x27;, &#x27;0001&#x27;, &#x27;0001&#x27;, &#x27;0001&#x27;, &#x27;0001&#x27;, &#x27;0001&#x27;, &#x27;0001&#x27;, &#x27;0001&#x27;,
       &#x27;0001&#x27;, &#x27;0001&#x27;, &#x27;0001&#x27;, &#x27;0001&#x27;], dtype=&#x27;&lt;U4&#x27;)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-568eb0c5-83c3-49ce-b2b8-c2542b75b5da' class='xr-section-summary-in' type='checkbox'  ><label for='section-568eb0c5-83c3-49ce-b2b8-c2542b75b5da' class='xr-section-summary' >Indexes: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>valid_time</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-9fffef46-57be-4c19-805e-6c1d26590ce6' class='xr-index-data-in' type='checkbox'/><label for='index-9fffef46-57be-4c19-805e-6c1d26590ce6' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;1956-07-01&#x27;, &#x27;1955-07-01&#x27;, &#x27;1943-07-01&#x27;, &#x27;1954-07-01&#x27;,
               &#x27;1975-07-01&#x27;, &#x27;1942-07-01&#x27;, &#x27;1950-07-01&#x27;, &#x27;1971-07-01&#x27;,
               &#x27;1974-07-01&#x27;, &#x27;1951-07-01&#x27;, &#x27;1976-07-01&#x27;, &#x27;1945-07-01&#x27;,
               &#x27;1965-07-01&#x27;, &#x27;1948-07-01&#x27;, &#x27;1968-07-01&#x27;, &#x27;1946-07-01&#x27;,
               &#x27;1960-07-01&#x27;, &#x27;1957-07-01&#x27;, &#x27;1949-07-01&#x27;, &#x27;1941-07-01&#x27;,
               &#x27;1947-07-01&#x27;, &#x27;1962-07-01&#x27;, &#x27;1952-07-01&#x27;, &#x27;1985-07-01&#x27;,
               &#x27;1944-07-01&#x27;, &#x27;1984-07-01&#x27;, &#x27;1959-07-01&#x27;, &#x27;1967-07-01&#x27;,
               &#x27;1969-07-01&#x27;, &#x27;1970-07-01&#x27;, &#x27;1964-07-01&#x27;, &#x27;1953-07-01&#x27;,
               &#x27;1979-07-01&#x27;, &#x27;1961-07-01&#x27;, &#x27;1978-07-01&#x27;, &#x27;1958-07-01&#x27;,
               &#x27;1992-07-01&#x27;, &#x27;1973-07-01&#x27;, &#x27;1940-07-01&#x27;, &#x27;1986-07-01&#x27;,
               &#x27;1977-07-01&#x27;, &#x27;1963-07-01&#x27;, &#x27;1972-07-01&#x27;, &#x27;1966-07-01&#x27;,
               &#x27;1993-07-01&#x27;, &#x27;1982-07-01&#x27;, &#x27;1983-07-01&#x27;, &#x27;2004-07-01&#x27;,
               &#x27;1994-07-01&#x27;, &#x27;1981-07-01&#x27;, &#x27;2000-07-01&#x27;, &#x27;1989-07-01&#x27;,
               &#x27;1980-07-01&#x27;, &#x27;1996-07-01&#x27;, &#x27;1999-07-01&#x27;, &#x27;1988-07-01&#x27;,
               &#x27;1997-07-01&#x27;, &#x27;1995-07-01&#x27;, &#x27;1987-07-01&#x27;, &#x27;1990-07-01&#x27;,
               &#x27;2003-07-01&#x27;, &#x27;1991-07-01&#x27;, &#x27;2013-07-01&#x27;, &#x27;2008-07-01&#x27;,
               &#x27;2001-07-01&#x27;, &#x27;2006-07-01&#x27;, &#x27;2007-07-01&#x27;, &#x27;2002-07-01&#x27;,
               &#x27;2012-07-01&#x27;, &#x27;2010-07-01&#x27;, &#x27;2014-07-01&#x27;, &#x27;2005-07-01&#x27;,
               &#x27;1998-07-01&#x27;, &#x27;2009-07-01&#x27;, &#x27;2011-07-01&#x27;, &#x27;2015-07-01&#x27;,
               &#x27;2017-07-01&#x27;, &#x27;2018-07-01&#x27;, &#x27;2020-07-01&#x27;, &#x27;2021-07-01&#x27;,
               &#x27;2016-07-01&#x27;, &#x27;2022-07-01&#x27;, &#x27;2019-07-01&#x27;, &#x27;2023-07-01&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;valid_time&#x27;, freq=None))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-6cbbdd5d-ed30-478f-b141-c706d8f18ef9' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-6cbbdd5d-ed30-478f-b141-c706d8f18ef9' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div></div></div>
</div>
<p>If we plot the ranking from colder to warmer including also the climate normal we‚Äôll see the following. As before, code is commented in the code cell below:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># create the figure panel and the axes</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="c1"># We create a label for the &#39;x&#39; axis using each year</span>
<span class="n">xlabel</span> <span class="o">=</span> <span class="n">t2m_global_sorted</span><span class="o">.</span><span class="n">valid_time</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;datetime64[Y]&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1970</span> <span class="c1"># years</span>

<span class="c1"># We create also the location for each of the labels in the &#39;x&#39; axis</span>
<span class="n">xpos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">xlabel</span><span class="p">))</span>

<span class="c1"># We extract the sorted values to be used as the &#39;y&#39; values</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">t2m_global_sorted</span><span class="o">.</span><span class="n">values</span>

<span class="c1"># We create a bar plot of all the bars using &#39;tomato&#39; color</span>
<span class="n">ax</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">xpos</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;tomato&#39;</span><span class="p">)</span>

<span class="c1"># We place all the labels for the &#39;x&#39; axis rotated 90¬∫</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">xpos</span><span class="p">,</span> <span class="n">xlabel</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span>

<span class="c1"># Now we create a mask with the values below the climate normal</span>
<span class="n">mask</span> <span class="o">=</span> <span class="n">y</span> <span class="o">&lt;</span> <span class="n">t2m_clim</span>

<span class="c1"># and plot again those values below the climate normal but now using the &#39;mediumslateblue&#39; color</span>
<span class="n">ax</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">xpos</span><span class="p">[</span><span class="n">mask</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="n">mask</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;mediumslateblue&#39;</span><span class="p">)</span>

<span class="c1"># We limit the range of the &#39;y&#39; axis to the (minimum - 0.25) and the (maximum + 0.25)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">t2m_global_sorted</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">-</span> <span class="mf">0.25</span><span class="p">,</span> <span class="n">t2m_global_sorted</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">+</span> <span class="mf">0.25</span><span class="p">)</span>

<span class="c1"># we add a horizontal line to plot the climate normal.</span>
<span class="c1">#ax.plot(range(len(clim_repeated)), clim_repeated, &#39;-.&#39;, linewidth=0.5, color=&#39;black&#39;)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">t2m_clim</span><span class="p">,</span> <span class="n">xmin</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">=</span> <span class="mf">0.95</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>

<span class="c1"># This function is very interesting as it does magic to prettify the final result :-)</span>
<span class="c1"># https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.tight_layout.html</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

<span class="c1"># Show or save the figure, uncomment the line/s in case of need</span>
<span class="c1">#fig.show() # not needed in a notebook inline context</span>
<span class="c1">#fig.savefig(&#39;near_sfc_t2m_global_avg_july_sorted_barplot.png&#39;) # not needed in a notebook inline context</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/b3c2e59366fa36766175ea52fea86fd74d7f151157edef31fb04086532a84322.png" src="../../_images/b3c2e59366fa36766175ea52fea86fd74d7f151157edef31fb04086532a84322.png" />
</div>
</div>
</section>
<section id="view-time-series-and-analyse-north-atlantic-sea-surface-temperature-trends">
<h2>View time series and analyse North Atlantic sea surface temperature trends<a class="headerlink" href="#view-time-series-and-analyse-north-atlantic-sea-surface-temperature-trends" title="Permalink to this heading">#</a></h2>
<section id="this-is-a-new-exercise-in-this-part-of-the-tutorial-we-will-be-working-with-monthly-sea-surface-temperature-sst-data">
<h3>This is a new exercise. In this part of the tutorial we will be working with monthly sea surface temperature (SST) data.<a class="headerlink" href="#this-is-a-new-exercise-in-this-part-of-the-tutorial-we-will-be-working-with-monthly-sea-surface-temperature-sst-data" title="Permalink to this heading">#</a></h3>
<p>First we need to download a new dataset. As before, we need to specify what product type, variables, temporal and geographic coverage we are interested in. These can all be selected in the <strong>‚ÄúDownload data‚Äù</strong> tab in the CDS (<a class="reference external" href="https://cds.climate.copernicus.eu">https://cds.climate.copernicus.eu</a>). In this tab a form appears in which we select the following parameters to download:</p>
<details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header">
Parameters of data to download<div class="sd-summary-down docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-down" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M5.22 8.72a.75.75 0 000 1.06l6.25 6.25a.75.75 0 001.06 0l6.25-6.25a.75.75 0 00-1.06-1.06L12 14.44 6.28 8.72a.75.75 0 00-1.06 0z"></path></svg></div>
<div class="sd-summary-up docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-up" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M18.78 15.28a.75.75 0 000-1.06l-6.25-6.25a.75.75 0 00-1.06 0l-6.25 6.25a.75.75 0 101.06 1.06L12 9.56l5.72 5.72a.75.75 0 001.06 0z"></path></svg></div>
</summary><div class="sd-summary-content sd-card-body docutils">
<ul class="simple">
<li><p class="sd-card-text">Product type: <code class="docutils literal notranslate"><span class="pre">Monthly</span> <span class="pre">averaged</span> <span class="pre">reanalysis</span></code></p></li>
<li><p class="sd-card-text">Variable: <code class="docutils literal notranslate"><span class="pre">sea_surface_temperature</span></code></p></li>
<li><p class="sd-card-text">Year: <code class="docutils literal notranslate"><span class="pre">1991</span> <span class="pre">to</span> <span class="pre">2023</span></code></p></li>
<li><p class="sd-card-text">Month: <code class="docutils literal notranslate"><span class="pre">all</span></code></p></li>
<li><p class="sd-card-text">Time: <code class="docutils literal notranslate"><span class="pre">00:00</span></code> (default)</p></li>
<li><p class="sd-card-text">Geographical area: <code class="docutils literal notranslate"><span class="pre">60,</span> <span class="pre">-40,</span> <span class="pre">0,</span> <span class="pre">0</span></code></p></li>
<li><p class="sd-card-text">Format: <code class="docutils literal notranslate"><span class="pre">NetCDF</span></code></p></li>
</ul>
</div>
</details><p>Below you can see the API request:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">c</span><span class="o">.</span><span class="n">retrieve</span><span class="p">(</span>
    <span class="s1">&#39;reanalysis-era5-single-levels-monthly-means&#39;</span><span class="p">,</span>
    <span class="p">{</span>
        <span class="s1">&#39;data_format&#39;</span><span class="p">:</span> <span class="s1">&#39;netcdf&#39;</span><span class="p">,</span>
        <span class="s1">&#39;variable&#39;</span><span class="p">:</span> <span class="s1">&#39;sea_surface_temperature&#39;</span><span class="p">,</span>
        <span class="s1">&#39;product_type&#39;</span><span class="p">:</span> <span class="s1">&#39;monthly_averaged_reanalysis&#39;</span><span class="p">,</span>
        <span class="s1">&#39;year&#39;</span><span class="p">:</span> <span class="p">[</span>
            <span class="s1">&#39;1991&#39;</span><span class="p">,</span> <span class="s1">&#39;1992&#39;</span><span class="p">,</span> <span class="s1">&#39;1993&#39;</span><span class="p">,</span>
            <span class="s1">&#39;1994&#39;</span><span class="p">,</span> <span class="s1">&#39;1995&#39;</span><span class="p">,</span> <span class="s1">&#39;1996&#39;</span><span class="p">,</span>
            <span class="s1">&#39;1997&#39;</span><span class="p">,</span> <span class="s1">&#39;1998&#39;</span><span class="p">,</span> <span class="s1">&#39;1999&#39;</span><span class="p">,</span>
            <span class="s1">&#39;2000&#39;</span><span class="p">,</span> <span class="s1">&#39;2001&#39;</span><span class="p">,</span> <span class="s1">&#39;2002&#39;</span><span class="p">,</span>
            <span class="s1">&#39;2003&#39;</span><span class="p">,</span> <span class="s1">&#39;2004&#39;</span><span class="p">,</span> <span class="s1">&#39;2005&#39;</span><span class="p">,</span>
            <span class="s1">&#39;2006&#39;</span><span class="p">,</span> <span class="s1">&#39;2007&#39;</span><span class="p">,</span> <span class="s1">&#39;2008&#39;</span><span class="p">,</span>
            <span class="s1">&#39;2009&#39;</span><span class="p">,</span> <span class="s1">&#39;2010&#39;</span><span class="p">,</span> <span class="s1">&#39;2011&#39;</span><span class="p">,</span>
            <span class="s1">&#39;2012&#39;</span><span class="p">,</span> <span class="s1">&#39;2013&#39;</span><span class="p">,</span> <span class="s1">&#39;2014&#39;</span><span class="p">,</span>
            <span class="s1">&#39;2015&#39;</span><span class="p">,</span> <span class="s1">&#39;2016&#39;</span><span class="p">,</span> <span class="s1">&#39;2017&#39;</span><span class="p">,</span>
            <span class="s1">&#39;2018&#39;</span><span class="p">,</span> <span class="s1">&#39;2019&#39;</span><span class="p">,</span> <span class="s1">&#39;2020&#39;</span><span class="p">,</span>
            <span class="s1">&#39;2021&#39;</span><span class="p">,</span> <span class="s1">&#39;2022&#39;</span><span class="p">,</span> <span class="s1">&#39;2023&#39;</span><span class="p">,</span>
        <span class="p">],</span>
        <span class="s1">&#39;month&#39;</span><span class="p">:</span> <span class="p">[</span>
            <span class="s1">&#39;01&#39;</span><span class="p">,</span> <span class="s1">&#39;02&#39;</span><span class="p">,</span> <span class="s1">&#39;03&#39;</span><span class="p">,</span>
            <span class="s1">&#39;04&#39;</span><span class="p">,</span> <span class="s1">&#39;05&#39;</span><span class="p">,</span> <span class="s1">&#39;06&#39;</span><span class="p">,</span>
            <span class="s1">&#39;07&#39;</span><span class="p">,</span> <span class="s1">&#39;08&#39;</span><span class="p">,</span> <span class="s1">&#39;09&#39;</span><span class="p">,</span>
            <span class="s1">&#39;10&#39;</span><span class="p">,</span> <span class="s1">&#39;11&#39;</span><span class="p">,</span> <span class="s1">&#39;12&#39;</span><span class="p">,</span>
        <span class="p">],</span>
        <span class="s1">&#39;time&#39;</span><span class="p">:</span> <span class="s1">&#39;00:00&#39;</span><span class="p">,</span>
        <span class="s1">&#39;area&#39;</span><span class="p">:</span> <span class="p">[</span>
            <span class="mi">60</span><span class="p">,</span> <span class="o">-</span><span class="mi">40</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
            <span class="mi">0</span><span class="p">,</span>
        <span class="p">],</span>
    <span class="p">},</span>
    <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">DATADIR</span><span class="si">}</span><span class="s1">sst_(NAtl)_monthly_1991-2023.nc&#39;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-07-15 10:20:45,130 INFO Request ID is 367ce9dc-1d8b-402c-8185-4c485b849b4a
2025-07-15 10:20:45,588 INFO status has been updated to accepted
2025-07-15 10:20:54,421 INFO status has been updated to running
2025-07-15 10:21:36,540 INFO status has been updated to successful
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "0bc8b72729794944a2e7c5e18ec5e9a9", "version_major": 2, "version_minor": 0}</script><div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;./data_dir/sst_(NAtl)_monthly_1991-2023.nc&#39;
</pre></div>
</div>
</div>
</div>
<p>Let‚Äôs do some work with this new dataset. First of all, let‚Äôs read it.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sst_ds</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">DATADIR</span><span class="si">}</span><span class="s1">sst_(NAtl)_monthly_1991-2023.nc&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Now we can have a look at the dataset:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sst_ds</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme="dark"],
html[data-theme="dark"],
body[data-theme="dark"],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1f1f1f;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: inline-block;
  opacity: 0;
  height: 0;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:focus + label {
  border: 2px solid var(--xr-font-color0);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: "‚ñ∫";
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: "‚ñº";
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: "(";
}

.xr-dim-list:after {
  content: ")";
}

.xr-dim-list li:not(:last-child):after {
  content: ",";
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 61MB
Dimensions:     (valid_time: 396, latitude: 241, longitude: 161)
Coordinates:
    number      int64 8B ...
  * valid_time  (valid_time) datetime64[ns] 3kB 1991-01-01 ... 2023-12-01
  * latitude    (latitude) float64 2kB 60.0 59.75 59.5 59.25 ... 0.5 0.25 0.0
  * longitude   (longitude) float64 1kB -40.0 -39.75 -39.5 ... -0.5 -0.25 0.0
    expver      (valid_time) &lt;U4 6kB ...
Data variables:
    sst         (valid_time, latitude, longitude) float32 61MB ...
Attributes:
    GRIB_centre:             ecmf
    GRIB_centreDescription:  European Centre for Medium-Range Weather Forecasts
    GRIB_subCentre:          0
    Conventions:             CF-1.7
    institution:             European Centre for Medium-Range Weather Forecasts
    history:                 2025-07-15T08:21 GRIB to CDM+CF via cfgrib-0.9.1...</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-6f069c37-e3e2-481d-ac5e-11b87e77a051' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-6f069c37-e3e2-481d-ac5e-11b87e77a051' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>valid_time</span>: 396</li><li><span class='xr-has-index'>latitude</span>: 241</li><li><span class='xr-has-index'>longitude</span>: 161</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-7e773d69-36d3-406f-b383-6b3a4950bb38' class='xr-section-summary-in' type='checkbox'  checked><label for='section-7e773d69-36d3-406f-b383-6b3a4950bb38' class='xr-section-summary' >Coordinates: <span>(5)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>number</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-a6dc4d1e-1e8e-4063-972b-42540d12a0d8' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-a6dc4d1e-1e8e-4063-972b-42540d12a0d8' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-638d4c92-7af2-415a-b316-9b9f6b2e1171' class='xr-var-data-in' type='checkbox'><label for='data-638d4c92-7af2-415a-b316-9b9f6b2e1171' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>ensemble member numerical id</dd><dt><span>units :</span></dt><dd>1</dd><dt><span>standard_name :</span></dt><dd>realization</dd></dl></div><div class='xr-var-data'><pre>[1 values with dtype=int64]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>valid_time</span></div><div class='xr-var-dims'>(valid_time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>1991-01-01 ... 2023-12-01</div><input id='attrs-5d89a77d-0b59-4052-a621-abbf9b928c95' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-5d89a77d-0b59-4052-a621-abbf9b928c95' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-51f71192-78bb-4864-a2f1-4ba68c6884fd' class='xr-var-data-in' type='checkbox'><label for='data-51f71192-78bb-4864-a2f1-4ba68c6884fd' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>time</dd><dt><span>standard_name :</span></dt><dd>time</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;1991-01-01T00:00:00.000000000&#x27;, &#x27;1991-02-01T00:00:00.000000000&#x27;,
       &#x27;1991-03-01T00:00:00.000000000&#x27;, ..., &#x27;2023-10-01T00:00:00.000000000&#x27;,
       &#x27;2023-11-01T00:00:00.000000000&#x27;, &#x27;2023-12-01T00:00:00.000000000&#x27;],
      shape=(396,), dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>latitude</span></div><div class='xr-var-dims'>(latitude)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>60.0 59.75 59.5 ... 0.5 0.25 0.0</div><input id='attrs-1872999b-4e59-4737-9cb7-1fb0a5614b9f' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-1872999b-4e59-4737-9cb7-1fb0a5614b9f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-6059f882-613c-4492-af41-094f5837ce53' class='xr-var-data-in' type='checkbox'><label for='data-6059f882-613c-4492-af41-094f5837ce53' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>long_name :</span></dt><dd>latitude</dd><dt><span>stored_direction :</span></dt><dd>decreasing</dd></dl></div><div class='xr-var-data'><pre>array([60.  , 59.75, 59.5 , ...,  0.5 ,  0.25,  0.  ], shape=(241,))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>longitude</span></div><div class='xr-var-dims'>(longitude)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-40.0 -39.75 -39.5 ... -0.25 0.0</div><input id='attrs-61551dca-aac0-4079-a5bf-af4f32c0de34' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-61551dca-aac0-4079-a5bf-af4f32c0de34' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-946927de-70cd-41a9-b982-c6843e02cb35' class='xr-var-data-in' type='checkbox'><label for='data-946927de-70cd-41a9-b982-c6843e02cb35' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>long_name :</span></dt><dd>longitude</dd></dl></div><div class='xr-var-data'><pre>array([-40.  , -39.75, -39.5 , -39.25, -39.  , -38.75, -38.5 , -38.25, -38.  ,
       -37.75, -37.5 , -37.25, -37.  , -36.75, -36.5 , -36.25, -36.  , -35.75,
       -35.5 , -35.25, -35.  , -34.75, -34.5 , -34.25, -34.  , -33.75, -33.5 ,
       -33.25, -33.  , -32.75, -32.5 , -32.25, -32.  , -31.75, -31.5 , -31.25,
       -31.  , -30.75, -30.5 , -30.25, -30.  , -29.75, -29.5 , -29.25, -29.  ,
       -28.75, -28.5 , -28.25, -28.  , -27.75, -27.5 , -27.25, -27.  , -26.75,
       -26.5 , -26.25, -26.  , -25.75, -25.5 , -25.25, -25.  , -24.75, -24.5 ,
       -24.25, -24.  , -23.75, -23.5 , -23.25, -23.  , -22.75, -22.5 , -22.25,
       -22.  , -21.75, -21.5 , -21.25, -21.  , -20.75, -20.5 , -20.25, -20.  ,
       -19.75, -19.5 , -19.25, -19.  , -18.75, -18.5 , -18.25, -18.  , -17.75,
       -17.5 , -17.25, -17.  , -16.75, -16.5 , -16.25, -16.  , -15.75, -15.5 ,
       -15.25, -15.  , -14.75, -14.5 , -14.25, -14.  , -13.75, -13.5 , -13.25,
       -13.  , -12.75, -12.5 , -12.25, -12.  , -11.75, -11.5 , -11.25, -11.  ,
       -10.75, -10.5 , -10.25, -10.  ,  -9.75,  -9.5 ,  -9.25,  -9.  ,  -8.75,
        -8.5 ,  -8.25,  -8.  ,  -7.75,  -7.5 ,  -7.25,  -7.  ,  -6.75,  -6.5 ,
        -6.25,  -6.  ,  -5.75,  -5.5 ,  -5.25,  -5.  ,  -4.75,  -4.5 ,  -4.25,
        -4.  ,  -3.75,  -3.5 ,  -3.25,  -3.  ,  -2.75,  -2.5 ,  -2.25,  -2.  ,
        -1.75,  -1.5 ,  -1.25,  -1.  ,  -0.75,  -0.5 ,  -0.25,   0.  ])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>expver</span></div><div class='xr-var-dims'>(valid_time)</div><div class='xr-var-dtype'>&lt;U4</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-2b605acc-0245-496c-b586-e35c6c87b387' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-2b605acc-0245-496c-b586-e35c6c87b387' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-8e06db9b-be11-4557-9c6c-37e98feaad32' class='xr-var-data-in' type='checkbox'><label for='data-8e06db9b-be11-4557-9c6c-37e98feaad32' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>[396 values with dtype=&lt;U4]</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-2afbe9f0-0ebe-4e76-a668-6a900f6473e6' class='xr-section-summary-in' type='checkbox'  checked><label for='section-2afbe9f0-0ebe-4e76-a668-6a900f6473e6' class='xr-section-summary' >Data variables: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>sst</span></div><div class='xr-var-dims'>(valid_time, latitude, longitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-d3e3fc44-b22f-4716-8436-00a2c0c57ad9' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-d3e3fc44-b22f-4716-8436-00a2c0c57ad9' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-1220474f-2c8b-4c57-a094-247d83bf3c15' class='xr-var-data-in' type='checkbox'><label for='data-1220474f-2c8b-4c57-a094-247d83bf3c15' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>GRIB_paramId :</span></dt><dd>34</dd><dt><span>GRIB_dataType :</span></dt><dd>an</dd><dt><span>GRIB_numberOfPoints :</span></dt><dd>38801</dd><dt><span>GRIB_typeOfLevel :</span></dt><dd>surface</dd><dt><span>GRIB_stepUnits :</span></dt><dd>1</dd><dt><span>GRIB_stepType :</span></dt><dd>avgua</dd><dt><span>GRIB_gridType :</span></dt><dd>regular_ll</dd><dt><span>GRIB_uvRelativeToGrid :</span></dt><dd>0</dd><dt><span>GRIB_NV :</span></dt><dd>0</dd><dt><span>GRIB_Nx :</span></dt><dd>161</dd><dt><span>GRIB_Ny :</span></dt><dd>241</dd><dt><span>GRIB_cfName :</span></dt><dd>unknown</dd><dt><span>GRIB_cfVarName :</span></dt><dd>sst</dd><dt><span>GRIB_gridDefinitionDescription :</span></dt><dd>Latitude/Longitude Grid</dd><dt><span>GRIB_iDirectionIncrementInDegrees :</span></dt><dd>0.25</dd><dt><span>GRIB_iScansNegatively :</span></dt><dd>0</dd><dt><span>GRIB_jDirectionIncrementInDegrees :</span></dt><dd>0.25</dd><dt><span>GRIB_jPointsAreConsecutive :</span></dt><dd>0</dd><dt><span>GRIB_jScansPositively :</span></dt><dd>0</dd><dt><span>GRIB_latitudeOfFirstGridPointInDegrees :</span></dt><dd>60.0</dd><dt><span>GRIB_latitudeOfLastGridPointInDegrees :</span></dt><dd>0.0</dd><dt><span>GRIB_longitudeOfFirstGridPointInDegrees :</span></dt><dd>-40.0</dd><dt><span>GRIB_longitudeOfLastGridPointInDegrees :</span></dt><dd>0.0</dd><dt><span>GRIB_missingValue :</span></dt><dd>3.4028234663852886e+38</dd><dt><span>GRIB_name :</span></dt><dd>Sea surface temperature</dd><dt><span>GRIB_shortName :</span></dt><dd>sst</dd><dt><span>GRIB_units :</span></dt><dd>K</dd><dt><span>long_name :</span></dt><dd>Sea surface temperature</dd><dt><span>units :</span></dt><dd>K</dd><dt><span>standard_name :</span></dt><dd>unknown</dd><dt><span>GRIB_surface :</span></dt><dd>0.0</dd></dl></div><div class='xr-var-data'><pre>[15365196 values with dtype=float32]</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-850f9b1b-ce91-4f02-99bd-eda3d504c3f5' class='xr-section-summary-in' type='checkbox'  ><label for='section-850f9b1b-ce91-4f02-99bd-eda3d504c3f5' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>valid_time</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-0afd2255-3f41-42d5-9843-ac4c5317e159' class='xr-index-data-in' type='checkbox'/><label for='index-0afd2255-3f41-42d5-9843-ac4c5317e159' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;1991-01-01&#x27;, &#x27;1991-02-01&#x27;, &#x27;1991-03-01&#x27;, &#x27;1991-04-01&#x27;,
               &#x27;1991-05-01&#x27;, &#x27;1991-06-01&#x27;, &#x27;1991-07-01&#x27;, &#x27;1991-08-01&#x27;,
               &#x27;1991-09-01&#x27;, &#x27;1991-10-01&#x27;,
               ...
               &#x27;2023-03-01&#x27;, &#x27;2023-04-01&#x27;, &#x27;2023-05-01&#x27;, &#x27;2023-06-01&#x27;,
               &#x27;2023-07-01&#x27;, &#x27;2023-08-01&#x27;, &#x27;2023-09-01&#x27;, &#x27;2023-10-01&#x27;,
               &#x27;2023-11-01&#x27;, &#x27;2023-12-01&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;valid_time&#x27;, length=396, freq=None))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>latitude</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-26505ca8-91a3-4e02-87f8-fde5a8e9b79a' class='xr-index-data-in' type='checkbox'/><label for='index-26505ca8-91a3-4e02-87f8-fde5a8e9b79a' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([ 60.0, 59.75,  59.5, 59.25,  59.0, 58.75,  58.5, 58.25,  58.0, 57.75,
       ...
        2.25,   2.0,  1.75,   1.5,  1.25,   1.0,  0.75,   0.5,  0.25,   0.0],
      dtype=&#x27;float64&#x27;, name=&#x27;latitude&#x27;, length=241))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>longitude</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-f7595947-cfeb-4f4b-bf35-1e4b86ccff69' class='xr-index-data-in' type='checkbox'/><label for='index-f7595947-cfeb-4f4b-bf35-1e4b86ccff69' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([ -40.0, -39.75,  -39.5, -39.25,  -39.0, -38.75,  -38.5, -38.25,  -38.0,
       -37.75,
       ...
        -2.25,   -2.0,  -1.75,   -1.5,  -1.25,   -1.0,  -0.75,   -0.5,  -0.25,
          0.0],
      dtype=&#x27;float64&#x27;, name=&#x27;longitude&#x27;, length=161))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-ccf72789-55ed-4a6c-9bbe-ce3ffc1a27fb' class='xr-section-summary-in' type='checkbox'  checked><label for='section-ccf72789-55ed-4a6c-9bbe-ce3ffc1a27fb' class='xr-section-summary' >Attributes: <span>(6)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>GRIB_centre :</span></dt><dd>ecmf</dd><dt><span>GRIB_centreDescription :</span></dt><dd>European Centre for Medium-Range Weather Forecasts</dd><dt><span>GRIB_subCentre :</span></dt><dd>0</dd><dt><span>Conventions :</span></dt><dd>CF-1.7</dd><dt><span>institution :</span></dt><dd>European Centre for Medium-Range Weather Forecasts</dd><dt><span>history :</span></dt><dd>2025-07-15T08:21 GRIB to CDM+CF via cfgrib-0.9.15.0/ecCodes-2.41.0 with {&quot;source&quot;: &quot;tmp3v0f_kw1/data.grib&quot;, &quot;filter_by_keys&quot;: {&quot;stream&quot;: [&quot;moda&quot;], &quot;stepType&quot;: [&quot;avgua&quot;]}, &quot;encode_cf&quot;: [&quot;parameter&quot;, &quot;time&quot;, &quot;geography&quot;, &quot;vertical&quot;]}</dd></dl></div></li></ul></div></div></div></div>
</div>
<p>As before, we see there are four dimensions and units are in <em>Kelvin</em>. We will work with data in <em>degrees Celsius</em>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># convert to ¬∫C</span>
<span class="n">sst</span> <span class="o">=</span> <span class="n">sst_ds</span><span class="p">[</span><span class="s1">&#39;sst&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="mf">273.15</span>
</pre></div>
</div>
</div>
</div>
<p>We can have a quick look at the data using the convenient <code class="docutils literal notranslate"><span class="pre">plot</span></code> method:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sst</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">valid_time</span><span class="o">=</span><span class="s1">&#39;1991/01&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.collections.QuadMesh at 0x33c283050&gt;
</pre></div>
</div>
<img alt="../../_images/bf081ef2d7813067c00a6958cfcff346d90eef1c1fb7b9bd3583d226ac5cb2ff.png" src="../../_images/bf081ef2d7813067c00a6958cfcff346d90eef1c1fb7b9bd3583d226ac5cb2ff.png" />
</div>
</div>
<p>In the plot above we can see many values are below 0, those located on land. Actually, in the original <code class="docutils literal notranslate"><span class="pre">sst_ds</span></code> <code class="docutils literal notranslate"><span class="pre">xarray.Dataset</span></code> the land positions had a value of <code class="docutils literal notranslate"><span class="pre">numpy.nan</span></code>. Now, for <code class="docutils literal notranslate"><span class="pre">sst_expver</span></code> this is not true. This is a result of the previous operation using <code class="docutils literal notranslate"><span class="pre">numpy.nansum</span></code> and subtracting <code class="docutils literal notranslate"><span class="pre">273.15</span></code>. After this operation the land locations have a value of <code class="docutils literal notranslate"><span class="pre">-273.15</span></code> which is not valid. Let‚Äôs amend this using a mask:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># add a mask for LAND</span>
<span class="n">mask</span> <span class="o">=</span> <span class="n">sst</span><span class="o">.</span><span class="n">values</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mf">273.15</span>
<span class="n">sst_masked</span> <span class="o">=</span> <span class="n">sst</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">mask</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Again, as before, we weight the dataset by the area:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Add weights for area</span>
<span class="n">weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="n">sst_masked</span><span class="o">.</span><span class="n">latitude</span><span class="p">))</span>
<span class="n">weights</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;weights&quot;</span>
<span class="n">sst_weights</span> <span class="o">=</span> <span class="n">sst_masked</span><span class="o">.</span><span class="n">weighted</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>And, also, we calculate the spatially averaged value for each month to get a monthly time series of the average temperature of the sst over the main area of the North Atlantic from January 1991 to July 2023:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Aggregate on Lon/Lat to get a time series of the area</span>
<span class="n">sst_ts</span> <span class="o">=</span> <span class="n">sst_weights</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="s2">&quot;longitude&quot;</span><span class="p">,</span> <span class="s2">&quot;latitude&quot;</span><span class="p">])</span>
<span class="n">sst_ts</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x33c8b9e80&gt;]
</pre></div>
</div>
<img alt="../../_images/d6d103da1cbdffda3d2ef322eb9585571f88576d7f17b1066a2ec369237c5337.png" src="../../_images/d6d103da1cbdffda3d2ef322eb9585571f88576d7f17b1066a2ec369237c5337.png" />
</div>
</div>
<p>In the plot above we can see the monthly evolution since 1991.</p>
<p>We calculate the minimum, the maximum and the average value for each of the 12 months of the year during the climatological reference (1991-2020):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Min value on each month during the climatology period</span>
<span class="n">min_per_month_clim</span> <span class="o">=</span> <span class="n">sst_ts</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span>
    <span class="n">valid_time</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="s1">&#39;1991-01-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2020-12-31&#39;</span><span class="p">)</span>
<span class="p">)</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;valid_time.month&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>

<span class="c1"># Max value on each month during the climatology period</span>
<span class="n">max_per_month_clim</span> <span class="o">=</span> <span class="n">sst_ts</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span>
    <span class="n">valid_time</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="s1">&#39;1991-01-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2020-12-31&#39;</span><span class="p">)</span>
<span class="p">)</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;valid_time.month&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>

<span class="c1"># avg value on each month during the climatology period</span>
<span class="n">avg_per_month_clim</span> <span class="o">=</span> <span class="n">sst_ts</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span>
    <span class="n">valid_time</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="s1">&#39;1991-01-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2020-12-31&#39;</span><span class="p">)</span>
<span class="p">)</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;valid_time.month&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>And once we have this we can compare how recent SST values compare with those of previous years and to the climatology.</p>
<p>In the figure below we will plot the monthly time series for the following:</p>
<ul class="simple">
<li><p>Each year for the period from 1991 to 2020 (light gray).</p></li>
<li><p>The 1991-2020 average (thick gray line).</p></li>
<li><p>2022 (thick orange line).</p></li>
<li><p>2023 (January to July, thick black line).</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_facecolor</span><span class="p">(</span><span class="s1">&#39;white&#39;</span><span class="p">)</span> <span class="c1"># For this plot we want a white axes background </span>

<span class="c1"># Thin line for each year from 1991 to 2020</span>
<span class="k">for</span> <span class="n">year</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1991</span><span class="p">,</span> <span class="mi">2021</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">13</span><span class="p">),</span> <span class="n">sst_ts</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">valid_time</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">year</span><span class="p">)),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;lightgrey&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="c1"># Climatological average</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">13</span><span class="p">),</span> <span class="n">avg_per_month_clim</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Clim&#39;</span><span class="p">)</span>

<span class="c1"># Monthly average for 2022</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">13</span><span class="p">),</span> <span class="n">sst_ts</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">valid_time</span><span class="o">=</span><span class="s1">&#39;2022&#39;</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;2022&#39;</span><span class="p">)</span>

<span class="c1"># Monthly average for 2023</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">13</span><span class="p">),</span> <span class="n">sst_ts</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">valid_time</span><span class="o">=</span><span class="s1">&#39;2023&#39;</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;2023&#39;</span><span class="p">)</span>

<span class="c1"># Customise the plot</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;month&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;SST ($\degree$C)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

<span class="c1"># Show or save the figure, uncomment the line/s in case of need</span>
<span class="c1">#fig.show() # not needed in a notebook inline context</span>
<span class="c1">#fig.savefig(&#39;SST_NorthAtlantic_avg.png&#39;) # not needed in a notebook inline context</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;&gt;:20: SyntaxWarning: invalid escape sequence &#39;\d&#39;
&lt;&gt;:20: SyntaxWarning: invalid escape sequence &#39;\d&#39;
/var/folders/kx/ksg5wbrj1sq95rp2tz_72j6c0000gn/T/ipykernel_2529/2791732523.py:20: SyntaxWarning: invalid escape sequence &#39;\d&#39;
  ax.set_ylabel(&#39;SST ($\degree$C)&#39;)
</pre></div>
</div>
<img alt="../../_images/9166192b6169127628ffecd4cafdf081239c3b02f4da551d43747df4c25b972a.png" src="../../_images/9166192b6169127628ffecd4cafdf081239c3b02f4da551d43747df4c25b972a.png" />
</div>
</div>
<p>Notice the dramatic increase in SST over the North Atlantic in 2023 compared to previous years!</p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./submodules\c3s-training-submodule-reanalysis"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="reanalysis-heatwave.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Analysis of September 2020 European heatwave using ERA5 climate reanalysis data from C3S</p>
      </div>
    </a>
    <a class="right-next"
       href="../c3s-training-submodule-seasonal-forecast/intro.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Tutorials on C3S seasonal forecasts datasets</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#learning-objectives">Learning objectives üéØ</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#prepare-your-environment">Prepare your environment</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#set-up-the-cdsapi-and-your-credentials">Set up the CDSAPI and your credentials</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#install-and-import-libraries">(Install and) Import libraries</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#specify-data-directory">Specify data directory</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#explore-data">Explore data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#search-for-the-data">Search for the data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#download-the-data">Download the data</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#inspect-data">Inspect data</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#change-temperature-units-from-kelvin-to-celsius">Change temperature units from Kelvin to Celsius</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-to-be-used">Data to be used</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plotting-one-timestep">Plotting one timestep</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#calculate-a-surface-temperature-climatology-reference-period-1991-2020">Calculate a surface temperature climatology: reference period 1991-2020</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#standard-reference-periods-and-climatologies">Standard reference periods and climatologies</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#visualise-surface-temperature-anomalies">Visualise surface temperature anomalies</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#view-time-series-and-analyse-surface-temperature-trends">View time series and analyse surface temperature trends</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#view-time-series-and-analyse-north-atlantic-sea-surface-temperature-trends">View time series and analyse North Atlantic sea surface temperature trends</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#this-is-a-new-exercise-in-this-part-of-the-tutorial-we-will-be-working-with-monthly-sea-surface-temperature-sst-data">This is a new exercise. In this part of the tutorial we will be working with monthly sea surface temperature (SST) data.</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By the Copernicus Climate Change Service (C3S), entrusted to ECMWF (European Centre for Medium-Range Weather Forecasts)
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      ¬© Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
<div class="extra_footer">
  <script src="_static/custom.js"></script>

</div>
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>