

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Visualising Lake Surface Water Temperature (LSWT) as timeseries at one location on a given lake and the spatial distribution of the LSWT for a given day &#8212; Copernicus Climate Change Service (C3S) Training Book</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!-- 
    this give us a css class that will be invisible only if js is disabled 
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.4cbf315f70debaebd550c87a6162cf0f.min.css" />
  
  <!-- So that users can add custom icons -->
  <script src="../../_static/scripts/fontawesome.js?digest=26a4bc78f4c0ddb94549"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549" />

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/sphinx_highlight.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'submodules/c3s-training-submodule-sat-obs-hydro-cryo/lake-surface-water-temperature';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Welcome to your Jupyter Book" href="../c3s-training-submodule-sat-obs-ocean/intro.html" />
    <link rel="prev" title="C3S Soil Moisture Data Access and Anomaly Analysis Notebook" href="soil-moisture-anomalies.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>
<aside class="bd-header-announcement" aria-label="Announcement">
  <div class="bd-header-announcement__content">⚠️This is a TEST Version, this is not an official website⚠️</div>
</aside>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../intro.html">
  
  
  
  
  
  
    <p class="title logo__title">Copernicus Climate Change Service (C3S) Training Book</p>
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    Copernicus Climate Change Service (C3S) Data Tutorials
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Introduction</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../how-to-run-these-tutorials.html">How to run these tutorials</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../cds-tutorial/intro.html">CDS</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../cds-tutorial/cds-tutorial.html">CDS</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../c3s-training-submodule-reanalysis/intro.html">Reanalysis</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../c3s-training-submodule-reanalysis/reanalysis-climatology.html">Climatology</a></li>
<li class="toctree-l2"><a class="reference internal" href="../c3s-training-submodule-reanalysis/reanalysis-heatwave.html">Heatwave Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../c3s-training-submodule-reanalysis/reanalysis-temp-record.html">Temperature Record</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../c3s-training-submodule-projections/intro.html">Climate Projections</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../c3s-training-submodule-projections/projections-cmip6.html">Global Climate Projections (CMIP6)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../c3s-training-submodule-projections/projections-cordex.html">Regional Climate Projections (CORDEX)</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../c3s-training-submodule-seasonal-forecast/intro.html">Seasonal Forecasts</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../c3s-training-submodule-seasonal-forecast/sf-anomalies.html">Seasonal Forecast Anomalies</a></li>
<li class="toctree-l2"><a class="reference internal" href="../c3s-training-submodule-seasonal-forecast/sf-verification.html">Seasonal Forecast Verification</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../c3s-training-submodule-climate-indices/intro.html">Climate Indices</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../c3s-training-submodule-climate-indices/ci-windchill.html">Windchill</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../c3s-training-submodule-sat-obs-atmos-physics/intro.html">Satellite Observations - Atmospheric Physic</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../c3s-training-submodule-sat-obs-atmos-physics/erb-outgoing-longwave-radiation.html">Outgoing Longwave Radiation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../c3s-training-submodule-sat-obs-atmos-physics/erb-clara-climatology.html">Analysis of the CLARA Earth radiation budget product</a></li>
<li class="toctree-l2"><a class="reference internal" href="../c3s-training-submodule-sat-obs-atmos-physics/erb-ceres-climatology.html">Analysis of the CERES Earth radiation budget product</a></li>
<li class="toctree-l2"><a class="reference internal" href="../c3s-training-submodule-sat-obs-atmos-physics/total-solar-irradiance.html">Total Solar Irradiance</a></li>
<li class="toctree-l2"><a class="reference internal" href="../c3s-training-submodule-sat-obs-atmos-physics/srb-climatology-and-anomaly.html">Surface radiation budget climatologies and anomalies</a></li>
<li class="toctree-l2"><a class="reference internal" href="../c3s-training-submodule-sat-obs-atmos-physics/total-column-water-vapour-combi.html">Total column water vapour</a></li>
<li class="toctree-l2"><a class="reference internal" href="../c3s-training-submodule-sat-obs-atmos-physics/tropospheric-humidity-from-radio-occultation.html">Tropospheric humidity estimates from satellite-based radio occultation measurements</a></li>
<li class="toctree-l2"><a class="reference internal" href="../c3s-training-submodule-sat-obs-atmos-physics/cloud-cover-climatology.html">Cloud fractional cover climatology</a></li>
<li class="toctree-l2"><a class="reference internal" href="../c3s-training-submodule-sat-obs-atmos-physics/precipitation-giraffe.html">Exploring Precipitation information in the GIRAFFE dataset</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../c3s-training-submodule-sat-obs-atmos-comp/intro.html">Satellite Observations - Atmospheric Composition</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../c3s-training-submodule-sat-obs-atmos-comp/greenhouse-gases-level2-products.html">How to access and use a satellite-derived GHG Level 2 data product using XCO2_EMMA as an example?</a></li>


<li class="toctree-l2"><a class="reference internal" href="../c3s-training-submodule-sat-obs-atmos-comp/greenhouse-gases-level3-products.html">How to access, read and use satellite XCO2 and XCH4 Level 3 data products</a></li>


<li class="toctree-l2"><a class="reference internal" href="../c3s-training-submodule-sat-obs-atmos-comp/aerosol-single-sensor-demonstrator.html">Exploring gridded data on Aerosol properties available on C3S</a></li>








<li class="toctree-l2"><a class="reference internal" href="../c3s-training-submodule-sat-obs-atmos-comp/aerosol-multi-sensor-record.html">Visualising a full Climate Data Record of multi-sensor Aerosol data</a></li>









<li class="toctree-l2"><a class="reference internal" href="../c3s-training-submodule-sat-obs-atmos-comp/total-ozone-columns.html">Total Ozone Columns</a></li>
</ul>
</details></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="intro.html">Satellite Observations - Hydrology and Cryosphere</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="soil-moisture-anomalies.html">Soil Moisture Anomaly Analysis</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Lake Surface Water Temperature Analysis</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../c3s-training-submodule-sat-obs-ocean/intro.html">Satellite Observations - Ocean</a></li>
<li class="toctree-l1"><a class="reference internal" href="../c3s-training-submodule-sat-obs-land/intro.html">Satellite Observations - Land</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Explore other books📚</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference external" href="https://Randbee.github.io/CAMSBook">Copernicus Atmosphere Monitoring Service (CAMS) Data Tutorials</a></li>
<li class="toctree-l1"><a class="reference external" href="https://ecmwfcode4earth.github.io/sketchbook-earth">Sketchbook Earth - A collection of Jupyter notebooks for Earth Sciences</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">ECMWF</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../support.html">Help&amp;Support</a></li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference external" href="https://climate.copernicus.eu/">Copernicus Climate Change Service (C3S)</a></li>
<li class="toctree-l1"><a class="reference external" href="https://cds.climate.copernicus.eu/">Copernicus Climate Data Store (CDS)</a></li>
<li class="toctree-l1"><a class="reference external" href="https://climate.copernicus.eu/user-learning-services/">C3S Training Services</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/Randbee/C3SBook/review?urlpath=tree/submodules/c3s-training-submodule-sat-obs-hydro-cryo/lake-surface-water-temperature.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Binder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Binder logo" src="../../_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/Randbee/C3SBook" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/Randbee/C3SBook/issues/new?title=Issue%20on%20page%20%2Fsubmodules/c3s-training-submodule-sat-obs-hydro-cryo/lake-surface-water-temperature.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/submodules/c3s-training-submodule-sat-obs-hydro-cryo/lake-surface-water-temperature.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Visualising Lake Surface Water Temperature (LSWT) as timeseries at one location on a given lake and the spatial distribution of the LSWT for a given day</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#import-librairies">Import librairies</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#downloading-the-data">Downloading the data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#visualise-the-lake-surface-water-temperature-timeseries">Visualise the Lake Surface Water Temperature timeseries</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-the-position-of-the-location-of-the-extracted-lswt-on-the-lake-mask">Plot the position of the location of the extracted LSWT on the lake mask</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-the-lswt-quality-level-and-uncertainty-for-the-selected-day-of-the-last-year-on-record">Plot the LSWT, quality level and uncertainty for the selected day of the last year on record</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <p><img alt="logo" src="../../_images/LogoLine_horizon_C3S2.png" /></p>
<section class="tex2jax_ignore mathjax_ignore" id="visualising-lake-surface-water-temperature-lswt-as-timeseries-at-one-location-on-a-given-lake-and-the-spatial-distribution-of-the-lswt-for-a-given-day">
<h1>Visualising Lake Surface Water Temperature (LSWT) as timeseries at one location on a given lake and the spatial distribution of the LSWT for a given day<a class="headerlink" href="#visualising-lake-surface-water-temperature-lswt-as-timeseries-at-one-location-on-a-given-lake-and-the-spatial-distribution-of-the-lswt-for-a-given-day" title="Permalink to this heading">#</a></h1>
<p><font color='red'>Before continuing with this tutorial, please verify that the C3S API is installed. All the information about this api is available at: </font></p>
<p><a class="reference external" href="https://cds.climate.copernicus.eu/api-how-to#install-the-cds-api-key">https://cds.climate.copernicus.eu/api-how-to#install-the-cds-api-key</a></p>
<hr class="docutils" />
<p>In this tutorial we will access lake surface water temperature data from the Climate Data Store (CDS) and plot</p>
<ul class="simple">
<li><p>the timeseries at the lake centre for a given day of the year and</p></li>
<li><p>the LSWT, uncertainty and quality level for all the pixels on the given lake on a selected day.</p></li>
</ul>
<p>The tutorial comprises two main steps:</p>
<ol class="arabic simple">
<li><p>Dowload and decompress data for every year on record on the selected day of the year</p></li>
<li><p>Visualise and save the lake surface water temperature <strong>timeseries</strong> (displaying quality levels and uncertainty) <strong>at the lake centre</strong>, but other locations can be given through their lat/lon coordinates</p></li>
<li><p>Visualise the location of the lake centre (or of the preferred location) on the lake mask</p></li>
<li><p>Plot the <strong>LSWT, uncertainty and quality level for all the available pixels</strong> on the selected lake <strong>on a given date</strong></p></li>
</ol>
<p>This tutorial will show you that:</p>
<ol class="arabic simple">
<li><p>how to find out for which lakes LSWT is available</p></li>
<li><p>the lake mask of a specific lake tells in which pixels to expect LSWT for a given lake</p></li>
<li><p>LSWT files contains LSWT but also quality levels, uncertainty and the lake mask</p></li>
<li><p>LSWTs have to be used together with the quality levels and the uncertainy. We recommend to use LSWT of quality level 4 and 5 only.</p></li>
<li><p>not all the pixels belonging to a lake will have LSWT for a given time</p></li>
</ol>
<section id="import-librairies">
<h2>Import librairies<a class="headerlink" href="#import-librairies" title="Permalink to this heading">#</a></h2>
<p>The lake surface water temperature data will be download in a zip file containing a NetCDF file. We need libraries to download data from the CDS but also libraires to manage zip files (zipfile library) and  NetCDF files (xarray library). We also use libraries to plot and visualise data (matplotlib and cartopy libraries).</p>
<p>Additional libraires: os and glob are used for file management</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">cdsapi</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">glob</span>
<span class="kn">import</span> <span class="nn">zipfile</span>
<span class="kn">import</span> <span class="nn">xarray</span> <span class="k">as</span> <span class="nn">xr</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">cartopy</span> <span class="kn">import</span> <span class="n">crs</span><span class="p">,</span> <span class="n">feature</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</pre></div>
</div>
</div>
</div>
<p>For downloading and generating the timeserie, three inputs are required:</p>
<ul class="simple">
<li><p>The name of the lake (lake_name). The name of the lake must exists in the list of available lakes.</p></li>
<li><p>The output directory name (output_dir) where the different files will be saved.</p></li>
<li><p>The .csv file with the lake list of the GloboLakes 1000 lakes.</p></li>
<li><p>The day of the year given as day and month</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Version of LSWT: currently available v4.0 (GloboLakes lakes). Soon available v4.5 (ESA CCI LAKES lakes)</span>
<span class="n">version</span> <span class="o">=</span> <span class="s1">&#39;4.0&#39;</span>

<span class="c1"># Input the name of the lake</span>
<span class="n">lake_name</span> <span class="o">=</span> <span class="s1">&#39;Titicaca&#39;</span>

<span class="c1"># The directory to store downloaded files</span>
<span class="n">DATADIR</span> <span class="o">=</span> <span class="s1">&#39;./data_dir&#39;</span>
<span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">DATADIR</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># The output directory name </span>
<span class="n">output_dir</span> <span class="o">=</span> <span class="n">DATADIR</span> 
<span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">output_dir</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Day and month </span>
<span class="n">mm</span><span class="p">,</span> <span class="n">dd</span> <span class="o">=</span> <span class="s1">&#39;07&#39;</span><span class="p">,</span> <span class="s1">&#39;01&#39;</span>
</pre></div>
</div>
</div>
</div>
<p>Current version of the Lake Surface Water Temperature dataset on CDS (LSWT v4.0 + LSWT v4.2) contains 1000 lakes.
The lake list (LAKELIST-1000lakes-GloboLakes-CENTRE-LSWT-v4.0-fv01.0.csv) can be downloaded via the lake website at the University of Reading <a class="reference external" href="http://www.laketemp.net/home_GL/GLTargets.php">http://www.laketemp.net/home_GL/GLTargets.php</a>. Here we read directly the file from the laketemp website.
A new version LSWT v4.5 will be available soon and it will contain 2000 lakes. If you are using LSWT v4.5, the lake list (ESA_CCI_static_lake_mask_v2_1km_UoR_metadata_fv2.1_06Oct2021_4laketemp.csv) can be downloaded via the lake website at the University of Reading <a class="reference external" href="http://www.laketemp.net/home_CCI/cci_targets.php">http://www.laketemp.net/home_CCI/cci_targets.php</a>. Here we read directly the file from the laketemp website.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Read the file containing Name, Country, ID, lat/lon of the lake centre, maximum distance to land and </span>
<span class="c1"># the lat/lon of a box surrounding the lake for all the 1000 GloboLakes lakes / 2024 ESA CCI LAKES lakes</span>
<span class="k">if</span> <span class="n">version</span> <span class="o">==</span> <span class="s1">&#39;4.0&#39;</span><span class="p">:</span>
    <span class="n">lakes_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span>
        <span class="s1">&#39;http://www.laketemp.net/home_GL/LAKELIST-1000lakes-GloboLakes-CENTRE-LSWT-v4.0-fv01.0.csv&#39;</span>
    <span class="p">)</span>
<span class="k">elif</span> <span class="n">version</span> <span class="o">==</span> <span class="s1">&#39;4.5&#39;</span><span class="p">:</span>
    <span class="n">lakes_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span>
        <span class="s1">&#39;http://www.laketemp.net/home_CCI/ESA_CCI_static_lake_mask_v2_1km_UoR_metadata_fv2.1_06Oct2021_4laketemp.csv&#39;</span>
    <span class="p">)</span>

<span class="c1"># Extract the lis of available lakes</span>
<span class="n">available_lakes</span> <span class="o">=</span> <span class="n">lakes_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>

<span class="c1"># Find the position of the lake in the csv list which we have read in a pandas dataframe</span>
<span class="n">idx</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">lakes_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]))</span> <span class="k">if</span> <span class="n">lake_name</span> <span class="ow">in</span> <span class="n">lakes_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">]]</span>

<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">:</span>
    <span class="c1"># Verify that the lake surface water temperature is available for the selected lake.</span>
    <span class="c1"># If the lake is not available it may be because of a spelling mistake.</span>
    <span class="nb">print</span> <span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The lake &quot;</span><span class="si">{</span><span class="n">lake_name</span><span class="si">}</span><span class="s1">&quot; is not available&#39;</span><span class="p">)</span>
<span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">:</span>
    <span class="c1"># If more than one lake is found, instruct user to be more specific in selection:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Manually check the lake name!&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">lakes_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">idx</span><span class="p">])</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">lake_row</span> <span class="o">=</span> <span class="n">lakes_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">idx</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
    <span class="c1"># # Extract the lat/lon of the centre</span>
    <span class="n">latcentre</span><span class="p">,</span> <span class="n">loncentre</span> <span class="o">=</span> <span class="n">lake_row</span><span class="p">[</span><span class="s1">&#39; lat centre&#39;</span><span class="p">],</span> <span class="n">lake_row</span><span class="p">[</span><span class="s1">&#39; lon centre&#39;</span><span class="p">]</span>
    <span class="n">latmin</span><span class="p">,</span>    <span class="n">latmax</span>    <span class="o">=</span> <span class="n">lake_row</span><span class="p">[</span><span class="s1">&#39; lat min&#39;</span><span class="p">],</span> <span class="n">lake_row</span><span class="p">[</span><span class="s1">&#39; lat max&#39;</span><span class="p">]</span>
    <span class="n">lonmin</span><span class="p">,</span>    <span class="n">lonmax</span>    <span class="o">=</span> <span class="n">lake_row</span><span class="p">[</span><span class="s1">&#39; lon min&#39;</span><span class="p">],</span> <span class="n">lake_row</span><span class="p">[</span><span class="s1">&#39; lon max&#39;</span><span class="p">]</span>
    <span class="c1"># latmin,    latmax    = df.iloc[idx, 6].iloc[0], df.iloc[idx, 7].iloc[0]</span>
    <span class="c1"># lonmin,    lonmax    = df.iloc[idx, 8].iloc[0], df.iloc[idx, 9].iloc[0]</span>
<span class="n">lake_row</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>GLWD                                 20
 Name                     lago Titicaca
 Country                           Peru
 lat centre                    -15.7681
 lon centre                    -69.4569
 max distance to land              23.4
 lat min                       -16.5931
 lat max                       -15.2375
 lon min                       -70.0153
 lon max                       -68.5764
Name: 17, dtype: object
</pre></div>
</div>
</div>
</div>
</section>
<section id="downloading-the-data">
<h2>Downloading the data<a class="headerlink" href="#downloading-the-data" title="Permalink to this heading">#</a></h2>
<p>Having the CDS api, this function will retrive the  data for the selected lake into the defined output directory. The downloaded file is compressed (zip format) containing the data file in NetCDF format. For reading the lake surface water temeparture data, the files will be extracted in the output directory.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Setting the years for the time series</span>
<span class="k">if</span> <span class="n">version</span> <span class="o">==</span> <span class="s1">&#39;4.0&#39;</span><span class="p">:</span>
    <span class="n">years</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1995</span><span class="p">,</span><span class="mi">2020</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">))</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="k">elif</span> <span class="n">version</span> <span class="o">==</span> <span class="s1">&#39;4.5&#39;</span><span class="p">:</span>
    <span class="n">years</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1995</span><span class="p">,</span><span class="mi">2023</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">))</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> 
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">download_zip_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">DATADIR</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">lake_name</span><span class="si">}</span><span class="s1">.zip&#39;</span><span class="p">)</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">download_zip_file</span><span class="p">):</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">cdsapi</span><span class="o">.</span><span class="n">Client</span><span class="p">()</span>
    <span class="n">c</span><span class="o">.</span><span class="n">retrieve</span><span class="p">(</span>
        <span class="s1">&#39;satellite-lake-water-temperature&#39;</span><span class="p">,</span>
        <span class="p">{</span>
            <span class="s1">&#39;version&#39;</span><span class="p">:</span> <span class="n">version</span><span class="p">,</span>
            <span class="s1">&#39;variable&#39;</span><span class="p">:</span> <span class="s1">&#39;lake_surface_water_temperature&#39;</span><span class="p">,</span>
            <span class="s1">&#39;year&#39;</span><span class="p">:</span> <span class="n">years</span><span class="p">,</span>
            <span class="s1">&#39;month&#39;</span><span class="p">:</span> <span class="n">mm</span><span class="p">,</span>
            <span class="s1">&#39;day&#39;</span><span class="p">:</span> <span class="n">dd</span><span class="p">,</span>
            <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;zip&#39;</span> <span class="c1"># valid formats: zip, tar and tgz</span>
        <span class="p">},</span>
        <span class="n">download_zip_file</span>
    <span class="p">)</span>

<span class="k">with</span> <span class="n">zipfile</span><span class="o">.</span><span class="n">ZipFile</span><span class="p">(</span><span class="n">download_zip_file</span><span class="p">)</span> <span class="k">as</span> <span class="n">z</span><span class="p">:</span>
    <span class="n">filelist</span> <span class="o">=</span> <span class="p">[</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">DATADIR</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">z</span><span class="o">.</span><span class="n">namelist</span><span class="p">()]</span>
    <span class="n">z</span><span class="o">.</span><span class="n">extractall</span><span class="p">(</span><span class="n">DATADIR</span><span class="p">)</span>
<span class="c1"># Ensure the filelist is in the correct order:</span>
<span class="n">filelist</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">filelist</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2023-04-17 11:03:35,495 INFO Welcome to the CDS
2023-04-17 11:03:35,496 INFO Sending request to https://cds.climate.copernicus.eu/api/v2/resources/satellite-lake-water-temperature
2023-04-17 11:03:35,653 INFO Request is queued
2023-04-17 11:03:36,711 INFO Request is running
2023-04-17 11:04:08,218 INFO Request is completed
2023-04-17 11:04:08,219 INFO Downloading https://download-0010-clone.copernicus-climate.eu/cache-compute-0010/cache/data2/dataset-satellite-lake-water-temperature-766deb62-0bbe-4681-a7e5-e4407d94a56b.zip to ./data_dir/Titicaca.zip (382.1M)
2023-04-17 11:05:21,241 INFO Download rate 5.2M/s  
</pre></div>
</div>
</div>
</div>
</section>
<section id="visualise-the-lake-surface-water-temperature-timeseries">
<h2>Visualise the Lake Surface Water Temperature timeseries<a class="headerlink" href="#visualise-the-lake-surface-water-temperature-timeseries" title="Permalink to this heading">#</a></h2>
<p>Now that the data have been extracted, we can read and plot them. To read the data in NetCDF format we use the Xarray library and for the visualisation of the time series we use Matplotlib.</p>
<p>The LSWT are plotted per quality level (color of the dot) and an error bar show the LSWT uncertainty for each value.</p>
<p>The figure with the timeseries will be saved in the output directory in png format in the [lake_name]_timeseries.png file</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Read all files (this uses dask so the data is not loaded into RAM)</span>
<span class="n">ds</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_mfdataset</span><span class="p">(</span><span class="n">filelist</span><span class="p">)</span>
<span class="n">ds_last</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">time</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Select a point, and load into RAM to allow faster further calculations</span>
<span class="n">ds_point</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span>
    <span class="n">lat</span><span class="o">=</span><span class="n">latcentre</span><span class="p">,</span> <span class="n">lon</span><span class="o">=</span><span class="n">loncentre</span><span class="p">,</span>
    <span class="n">method</span><span class="o">=</span><span class="s2">&quot;nearest&quot;</span>
<span class="p">)</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>  <span class="c1"># The .compute() loads the reduced data array into RAM</span>
<span class="n">ds_point</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:                         (time: 24)
Coordinates:
    lat                             float32 -15.77
    lon                             float32 -69.47
  * time                            (time) datetime64[ns] 1995-07-01T12:00:00...
Data variables:
    lake_surface_water_temperature  (time) float32 nan nan nan ... 284.8 286.1
    lswt_uncertainty                (time) float32 nan nan nan ... 0.207 0.159
    quality_level                   (time) float32 nan nan nan ... 3.0 5.0 5.0
    obs_instr                       (time) float32 nan nan nan ... 16.0 32.0
    flag_bias_correction            (time) float32 nan nan nan ... nan nan nan
    lakeid                          (time) float64 20.0 20.0 20.0 ... 20.0 20.0
Attributes: (12/50)
    title:                           NERC GloboLakes Lake Surface Water Tempe...
    summary:                         L3S product from the NERC GloboLakes pro...
    citation:                        Carrea, L.; Merchant, C.J. (2019): Globo...
    license:                         Creative Commons by Attribution ShareAli...
    reference:                       http://www.globolakes.ac.uk/ http://www....
    institution:                     NERC
    ...                              ...
    southernmost_latitude:           -90.0
    easternmost_longitude:           180.0
    westernmost_longitude:           -180.0
    processing_level:                L3S
    cdm_data_type:                   grid
    source_file:                     19950701120000-ESACCI-L3C_GHRSST-ATSR2-C...</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-98e62e30-afa2-4fff-a5d5-238fb20305d1' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-98e62e30-afa2-4fff-a5d5-238fb20305d1' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 24</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-53140918-e709-4ac8-af91-fb25e8020202' class='xr-section-summary-in' type='checkbox'  checked><label for='section-53140918-e709-4ac8-af91-fb25e8020202' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>lat</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>-15.77</div><input id='attrs-d169d041-bf5d-4633-becf-270f3ee9b068' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-d169d041-bf5d-4633-becf-270f3ee9b068' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-aae90d16-ff65-40a8-8a0a-459e582bc3ce' class='xr-var-data-in' type='checkbox'><label for='data-aae90d16-ff65-40a8-8a0a-459e582bc3ce' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>latitude</dd><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>valid_min :</span></dt><dd>-90.0</dd><dt><span>valid_max :</span></dt><dd>90.0</dd><dt><span>axis :</span></dt><dd>Y</dd><dt><span>reference_datum :</span></dt><dd>geographical coordinates, WGS84 projection</dd></dl></div><div class='xr-var-data'><pre>array(-15.775, dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>lon</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>-69.47</div><input id='attrs-d62ff983-8c11-4507-9d3b-e8e12428018e' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-d62ff983-8c11-4507-9d3b-e8e12428018e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-2e3cf917-75ad-4c2b-9aea-2093dc590d89' class='xr-var-data-in' type='checkbox'><label for='data-2e3cf917-75ad-4c2b-9aea-2093dc590d89' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>longitude</dd><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>valid_min :</span></dt><dd>-180.0</dd><dt><span>valid_max :</span></dt><dd>180.0</dd><dt><span>axis :</span></dt><dd>X</dd><dt><span>reference_datum :</span></dt><dd>geographical coordinates, WGS84 projection</dd></dl></div><div class='xr-var-data'><pre>array(-69.475, dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>1995-07-01T12:00:00 ... 2019-07-...</div><input id='attrs-5fb3f486-5da5-4f82-848a-757fa2bd511d' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-5fb3f486-5da5-4f82-848a-757fa2bd511d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a3f17a92-3265-46be-9a6c-f77eb2dd4df8' class='xr-var-data-in' type='checkbox'><label for='data-a3f17a92-3265-46be-9a6c-f77eb2dd4df8' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>reference time of the lswt file</dd><dt><span>standard_name :</span></dt><dd>time</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;1995-07-01T12:00:00.000000000&#x27;, &#x27;1996-07-01T12:00:00.000000000&#x27;,
       &#x27;1997-07-01T12:00:00.000000000&#x27;, &#x27;1998-07-01T12:00:00.000000000&#x27;,
       &#x27;1999-07-01T12:00:00.000000000&#x27;, &#x27;2001-07-01T12:00:00.000000000&#x27;,
       &#x27;2002-07-01T12:00:00.000000000&#x27;, &#x27;2003-07-01T12:00:00.000000000&#x27;,
       &#x27;2004-07-01T12:00:00.000000000&#x27;, &#x27;2005-07-01T12:00:00.000000000&#x27;,
       &#x27;2006-07-01T12:00:00.000000000&#x27;, &#x27;2007-07-01T12:00:00.000000000&#x27;,
       &#x27;2008-07-01T12:00:00.000000000&#x27;, &#x27;2009-07-01T12:00:00.000000000&#x27;,
       &#x27;2010-07-01T12:00:00.000000000&#x27;, &#x27;2011-07-01T12:00:00.000000000&#x27;,
       &#x27;2012-07-01T12:00:00.000000000&#x27;, &#x27;2013-07-01T12:00:00.000000000&#x27;,
       &#x27;2014-07-01T12:00:00.000000000&#x27;, &#x27;2015-07-01T12:00:00.000000000&#x27;,
       &#x27;2016-07-01T12:00:00.000000000&#x27;, &#x27;2017-07-01T12:00:00.000000000&#x27;,
       &#x27;2018-07-01T12:00:00.000000000&#x27;, &#x27;2019-07-01T12:00:00.000000000&#x27;],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-fa462c10-122e-4320-8d90-8d09447093f3' class='xr-section-summary-in' type='checkbox'  checked><label for='section-fa462c10-122e-4320-8d90-8d09447093f3' class='xr-section-summary' >Data variables: <span>(6)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>lake_surface_water_temperature</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>nan nan nan ... 286.3 284.8 286.1</div><input id='attrs-e8f5b3a5-566a-468c-b631-457f318dfda4' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-e8f5b3a5-566a-468c-b631-457f318dfda4' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f5bf50fa-93ab-4257-a93f-9c1e21bfb5df' class='xr-var-data-in' type='checkbox'><label for='data-f5bf50fa-93ab-4257-a93f-9c1e21bfb5df' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>Kelvin</dd><dt><span>long_name :</span></dt><dd>lake surface skin temperature</dd><dt><span>valid_min :</span></dt><dd>-200</dd><dt><span>valid_max :</span></dt><dd>5000</dd><dt><span>comment :</span></dt><dd>The observations from different instruments have been combined.</dd><dt><span>standard_name :</span></dt><dd>lake_surface_water_temperature</dd></dl></div><div class='xr-var-data'><pre>array([      nan,       nan,       nan,       nan, 283.66998,       nan,
             nan, 285.32   ,       nan,       nan,       nan, 285.50998,
       285.87   , 285.47998, 286.37   ,       nan, 285.41   ,       nan,
       285.93   , 281.99   , 285.75   , 286.31   , 284.84   , 286.08   ],
      dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>lswt_uncertainty</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>nan nan nan ... 0.573 0.207 0.159</div><input id='attrs-d1273941-7a79-4bce-bdcc-92243c81f9b1' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-d1273941-7a79-4bce-bdcc-92243c81f9b1' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-3429eba5-bd10-4b3f-b1e6-7dccfdc70d1f' class='xr-var-data-in' type='checkbox'><label for='data-3429eba5-bd10-4b3f-b1e6-7dccfdc70d1f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>Kelvin</dd><dt><span>long_name :</span></dt><dd>Total uncertainty</dd><dt><span>valid_min :</span></dt><dd>0</dd><dt><span>valid_max :</span></dt><dd>10000</dd><dt><span>standard_name :</span></dt><dd>lake_surface_water_temperature_uncertainty</dd><dt><span>comment :</span></dt><dd>Total uncertainty was computed with LSWT uncertainties from the Optimal Estimation and bias correction uncertainty.</dd></dl></div><div class='xr-var-data'><pre>array([       nan,        nan,        nan,        nan, 0.17300001,
              nan,        nan, 0.142     ,        nan,        nan,
              nan, 0.2       , 0.31500003, 0.179     , 0.289     ,
              nan, 0.18400002,        nan, 0.143     , 0.26000002,
       0.17      , 0.573     , 0.20700002, 0.15900001], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>quality_level</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>nan nan nan nan ... 5.0 3.0 5.0 5.0</div><input id='attrs-2b0cb2fa-2e89-4bf2-aca4-20726b0db109' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-2b0cb2fa-2e89-4bf2-aca4-20726b0db109' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-4a78118d-c789-4665-b43c-1b7f93ef7b3d' class='xr-var-data-in' type='checkbox'><label for='data-4a78118d-c789-4665-b43c-1b7f93ef7b3d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>flag_meanings :</span></dt><dd>no_data bad_data worst_quality low_quality acceptable_quality best_quality</dd><dt><span>flag_masks :</span></dt><dd>[0 1 2 3 4 5]</dd><dt><span>long_name :</span></dt><dd>quality levels</dd><dt><span>valid_min :</span></dt><dd>0</dd><dt><span>valid_max :</span></dt><dd>5</dd><dt><span>comment :</span></dt><dd>These are overall quality indicators.</dd><dt><span>standard_name :</span></dt><dd>lake_surface_water_temperature_quality_level</dd></dl></div><div class='xr-var-data'><pre>array([nan, nan, nan, nan,  4., nan, nan,  4., nan, nan, nan,  5.,  2.,
        5.,  2., nan,  5., nan,  5.,  2.,  5.,  3.,  5.,  5.],
      dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>obs_instr</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>nan nan nan nan ... 32.0 16.0 32.0</div><input id='attrs-b87504e4-3ce1-43a3-a193-99f908e23985' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-b87504e4-3ce1-43a3-a193-99f908e23985' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-cc94602d-badf-4eb9-82ec-eaf87e64d233' class='xr-var-data-in' type='checkbox'><label for='data-cc94602d-badf-4eb9-82ec-eaf87e64d233' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>observation instruments</dd><dt><span>flag_meanings :</span></dt><dd>ATSR2 ATSR2-AATSR AATSR AATSR-AVHRR AVHRRA</dd><dt><span>flag_masks :</span></dt><dd>[ 1  2  4  8 16]</dd><dt><span>comment :</span></dt><dd>If the bit is set to 1 the observation from the correspondent instrument/instruments have been used to generate the LSWT.</dd><dt><span>standard_name :</span></dt><dd>instrument_for_observation</dd></dl></div><div class='xr-var-data'><pre>array([nan, nan, nan, nan,  1., nan, nan,  4., nan, nan, nan, 16., 16.,
        8., 16., nan, 16., nan, 16., 16., 16., 32., 16., 32.],
      dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>flag_bias_correction</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>nan nan nan nan ... nan nan nan nan</div><input id='attrs-1ff32a2b-4479-4e73-974f-0de12a932e47' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-1ff32a2b-4479-4e73-974f-0de12a932e47' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b5e389f1-8673-4615-85cd-f81aeda189d1' class='xr-var-data-in' type='checkbox'><label for='data-b5e389f1-8673-4615-85cd-f81aeda189d1' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>bias correction flag</dd><dt><span>flag_meanings :</span></dt><dd>ATSR2 AATSR ATSR2-AATSR</dd><dt><span>flag_masks :</span></dt><dd>[1 2 3]</dd><dt><span>comment :</span></dt><dd>The reference instrument was the AVHRRMTA, conseuqently no bias correction has been applied to observations from the AVHRR instrument.</dd><dt><span>standard_name :</span></dt><dd>instrument_bias_correction_flag</dd></dl></div><div class='xr-var-data'><pre>array([nan, nan, nan, nan,  1., nan, nan,  2., nan, nan, nan, nan, nan,
        2., nan, nan, nan, nan, nan, nan, nan, nan, nan, nan],
      dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>lakeid</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>20.0 20.0 20.0 ... 20.0 20.0 20.0</div><input id='attrs-463578c2-83d6-474f-8a49-fddc29e59b6d' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-463578c2-83d6-474f-8a49-fddc29e59b6d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-38572d66-d3a9-4691-aa45-9a8e4bac6544' class='xr-var-data-in' type='checkbox'><label for='data-38572d66-d3a9-4691-aa45-9a8e4bac6544' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>1</dd><dt><span>long_name :</span></dt><dd>Lake ID</dd><dt><span>valid_min :</span></dt><dd>2</dd><dt><span>valid_max :</span></dt><dd>999999</dd><dt><span>comment :</span></dt><dd>GLWD (Global Lakes and Wetlands Database) lake ID of GloboLakes lakes as defined in Carrea L. et al. (2015)  Datasets related to in-land water for limnology and remote sensing applications: distance-to-land, distance-to-water, water-body identifier and lake-centre co-ordinates. Geoscience Data Journal, 2 (2) pp. 83-97.</dd><dt><span>standard_name :</span></dt><dd>lake_identifier</dd></dl></div><div class='xr-var-data'><pre>array([20., 20., 20., 20., 20., 20., 20., 20., 20., 20., 20., 20., 20.,
       20., 20., 20., 20., 20., 20., 20., 20., 20., 20., 20.])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-13207b93-6804-4464-bb7d-ba5c0a9f4b15' class='xr-section-summary-in' type='checkbox'  ><label for='section-13207b93-6804-4464-bb7d-ba5c0a9f4b15' class='xr-section-summary' >Indexes: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-26cd4175-d1d8-4d34-9b59-4f032ea63a54' class='xr-index-data-in' type='checkbox'/><label for='index-26cd4175-d1d8-4d34-9b59-4f032ea63a54' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;1995-07-01 12:00:00&#x27;, &#x27;1996-07-01 12:00:00&#x27;,
               &#x27;1997-07-01 12:00:00&#x27;, &#x27;1998-07-01 12:00:00&#x27;,
               &#x27;1999-07-01 12:00:00&#x27;, &#x27;2001-07-01 12:00:00&#x27;,
               &#x27;2002-07-01 12:00:00&#x27;, &#x27;2003-07-01 12:00:00&#x27;,
               &#x27;2004-07-01 12:00:00&#x27;, &#x27;2005-07-01 12:00:00&#x27;,
               &#x27;2006-07-01 12:00:00&#x27;, &#x27;2007-07-01 12:00:00&#x27;,
               &#x27;2008-07-01 12:00:00&#x27;, &#x27;2009-07-01 12:00:00&#x27;,
               &#x27;2010-07-01 12:00:00&#x27;, &#x27;2011-07-01 12:00:00&#x27;,
               &#x27;2012-07-01 12:00:00&#x27;, &#x27;2013-07-01 12:00:00&#x27;,
               &#x27;2014-07-01 12:00:00&#x27;, &#x27;2015-07-01 12:00:00&#x27;,
               &#x27;2016-07-01 12:00:00&#x27;, &#x27;2017-07-01 12:00:00&#x27;,
               &#x27;2018-07-01 12:00:00&#x27;, &#x27;2019-07-01 12:00:00&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, freq=None))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-8e03f05b-9d49-48ef-9b70-60b29006c679' class='xr-section-summary-in' type='checkbox'  ><label for='section-8e03f05b-9d49-48ef-9b70-60b29006c679' class='xr-section-summary' >Attributes: <span>(50)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>title :</span></dt><dd>NERC GloboLakes Lake Surface Water Temperature L3S product</dd><dt><span>summary :</span></dt><dd>L3S product from the NERC GloboLakes project, produced using the GloboLakes v4.0 algorithm.</dd><dt><span>citation :</span></dt><dd>Carrea, L.; Merchant, C.J. (2019): GloboLakes Lake Surface Water Temperature (LSWT) v4.0 (1995-2016). Centre for Environmental Data Analysis. doi:10.5285/76a29c5b55204b66a40308fc2ba9cdb3 Papers describing/related to the dataset: MacCallum, S.N. and Merchant, C.J. (2012) Surface water temperature observations of large lakes by optimal estimation. Canadian Journal of Remote Sensing, 38 (1). pp. 25-45.; Carrea, L., Embury, O. and Merchant, C. J. (2015) Datasets related to in-land water for limnology and remote sensing applications: distance-to-land, distance-to-water, water-body identifier and lake-centre co-ordinates. Geoscience Data Journal, 2 (2). pp. 83-97.</dd><dt><span>license :</span></dt><dd>Creative Commons by Attribution ShareAlike CC-BY-SA v4.0 (https://creativecommons.org/licenses/by-sa/4.0/)</dd><dt><span>reference :</span></dt><dd>http://www.globolakes.ac.uk/ http://www.laketemp.net/home_GL/</dd><dt><span>institution :</span></dt><dd>NERC</dd><dt><span>history :</span></dt><dd>Created with using GBCS library v2.6.1-146-gfe50b81</dd><dt><span>id :</span></dt><dd>NERCGloboLakes-L3S-CDR</dd><dt><span>product_version :</span></dt><dd>4.0</dd><dt><span>uuid :</span></dt><dd>a54386ae-3a08-11e9-b28e-ec0d9ad44524</dd><dt><span>tracking_id :</span></dt><dd>a54386ae-3a08-11e9-b28e-ec0d9ad44524</dd><dt><span>netcdf_version_id :</span></dt><dd>4.4.1.1</dd><dt><span>source :</span></dt><dd>ATSR2-ESA-L1-v3, AATRS-ESA-L1-v3, AVHRRMTA-EUMETSAT-L1-v1, ERA_INTERIM-ECMWF-WSP-v1.0, GloboLakes-Mask-v1.0</dd><dt><span>platform :</span></dt><dd>ERS-2</dd><dt><span>sensor :</span></dt><dd>ATSR2</dd><dt><span>Metadata_Conventions :</span></dt><dd>Unidata Dataset Discovery v1.0</dd><dt><span>Conventions :</span></dt><dd>CF-1.6</dd><dt><span>gemet_keywords :</span></dt><dd>inland water; temperature; climate; seasonal variations; hydrology; limnology; environmental data; environmental  monitoring; monitoring; remote sensing</dd><dt><span>gcmd_keywords :</span></dt><dd>LAKES/RESERVOIRS</dd><dt><span>iso19115_topic_categories :</span></dt><dd>Environment; Inland water; GeoscientificInformation</dd><dt><span>standard_name_vocabulary :</span></dt><dd>NetCDF Climate and Forecast (CF) Metadata Convention</dd><dt><span>acknowledgment :</span></dt><dd>Funded by the UK Natural Environment Research Council (NERC)</dd><dt><span>creator_name :</span></dt><dd>NERC GloboLakes</dd><dt><span>creator_url :</span></dt><dd>http://www.globolakes.ac.uk/ http://www.laketemp.net/home_GL/</dd><dt><span>creator_email :</span></dt><dd>l.carrea@reading.ac.uk</dd><dt><span>creator_processing_institution :</span></dt><dd>These data were produced on the JASMIN infrastructure at STFC as part of the NERC GloboLakes project</dd><dt><span>project :</span></dt><dd>GloboLakes</dd><dt><span>publisher_name :</span></dt><dd>NERC GloboLakes</dd><dt><span>publisher_url :</span></dt><dd>http://www.globolakes.ac.uk/</dd><dt><span>publisher_email :</span></dt><dd>l.carrea@reading.ac.uk</dd><dt><span>date_created :</span></dt><dd>2019-02-26T20:54:01Z</dd><dt><span>time_coverage_start :</span></dt><dd>19950701T000000Z</dd><dt><span>time_coverage_end :</span></dt><dd>19950701T235959Z</dd><dt><span>time_coverage_duration :</span></dt><dd>1 day</dd><dt><span>geospatial_lat_units :</span></dt><dd>degrees_north</dd><dt><span>geospatial_lat_resolution :</span></dt><dd>0.05</dd><dt><span>geospatial_lon_units :</span></dt><dd>degrees_east</dd><dt><span>geospatial_lon_resolution :</span></dt><dd>0.05</dd><dt><span>geospatial_vertical_min :</span></dt><dd>-1e-05</dd><dt><span>geospatial_lat_min :</span></dt><dd>-90.0</dd><dt><span>geospatial_lat_max :</span></dt><dd>90.0</dd><dt><span>geospatial_lon_min :</span></dt><dd>-180.0</dd><dt><span>geospatial_lon_max :</span></dt><dd>180.0</dd><dt><span>northernmost_latitude :</span></dt><dd>90.0</dd><dt><span>southernmost_latitude :</span></dt><dd>-90.0</dd><dt><span>easternmost_longitude :</span></dt><dd>180.0</dd><dt><span>westernmost_longitude :</span></dt><dd>-180.0</dd><dt><span>processing_level :</span></dt><dd>L3S</dd><dt><span>cdm_data_type :</span></dt><dd>grid</dd><dt><span>source_file :</span></dt><dd>19950701120000-ESACCI-L3C_GHRSST-ATSR2-CDR2.0-v02.0-fv01.0.nc</dd></dl></div></li></ul></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Convert to a pandas dataframe for plotting:</span>
<span class="n">df_point</span> <span class="o">=</span> <span class="n">ds_point</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span>
<span class="c1"># Remove any point without a lswt value</span>
<span class="n">df_point</span> <span class="o">=</span> <span class="n">df_point</span><span class="p">[</span><span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">df_point</span><span class="p">[</span><span class="s1">&#39;lake_surface_water_temperature&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)]</span>
<span class="n">df_point</span><span class="p">[</span><span class="s2">&quot;lake_surface_water_temperature&quot;</span><span class="p">]</span> <span class="o">-=</span> <span class="mf">273.15</span>
<span class="n">df_point</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>lat</th>
      <th>lon</th>
      <th>lake_surface_water_temperature</th>
      <th>lswt_uncertainty</th>
      <th>quality_level</th>
      <th>obs_instr</th>
      <th>flag_bias_correction</th>
      <th>lakeid</th>
    </tr>
    <tr>
      <th>time</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1999-07-01 12:00:00</th>
      <td>-15.775</td>
      <td>-69.474998</td>
      <td>10.519989</td>
      <td>0.173</td>
      <td>4.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>20.0</td>
    </tr>
    <tr>
      <th>2003-07-01 12:00:00</th>
      <td>-15.775</td>
      <td>-69.474998</td>
      <td>12.170013</td>
      <td>0.142</td>
      <td>4.0</td>
      <td>4.0</td>
      <td>2.0</td>
      <td>20.0</td>
    </tr>
    <tr>
      <th>2007-07-01 12:00:00</th>
      <td>-15.775</td>
      <td>-69.474998</td>
      <td>12.359985</td>
      <td>0.200</td>
      <td>5.0</td>
      <td>16.0</td>
      <td>NaN</td>
      <td>20.0</td>
    </tr>
    <tr>
      <th>2008-07-01 12:00:00</th>
      <td>-15.775</td>
      <td>-69.474998</td>
      <td>12.720001</td>
      <td>0.315</td>
      <td>2.0</td>
      <td>16.0</td>
      <td>NaN</td>
      <td>20.0</td>
    </tr>
    <tr>
      <th>2009-07-01 12:00:00</th>
      <td>-15.775</td>
      <td>-69.474998</td>
      <td>12.329987</td>
      <td>0.179</td>
      <td>5.0</td>
      <td>8.0</td>
      <td>2.0</td>
      <td>20.0</td>
    </tr>
    <tr>
      <th>2010-07-01 12:00:00</th>
      <td>-15.775</td>
      <td>-69.474998</td>
      <td>13.220001</td>
      <td>0.289</td>
      <td>2.0</td>
      <td>16.0</td>
      <td>NaN</td>
      <td>20.0</td>
    </tr>
    <tr>
      <th>2012-07-01 12:00:00</th>
      <td>-15.775</td>
      <td>-69.474998</td>
      <td>12.260010</td>
      <td>0.184</td>
      <td>5.0</td>
      <td>16.0</td>
      <td>NaN</td>
      <td>20.0</td>
    </tr>
    <tr>
      <th>2014-07-01 12:00:00</th>
      <td>-15.775</td>
      <td>-69.474998</td>
      <td>12.779999</td>
      <td>0.143</td>
      <td>5.0</td>
      <td>16.0</td>
      <td>NaN</td>
      <td>20.0</td>
    </tr>
    <tr>
      <th>2015-07-01 12:00:00</th>
      <td>-15.775</td>
      <td>-69.474998</td>
      <td>8.839996</td>
      <td>0.260</td>
      <td>2.0</td>
      <td>16.0</td>
      <td>NaN</td>
      <td>20.0</td>
    </tr>
    <tr>
      <th>2016-07-01 12:00:00</th>
      <td>-15.775</td>
      <td>-69.474998</td>
      <td>12.600006</td>
      <td>0.170</td>
      <td>5.0</td>
      <td>16.0</td>
      <td>NaN</td>
      <td>20.0</td>
    </tr>
    <tr>
      <th>2017-07-01 12:00:00</th>
      <td>-15.775</td>
      <td>-69.474998</td>
      <td>13.160004</td>
      <td>0.573</td>
      <td>3.0</td>
      <td>32.0</td>
      <td>NaN</td>
      <td>20.0</td>
    </tr>
    <tr>
      <th>2018-07-01 12:00:00</th>
      <td>-15.775</td>
      <td>-69.474998</td>
      <td>11.690002</td>
      <td>0.207</td>
      <td>5.0</td>
      <td>16.0</td>
      <td>NaN</td>
      <td>20.0</td>
    </tr>
    <tr>
      <th>2019-07-01 12:00:00</th>
      <td>-15.775</td>
      <td>-69.474998</td>
      <td>12.929993</td>
      <td>0.159</td>
      <td>5.0</td>
      <td>32.0</td>
      <td>NaN</td>
      <td>20.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># We create a plotting function that we can re-use in this section:</span>
<span class="k">def</span> <span class="nf">plot_time_series</span><span class="p">(</span>
    <span class="n">df_point</span><span class="p">,</span> <span class="n">lake_name</span><span class="p">,</span> <span class="n">output_dir</span><span class="p">,</span>
    <span class="n">quality_flags</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">],</span>
    <span class="n">qf_colors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;darkgrey&#39;</span><span class="p">,</span><span class="s1">&#39;purple&#39;</span><span class="p">,</span><span class="s1">&#39;green&#39;</span><span class="p">,</span><span class="s1">&#39;cyan&#39;</span><span class="p">,</span><span class="s1">&#39;red&#39;</span><span class="p">],</span>
    <span class="n">plotname_tag</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
<span class="p">):</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
    <span class="n">qf_mask</span> <span class="o">=</span> <span class="p">[</span><span class="n">qf</span> <span class="ow">in</span> <span class="n">quality_flags</span> <span class="k">for</span> <span class="n">qf</span> <span class="ow">in</span> <span class="n">df_point</span><span class="p">[</span><span class="s2">&quot;quality_level&quot;</span><span class="p">]]</span>
    <span class="n">df_point</span> <span class="o">=</span> <span class="n">df_point</span><span class="p">[</span><span class="n">qf_mask</span><span class="p">]</span>
    <span class="n">df_point</span><span class="p">[</span><span class="s2">&quot;lake_surface_water_temperature&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
        <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="s1">&#39;_nolegend_&#39;</span><span class="p">,</span>
        <span class="n">yerr</span> <span class="o">=</span> <span class="n">df_point</span><span class="p">[</span><span class="s2">&quot;lswt_uncertainty&quot;</span><span class="p">],</span> <span class="n">capthick</span><span class="o">=</span><span class="mf">1.9</span><span class="p">,</span> <span class="n">capsize</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ecolor</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">mew</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="p">)</span>
    
    <span class="c1"># Plot the quality flags over the top</span>
    <span class="k">for</span> <span class="n">qf</span> <span class="ow">in</span> <span class="n">quality_flags</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">qf</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">df_point</span><span class="p">[</span><span class="s2">&quot;quality_level&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="n">df_qf</span> <span class="o">=</span> <span class="n">df_point</span><span class="p">[</span><span class="n">df_point</span><span class="p">[</span><span class="s2">&quot;quality_level&quot;</span><span class="p">]</span><span class="o">==</span><span class="n">qf</span><span class="p">]</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
            <span class="n">df_qf</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">df_qf</span><span class="p">[</span><span class="s2">&quot;lake_surface_water_temperature&quot;</span><span class="p">],</span>
            <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">qf_colors</span><span class="p">[</span><span class="n">qf</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span>
            <span class="n">label</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Quality level = </span><span class="si">{</span><span class="n">qf</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="s2">&quot;1994&quot;</span><span class="p">,</span><span class="s2">&quot;2020&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Lake: </span><span class="si">{</span><span class="n">lake_name</span><span class="o">.</span><span class="n">title</span><span class="p">()</span><span class="si">}</span><span class="s1"> at lake centre&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Year&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Lake surface water temperature (°C)&quot;</span><span class="p">)</span>
    <span class="c1"># save the figure</span>
    <span class="n">png_file</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">output_dir</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">lake_name</span><span class="si">}</span><span class="s1">_timeseries</span><span class="si">{</span><span class="n">plotname_tag</span><span class="si">}</span><span class="s1">.png&#39;</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">png_file</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_time_series</span><span class="p">(</span>
    <span class="n">df_point</span><span class="p">,</span> <span class="n">lake_name</span><span class="p">,</span> <span class="n">output_dir</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/6a87fb7e691d4f626d075ff4014dca8ff8a3186b15661121fc00f7c7e4ed0994.png" src="../../_images/6a87fb7e691d4f626d075ff4014dca8ff8a3186b15661121fc00f7c7e4ed0994.png" />
</div>
</div>
<p>We recommend to use <strong>ONLY LSWT of best quality level 4 and 5</strong>. <strong>LSWT of quality level 1 should never be used</strong>. If you want to use lower quality level data, careful checks have to be carried out. We plot then only the observations of quality level 4 and 5.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_time_series</span><span class="p">(</span>
    <span class="n">df_point</span><span class="p">,</span> <span class="n">lake_name</span><span class="p">,</span> <span class="n">output_dir</span><span class="p">,</span>
    <span class="n">quality_flags</span><span class="o">=</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span> <span class="n">plotname_tag</span> <span class="o">=</span> <span class="s2">&quot;_ql45&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/2b54b72f8695ace65f77cc6b6fe2bc689acfe9e6e1dc273015e0cfddb24a70bd.png" src="../../_images/2b54b72f8695ace65f77cc6b6fe2bc689acfe9e6e1dc273015e0cfddb24a70bd.png" />
</div>
</div>
</section>
<section id="plot-the-position-of-the-location-of-the-extracted-lswt-on-the-lake-mask">
<h2>Plot the position of the location of the extracted LSWT on the lake mask<a class="headerlink" href="#plot-the-position-of-the-location-of-the-extracted-lswt-on-the-lake-mask" title="Permalink to this heading">#</a></h2>
<p>For generating this figure we use the cartopy library. The lake mask showing the cells belonging to the selected lake is plotted and the position on the lake where the time series was extracted is highlighted.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set a margin to slighlty enlarge the figure</span>
<span class="n">step</span> <span class="o">=</span> <span class="mf">0.1</span>

<span class="c1"># We take teh lakeid from the last timestep and cut out to our area of interest</span>
<span class="n">lakeid</span> <span class="o">=</span> <span class="n">ds_last</span><span class="o">.</span><span class="n">lakeid</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">lat</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">latmin</span><span class="o">-</span><span class="n">step</span><span class="p">,</span> <span class="n">latmax</span><span class="o">+</span><span class="n">step</span><span class="p">),</span> <span class="n">lon</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">lonmin</span><span class="o">-</span><span class="n">step</span><span class="p">,</span> <span class="n">lonmax</span><span class="o">+</span><span class="n">step</span><span class="p">))</span>

<span class="c1"># Plot the lake mask and the location of the centre</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">11</span><span class="p">,</span><span class="mf">8.5</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="n">projection</span> <span class="o">=</span> <span class="n">crs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>

<span class="n">ax</span><span class="o">.</span><span class="n">coastlines</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">gridlines</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">feature</span><span class="o">.</span><span class="n">BORDERS</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">stock_img</span><span class="p">()</span>
<span class="c1"># Set the extent using the fields extracted from the Lakes metadata earlier</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_extent</span><span class="p">([</span><span class="n">lonmin</span><span class="o">-</span><span class="n">step</span><span class="p">,</span> <span class="n">lonmax</span><span class="o">+</span><span class="n">step</span><span class="p">,</span> <span class="n">latmin</span><span class="o">-</span><span class="n">step</span><span class="p">,</span> <span class="n">latmax</span><span class="o">+</span><span class="n">step</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Lake: </span><span class="si">{</span><span class="n">lake_name</span><span class="o">.</span><span class="n">title</span><span class="p">()</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="n">map_proj</span> <span class="o">=</span> <span class="n">crs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">()</span>

<span class="c1"># Plot the lake mask</span>
<span class="n">lakeid</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">Reds</span><span class="p">,</span><span class="n">transform</span><span class="o">=</span><span class="n">crs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span><span class="n">subplot_kws</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;projection&#39;</span><span class="p">:</span> <span class="n">map_proj</span><span class="p">},</span>
    <span class="n">add_colorbar</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span>

<span class="c1"># Plot the location of the lake centre where the LSWT time series have been extracted</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="n">loncentre</span><span class="p">],</span> <span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="n">latcentre</span><span class="p">],</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">transform</span> <span class="o">=</span> <span class="n">crs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>

<span class="c1"># save the figure</span>
<span class="n">png_file</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">output_dir</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">lake_name</span><span class="si">}</span><span class="s1">_timeseries_location.png&#39;</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">png_file</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/661d8c395e552a1db3a3da6611a4ec31d73d03ce343adca72573a678ab0d3445.png" src="../../_images/661d8c395e552a1db3a3da6611a4ec31d73d03ce343adca72573a678ab0d3445.png" />
</div>
</div>
</section>
<section id="plot-the-lswt-quality-level-and-uncertainty-for-the-selected-day-of-the-last-year-on-record">
<h2>Plot the LSWT, quality level and uncertainty for the selected day of the last year on record<a class="headerlink" href="#plot-the-lswt-quality-level-and-uncertainty-for-the-selected-day-of-the-last-year-on-record" title="Permalink to this heading">#</a></h2>
<p>For generating this figure we use the cartopy library.</p>
<p>First we plot the LSWT over the full lake for the selected day and month and for the last year in the time      series.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lswt_y</span> <span class="o">=</span> <span class="n">ds_last</span><span class="o">.</span><span class="n">lake_surface_water_temperature</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">lat</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">latmin</span><span class="o">-</span><span class="n">step</span><span class="p">,</span> <span class="n">latmax</span><span class="o">+</span><span class="n">step</span><span class="p">),</span> <span class="n">lon</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">lonmin</span><span class="o">-</span><span class="n">step</span><span class="p">,</span> <span class="n">lonmax</span><span class="o">+</span><span class="n">step</span><span class="p">))</span>
<span class="n">datestr</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">lswt_y</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">values</span><span class="p">)[:</span><span class="mi">10</span><span class="p">]</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">11</span><span class="p">,</span><span class="mf">8.5</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="n">projection</span> <span class="o">=</span> <span class="n">crs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>

<span class="n">ax</span><span class="o">.</span><span class="n">coastlines</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">feature</span><span class="o">.</span><span class="n">BORDERS</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">stock_img</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_extent</span><span class="p">([</span><span class="n">lonmin</span><span class="o">-</span><span class="n">step</span><span class="p">,</span> <span class="n">lonmax</span><span class="o">+</span><span class="n">step</span><span class="p">,</span> <span class="n">latmin</span><span class="o">-</span><span class="n">step</span><span class="p">,</span> <span class="n">latmax</span><span class="o">+</span><span class="n">step</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Lake: </span><span class="si">{</span><span class="n">lake_name</span><span class="o">.</span><span class="n">title</span><span class="p">()</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="n">map_proj</span> <span class="o">=</span> <span class="n">crs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">()</span>

<span class="c1"># Plot the lake mask</span>
<span class="n">lswt_y</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">viridis</span><span class="p">,</span><span class="n">transform</span><span class="o">=</span><span class="n">crs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span><span class="n">subplot_kws</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;projection&#39;</span><span class="p">:</span> <span class="n">map_proj</span><span class="p">},</span>
<span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Lake surface water temperature (</span><span class="si">{</span><span class="n">datestr</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>


<span class="c1"># save the figure</span>
<span class="n">png_file</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">output_dir</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">lake_name</span><span class="si">}</span><span class="s1">_LSWT_</span><span class="si">{</span><span class="n">datestr</span><span class="si">}</span><span class="s1">.png&#39;</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">png_file</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/c5f62d6bf70ec173a4b77530d4dd1a261067ce494b941ac60220efdb8045cb68.png" src="../../_images/c5f62d6bf70ec173a4b77530d4dd1a261067ce494b941ac60220efdb8045cb68.png" />
</div>
</div>
<p>Now we plot the LSWT uncertainty for the selected day and month and for the last year in the time series.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lswt_y</span> <span class="o">=</span> <span class="n">ds_last</span><span class="o">.</span><span class="n">lswt_uncertainty</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">lat</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">latmin</span><span class="o">-</span><span class="n">step</span><span class="p">,</span> <span class="n">latmax</span><span class="o">+</span><span class="n">step</span><span class="p">),</span> <span class="n">lon</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">lonmin</span><span class="o">-</span><span class="n">step</span><span class="p">,</span> <span class="n">lonmax</span><span class="o">+</span><span class="n">step</span><span class="p">))</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">11</span><span class="p">,</span><span class="mf">8.5</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="n">projection</span> <span class="o">=</span> <span class="n">crs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>

<span class="n">ax</span><span class="o">.</span><span class="n">coastlines</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">feature</span><span class="o">.</span><span class="n">BORDERS</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">stock_img</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_extent</span><span class="p">([</span><span class="n">lonmin</span><span class="o">-</span><span class="n">step</span><span class="p">,</span> <span class="n">lonmax</span><span class="o">+</span><span class="n">step</span><span class="p">,</span> <span class="n">latmin</span><span class="o">-</span><span class="n">step</span><span class="p">,</span> <span class="n">latmax</span><span class="o">+</span><span class="n">step</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Lake: </span><span class="si">{</span><span class="n">lake_name</span><span class="o">.</span><span class="n">title</span><span class="p">()</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="n">map_proj</span> <span class="o">=</span> <span class="n">crs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">()</span>

<span class="c1"># Plot the lake mask</span>
<span class="n">lswt_y</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">cividis</span><span class="p">,</span><span class="n">transform</span><span class="o">=</span><span class="n">crs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span><span class="n">subplot_kws</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;projection&#39;</span><span class="p">:</span> <span class="n">map_proj</span><span class="p">})</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;LSWT uncertainty (</span><span class="si">{</span><span class="n">datestr</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>


<span class="c1"># save the figure</span>
<span class="n">png_file</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">output_dir</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">lake_name</span><span class="si">}</span><span class="s1">_LSWT_UNC_</span><span class="si">{</span><span class="n">datestr</span><span class="si">}</span><span class="s1">.png&#39;</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">png_file</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/9e7b3cbebfb900205f97242a2a88439ab15d707fc3cfc9024ed8adb0164c8018.png" src="../../_images/9e7b3cbebfb900205f97242a2a88439ab15d707fc3cfc9024ed8adb0164c8018.png" />
</div>
</div>
<p>Now we plot the quality levels for the selected day and month and for the last year in the time series.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lswt_y</span> <span class="o">=</span> <span class="n">ds_last</span><span class="o">.</span><span class="n">quality_level</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">lat</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">latmin</span><span class="o">-</span><span class="n">step</span><span class="p">,</span> <span class="n">latmax</span><span class="o">+</span><span class="n">step</span><span class="p">),</span> <span class="n">lon</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">lonmin</span><span class="o">-</span><span class="n">step</span><span class="p">,</span> <span class="n">lonmax</span><span class="o">+</span><span class="n">step</span><span class="p">))</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">11</span><span class="p">,</span><span class="mf">8.5</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="n">projection</span> <span class="o">=</span> <span class="n">crs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>

<span class="n">ax</span><span class="o">.</span><span class="n">coastlines</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">feature</span><span class="o">.</span><span class="n">BORDERS</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">stock_img</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_extent</span><span class="p">([</span><span class="n">lonmin</span><span class="o">-</span><span class="n">step</span><span class="p">,</span> <span class="n">lonmax</span><span class="o">+</span><span class="n">step</span><span class="p">,</span> <span class="n">latmin</span><span class="o">-</span><span class="n">step</span><span class="p">,</span> <span class="n">latmax</span><span class="o">+</span><span class="n">step</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Lake: </span><span class="si">{</span><span class="n">lake_name</span><span class="o">.</span><span class="n">title</span><span class="p">()</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="n">map_proj</span> <span class="o">=</span> <span class="n">crs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">()</span>

<span class="c1"># Plot the lake mask</span>
<span class="n">lswt_y</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">viridis</span><span class="p">,</span><span class="n">transform</span><span class="o">=</span><span class="n">crs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span><span class="n">subplot_kws</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;projection&#39;</span><span class="p">:</span> <span class="n">map_proj</span><span class="p">},</span>
    <span class="n">levels</span><span class="o">=</span><span class="p">[</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">1.5</span><span class="p">,</span><span class="mf">2.5</span><span class="p">,</span><span class="mf">3.5</span><span class="p">,</span><span class="mf">4.5</span><span class="p">,</span><span class="mf">5.5</span><span class="p">],</span> <span class="n">cbar_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;ticks&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">]}</span>
<span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;LSWT Quality Level (</span><span class="si">{</span><span class="n">datestr</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>


<span class="c1"># save the figure</span>
<span class="n">png_file</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">output_dir</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">lake_name</span><span class="si">}</span><span class="s1">_QL_</span><span class="si">{</span><span class="n">datestr</span><span class="si">}</span><span class="s1">.png&#39;</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">png_file</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/676081603263c7ba88a23d245068fbaea8a27414140f903a7643f9aaa70e4484.png" src="../../_images/676081603263c7ba88a23d245068fbaea8a27414140f903a7643f9aaa70e4484.png" />
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./submodules\c3s-training-submodule-sat-obs-hydro-cryo"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="soil-moisture-anomalies.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><strong>C3S Soil Moisture Data Access and Anomaly Analysis Notebook</strong></p>
      </div>
    </a>
    <a class="right-next"
       href="../c3s-training-submodule-sat-obs-ocean/intro.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Welcome to your Jupyter Book</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#import-librairies">Import librairies</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#downloading-the-data">Downloading the data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#visualise-the-lake-surface-water-temperature-timeseries">Visualise the Lake Surface Water Temperature timeseries</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-the-position-of-the-location-of-the-extracted-lswt-on-the-lake-mask">Plot the position of the location of the extracted LSWT on the lake mask</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-the-lswt-quality-level-and-uncertainty-for-the-selected-day-of-the-last-year-on-record">Plot the LSWT, quality level and uncertainty for the selected day of the last year on record</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By the Copernicus Climate Change Service (C3S), entrusted to ECMWF (European Centre for Medium-Range Weather Forecasts)
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../../_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549"></script>
<script defer src="../../_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>